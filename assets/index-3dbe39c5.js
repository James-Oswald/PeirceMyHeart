(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();class c{constructor(e,n,r){if(e.length!==1)throw new Error("String of length "+e.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(e))throw new Error(e+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=e,this.internalOrigin=n,this.internalRectangle=r}get rectangle(){return this.internalRectangle}set rectangle(e){this.internalRectangle=e}get identifier(){return this.internalIdentifier}set identifier(e){this.internalIdentifier=e}get origin(){return this.internalOrigin}set origin(e){this.internalOrigin=e}containsPoint(e){return this.internalRectangle.containsPoint(e)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.internalRectangle.toString()}}class s{constructor(e,n){if(this.x=e,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(e,n){if(!Number.isFinite(e)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=e,this.y=n}distance(e){const n=this.x-e.x,r=this.y-e.y;return Math.sqrt(n*n+r*r)}toString(){return"("+this.x+", "+this.y+")"}}class u{constructor(e,n,r){if(!Number.isFinite(n)||!Number.isFinite(r))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(r!==void 0&&r<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=e,this.width=n,this.height=r}getCorners(){const e=[this.startVertex];return e.push(new s(this.startVertex.x+this.width,this.startVertex.y)),e.push(new s(this.startVertex.x+this.width,this.startVertex.y+this.height)),e.push(new s(this.startVertex.x,this.startVertex.y+this.height)),e}containsPoint(e){return P(this,e)}overlaps(e){return v(this,e)}contains(e){return C(this,e)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}function v(t,e){return j(t,e)||C(e,t)}function j(t,e){if(t instanceof u)return e instanceof u?D(t,e):T(e,t);if(e instanceof u)return T(t,e);if(D(t.boundingBox,e.boundingBox)||C(e.boundingBox,t.boundingBox)){const n=V(t);let r;for(let i=0;i<n.length;i++)if(r=A(e,n[i]),r<=0)return!0;return!1}return!1}function T(t,e){const n=V(t);for(let r=0;r<n.length;r++)if(P(e,n[r]))return!0;return!1}function C(t,e){if(t instanceof u)if(e instanceof u){const n=e.getCorners();for(let r=0;r<4;r++)if(!P(t,n[r]))return!1;return!0}else{const n=_(e);for(let r=0;r<4;r++)if(!P(t,n[r]))return!1;return!0}else if(e instanceof u){const n=e.getCorners();let r;for(let i=0;i<4;i++)if(r=A(t,n[i]),!(r<0))return!1;return!0}else{const n=V(e);let r;for(let i=0;i<n.length;i++)if(r=A(t,n[i]),!(r<0))return!1;return!0}}function D(t,e){const n=t.getCorners(),r=e.getCorners();return(n[0].y<=r[0].y&&n[2].y>=r[0].y||n[0].y<=r[2].y&&n[2].y>=r[2].y||r[0].y<=n[0].y&&r[2].y>=n[0].y||r[0].y<=n[2].y&&r[2].y>=n[2].y)&&(n[0].x<=r[0].x&&n[1].x>=r[0].x||n[0].x<=r[1].x&&n[1].x>=r[1].x||r[0].x<=n[0].x&&r[1].x>=n[0].x||r[0].x<=n[1].x&&r[1].x>=n[1].x)}function P(t,e){const n=t.getCorners();return n[0].x<e.x&&n[1].x>e.x&&n[0].y<e.y&&n[2].y>e.y}function A(t,e){return Math.pow(e.x-t.center.x,2)/Math.pow(t.radiusX,2)+Math.pow(e.y-t.center.y,2)/Math.pow(t.radiusY,2)-1}function _(t){return[new s(t.center.x,t.center.y-t.radiusY),new s(t.center.x+t.radiusX,t.center.y),new s(t.center.x,t.center.y+t.radiusY),new s(t.center.x-t.radiusX,t.center.y)]}function V(t){const e=[];let n,r,i=1;for(let o=0;o<360;o++)n=t.center.x+t.radiusX*Math.cos(o*(Math.PI/180)),o>180&&(i=-1),r=ee(t,n,i),e[o]=new s(n,r);return e}function ee(t,e,n){return t.radiusX===0||t.radiusY===0?t.center.y:n*t.radiusY*Math.sqrt(1-Math.pow((e-t.center.x)/t.radiusX,2))+t.center.y}class f{constructor(e,n){this.internalEllipse=e,this.internalChildren=n??[]}get ellipse(){return this.internalEllipse}set ellipse(e){this.internalEllipse=e}get children(){return this.internalChildren}set children(e){this.internalChildren=e}set child(e){this.internalChildren.push(e)}getCurrentCut(e){for(let n=0;n<this.internalChildren.length;n++){const r=this.internalChildren[n];if(r instanceof f&&r.containsNode(e))return r.getCurrentCut(e)}return this}containsPoint(e){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(e)}containsNode(e){return this.internalEllipse===null?!0:e instanceof c?C(this.internalEllipse,e.rectangle):C(this.internalEllipse,e.internalEllipse)}remove(e){if(this.containsPoint(e)){let n=!0;for(let r=0;r<this.internalChildren.length;r++)if(this.internalChildren[r].containsPoint(e))return n=!1,this.internalChildren[r]instanceof f?this.internalChildren[r].remove(e):(this.internalChildren=this.internalChildren.splice(r,1),!0);if(n)return!0}return!1}toString(){let e;return this.internalEllipse===null?e="Sheet of Assertion of the AEG Tree":e=`A cut node with boundary box of 
`+this.internalEllipse.toString(),this.internalChildren.length>0&&(e+=`, 
With nested nodes: `+this.internalChildren.toString()),e}toFormulaString(){let e="";for(const n of this.internalChildren)n instanceof c?e+=n.identifier:n instanceof f&&(e+=n.toFormulaString()),e+=" ";return e=e.slice(0,-1),this.internalEllipse===null?e="["+e+"]":e="("+e+")",e}}class L{constructor(e){this.internalSheet=e??new f(null)}get sheet(){return this.internalSheet}set sheet(e){this.internalSheet=e}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(e){for(let n=0;n<e.children.length;n++){if(!e.containsNode(e.children[n]))return!1;for(let r=n+1;r<e.children.length;r++)if(this.overlaps(e.children[n],e.children[r]))return!1}for(let n=0;n<e.children.length;n++)if(e.children[n]instanceof f&&!this.verifyAEG(e.children[n]))return!1;return!0}canInsert(e){const n=this.internalSheet.getCurrentCut(e);for(let r=0;r<n.children.length;r++)if(this.intersects(e,n.children[r]))return!1;return!0}insert(e){if(!this.canInsert(e))throw new Error("Insertion failed. "+e+" had a collision.");const n=this.internalSheet.getCurrentCut(e),r=[...n.children];if(n.child=e,e instanceof f)for(let i=r.length-1;i>=0;i--)e.containsNode(r[i])&&(e.child=r[i],n.children.splice(i,1))}remove(e){this.internalSheet.remove(e)}intersects(e,n){const r=e instanceof c?e.rectangle:e.ellipse,i=n instanceof c?n.rectangle:n.ellipse;return j(r,i)}overlaps(e,n){let r,i;return e instanceof c?n instanceof c?v(e.rectangle,n.rectangle):(r=n.ellipse,v(e.rectangle,r)):n instanceof c?(r=e.ellipse,v(r,n.rectangle)):(r=e.ellipse,i=n.ellipse,v(r,i))}toString(){return this.internalSheet.toFormulaString()}}class F{constructor(e,n,r){if(this.center=e,this.radiusX=n,this.radiusY=r,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const i=new s(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new u(i,this.radiusX*2,this.radiusY*2)}containsPoint(e){return A(this,e)<0}overlaps(e){return v(this,e)}contains(e){return C(this,e)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}const m=document.getElementById("canvas"),G=m.getContext("2d"),te=document.getElementById("showRect"),ne=document.getElementById("mode");if(G===null)throw Error("2d rendering context not supported");const w=G;let E=new F(new s(0,0),0,0),I=new s(0,0),O;function re(t){I.x=t.clientX,I.y=t.clientY,O=!1}function ie(t){const e=new f(new F(new s(0,0),0,0)),n=new s(0,0);n.x=t.clientX,n.y=t.clientY,w.clearRect(0,0,m.width,m.height),y(a.sheet),E=z(I,n),e.ellipse=E,O||(a.canInsert(e)&&J(E)?$(e,"#00FF00"):$(e,"#FF0000"))}function se(t){let e=new f(E);const n=new s(0,0);n.x=t.clientX,n.y=t.clientY,E=z(I,n),e=new f(E),a.canInsert(e)&&!O&&J(E)&&a.insert(e),I=new s(0,0),w.clearRect(0,0,m.width,m.height),y(a.sheet)}function oe(){O=!0,I=new s(0,0),w.clearRect(0,0,m.width,m.height),y(a.sheet)}function z(t,e){const n=new s((e.x-t.x)/2+t.x,(e.y-t.y)/2+t.y),r=t.x-e.x,i=t.y-e.y,o=Math.abs(r),p=Math.abs(i);let S,X;if(ne.value==="circumscribed"){const H=Math.floor(n.distance(e));X=Math.floor(H*(p/o)),S=Math.floor(H*(o/p))}else S=o/2,X=p/2;return te.checked&&(w.beginPath(),w.rect(t.x,t.y,-r,-i),w.stroke()),new F(n,S,X)}function $(t,e){w.strokeStyle=e;const n=t.ellipse,r=n.center;w.beginPath(),w.ellipse(r.x,r.y,n.radiusX,n.radiusY,0,0,2*Math.PI),w.stroke()}function J(t){return t.radiusX>15&&t.radiusY>15}const g=document.getElementById("canvas"),W=g.getContext("2d");if(W===null)throw Error("2d rendering context not supported");const h=W,q=document.getElementById("atomDisplay");let b,k,l=new c("A",new s(0,0),new u(new s(0,0),0,0));q.innerHTML=l.identifier;function le(t){new RegExp(/^[A-Za-z]$/).test(t.key)&&(l.identifier=t.key,q.innerHTML=l.identifier)}function ae(t){b=h.measureText(l.identifier),k=!1;const e=new s(t.clientX,t.clientY-b.actualBoundingBoxAscent);l.rectangle=new u(e,b.width,b.fontBoundingBoxDescent+b.actualBoundingBoxAscent),l.origin=new s(t.clientX,t.clientY),h.clearRect(0,0,g.width,g.height),y(a.sheet),a.canInsert(l)?B(l,"#00FF00"):B(l,"#FF0000")}function ce(t){l.origin=new s(t.clientX,t.clientY),l.rectangle.startVertex=new s(t.clientX,t.clientY-b.actualBoundingBoxAscent),h.clearRect(0,0,g.width,g.height),y(a.sheet),k||(a.canInsert(l)?B(l,"#00FF00"):B(l,"#FF0000"))}function ue(){a.canInsert(l)&&!k&&a.insert(l),l=new c(l.identifier,new s(0,0),new u(new s(0,0),0,0)),h.clearRect(0,0,g.width,g.height),y(a.sheet),console.log(a.toString())}function he(){l=new c(l.identifier,new s(0,0),new u(new s(0,0),0,0)),k=!0,h.clearRect(0,0,g.width,g.height),y(a.sheet)}function B(t,e){h.fillStyle=e,h.strokeStyle=e;const n=t.rectangle;h.beginPath(),h.fillText(t.identifier,t.origin.x,t.origin.y),h.rect(n.startVertex.x,n.startVertex.y,n.width,n.height),h.stroke()}function de(t){return JSON.stringify(t,null,"	")}function fe(t){if(typeof t=="string"){const n=JSON.parse(t).internalSheet.internalChildren,r=new L,i=[];return n.forEach(o=>{Object.prototype.hasOwnProperty.call(o,"internalEllipse")?i.push(U(o)):i.push(K(o))}),r.sheet.children=i,r}return null}function U(t){const e=new F(new s(t.internalEllipse.center.x,t.internalEllipse.center.y),t.internalEllipse.radiusX,t.internalEllipse.radiusY),n=[];return t.internalChildren.forEach(r=>{"internalEllipse"in r?n.push(U(r)):n.push(K(r))}),new f(e,n)}function K(t){const e=new u(new s(t.internalRectangle.startVertex.x,t.internalRectangle.startVertex.y),t.internalRectangle.width,t.internalRectangle.height),n=t.internalIdentifier,r=new s(t.internalOrigin.x,t.internalOrigin.y);return new c(n,r,e)}const x=document.getElementById("canvas");x.width=window.innerWidth;x.height=window.innerHeight;const Z=x.getContext("2d");if(Z===null)throw Error("2d rendering context not supported");const d=Z;d.font="35pt arial";const we=document.getElementById("graphString"),Q=document.getElementById("cutTools"),N=document.getElementById("atomTools");window.addEventListener("keypress",Ee);x.addEventListener("mousedown",me);x.addEventListener("mousemove",Me);x.addEventListener("mouseup",be);x.addEventListener("mouseout",ve);x.addEventListener("mouseenter",Ce);let M="",R=!1,Y=!0,a=new L;window.atomMode=ye;window.ellipseMode=ge;window.saveMode=xe;window.loadMode=pe;function ge(){M="cutMode",Q.style.display="block",N.style.display="none"}function ye(){M="atomMode",N.style.display="block",Q.style.display="none"}async function xe(){const t=de(a);if("showSaveFilePicker"in window){const n=await(await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"AEG Tree",startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]})).createWritable();await n.write(t),await n.close()}else{const e=document.createElement("a");e.href=t,e.download="AEGTree.json",e.click()}}async function pe(){const[t]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),e=await t.getFile(),n=new FileReader;n.addEventListener("load",()=>{const r=n.result,i=fe(r);i instanceof L&&(a=i,y(a.sheet))}),n.readAsText(e)}function Ee(t){switch(M){case"atomMode":le(t);break}}function me(t){switch(M){case"cutMode":re(t);break;case"atomMode":ae(t);break}R=!0}function Me(t){switch(M){case"cutMode":R&&Y&&ie(t);break;case"atomMode":R&&Y&&ce(t);break}}function be(t){switch(M){case"cutMode":se(t);break;case"atomMode":ue();break}R=!1}function ve(){switch(M){case"cutMode":oe();break;case"atomMode":he();break}}function Ce(){Y=!0}function y(t){we.innerHTML=a.toString();for(let e=0;t.children.length>e;e++)t.children[e]instanceof c?Ie(t.children[e]):y(t.children[e]);t.ellipse instanceof F&&(d.strokeStyle="#000000",d.beginPath(),d.ellipse(t.ellipse.center.x,t.ellipse.center.y,t.ellipse.radiusX,t.ellipse.radiusY,0,0,2*Math.PI),d.stroke())}function Ie(t){const e=t.rectangle;d.strokeStyle="#000000",d.fillStyle="#000000",d.beginPath(),d.rect(e.startVertex.x,e.startVertex.y,e.width,e.height),d.fillText(t.identifier,t.origin.x,t.origin.y),d.stroke()}
