(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const v of n.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();class o{constructor(e,t){this.x=e??0,this.y=t??0}set(e,t){this.x=e,this.y=t}distance(e){const t=this.x-e.x,s=this.y-e.y;return Math.sqrt(t*t+s*s)}toString(){return"X: "+this.x+", Y: "+this.y}}class P{constructor(e,t,s){this.center=e??new o,this.radiusX=t??0,this.radiusY=s??0;const i=new o(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new m(i,this.radiusX*2,this.radiusY*2)}toString(){return"An ellipse with Center at: "+this.center.toString()+`, 
Horizontal Radius of: `+this.radiusX+`, 
Vertical Radius of: `+this.radiusY+`, 
Bounding box: `+this.boundingBox.toString()}containsPoint(e){return Math.ceil(Math.pow(e.x-this.center.x,2)/Math.pow(this.radiusX,2)+Math.pow(e.y-this.center.y,2)/Math.pow(this.radiusY,2))<=1}overlaps(e){if(e instanceof m){for(let t=0;t<4;t++)if(this.containsPoint(e.getCorners()[t]))return!0;return!1}else{if(this.boundingBox.overlaps(e.boundingBox)||e.boundingBox.containsShape(this.boundingBox)){const t=this.getEllipsePoints();for(let s=0;s<t.length;s++)if(e.containsPoint(t[s]))return!0}return!1}}containsShape(e){if(e instanceof m){for(let t=0;t<4;t++)if(!this.containsPoint(e.getCorners()[t]))return!1;return!0}else if(e instanceof P){const t=e.getWidestCoordinates();for(let s=0;s<4;s++)if(!this.containsPoint(t[s]))return!1;return!0}throw Error("Invalid Shape passed to containsShape, must be a Rectangle | Ellipse")}getWidestCoordinates(){return[new o(this.center.x,this.center.y-this.radiusY),new o(this.center.x+this.radiusX,this.center.y),new o(this.center.x,this.center.y+this.radiusY),new o(this.center.x-this.radiusX,this.center.y)]}getEllipsePoints(){const e=[],t=this.radiusX/15;e[0]=this.getWidestCoordinates()[3];let s,i;for(let n=1;n<64;n++)n<33?(s=e[n-1].x+t,i=this.getCurvePoint(s,1)):(s=e[n-1].x-t,i=this.getCurvePoint(s,-1)),e[n]=new o(s,i);return e}getCurvePoint(e,t){return t*this.radiusY*Math.sqrt(1-Math.pow((e-this.center.x)/this.radiusX,2))+this.center.y}}class m{constructor(e,t,s){this.startVertex=e??new o,this.width=t??0,this.height=s??0}getCorners(){const e=[this.startVertex];return e.push(new o(this.startVertex.x+this.width,this.startVertex.y)),e.push(new o(this.startVertex.x+this.width,this.startVertex.y+this.height)),e.push(new o(this.startVertex.x,this.startVertex.y+this.height)),e}containsPoint(e){const t=this.getCorners();return t[0].x<=e.x&&t[1].x>=e.x&&t[1].y<=e.y&&t[2].y>=e.y}overlaps(e){if(e instanceof m)return this.edgesOverlap(e);if(e instanceof P){for(let t=0;t<4;t++)if(e.containsPoint(this.getCorners()[t]))return!0;return!1}else throw Error("Invalid Shape passed to overlaps, must be a Rectangle | Ellipse")}edgesOverlap(e){const t=this.getCorners(),s=e.getCorners();return t[0].y<=s[0].y&&t[2].y>=s[0].y||s[0].y<=t[0].y&&s[2].y>=t[0].y||t[0].y<=s[2].y&&t[2].y>=s[2].y||s[0].y<=t[2].y&&s[2].y>=t[2].y?t[0].x<=s[0].x&&t[1].x>=s[0].x||s[0].x<=t[0].x&&s[1].x>=t[0].x||t[0].x<=s[1].x&&t[1].x>=s[1].x?!0:s[0].x<=t[1].x&&s[1].x>=t[1].x:!1}containsShape(e){if(e instanceof m){const t=e.getCorners();return this.containsPoint(t[0])&&this.containsPoint(t[2])}else{for(let t=0;t<4;t++)if(!this.containsPoint(e.getWidestCoordinates()[t]))return!1;return!0}}toString(){return`A rectangle with
Top Left Vertex at: `+this.startVertex.toString()+", Width: "+this.width+", Height: "+this.height}}class f{constructor(e,t,s){this.rect=s??new m,this.identifier=e??"",this.origin=t??new o}containsPoint(e){return this.rect.containsPoint(e)}containsNode(e){return e instanceof f?this.rect.containsShape(e.rect):this.rect.containsShape(e.ellipse)}toString(){return"An atom representing the proposition: "+this.identifier+" and Boundary box of: "+this.rect.toString()}}class x{constructor(e,t){this.ellipse=e??new P,this.children=t??[]}getCurrentCut(e){for(let t=0;t<this.children.length;t++){const s=this.children[t];if(s instanceof x&&this.children[t].containsNode(e))return s.getCurrentCut(e)}return this}containsPoint(e){return this.ellipse===null?!0:this.ellipse.containsPoint(e)}containsNode(e){if(this.ellipse===null)return!0;if(e instanceof f)return this.ellipse.containsShape(e.rect);if(e instanceof x)return this.ellipse.containsShape(e.ellipse);throw Error("containsNode expected AtomNode or CutNode")}remove(e){if(this.containsPoint(e)){let t=!0;for(let s=0;s<this.children.length;s++)if(this.children[s].containsPoint(e))return t=!1,this.children[s]instanceof x?this.children[s].remove(e):(this.children=this.children.splice(s,1),!0);if(t)return!0}return!1}toString(){let e;return this.ellipse===null?e="Sheet of Assertion of the AEG Tree":e=`A cut node with boundary box of 
`+this.ellipse.toString(),this.children.length>0&&(e+=`, 
With nested nodes: `+this.children.toString()),e}toFormulaString(){let e="";for(const t of this.children)t instanceof f?e+=t.identifier:t instanceof x&&(e+=t.toFormulaString()),e+=" ";return e=e.slice(0,-1),this.ellipse===null?e="["+e+"]":e="("+e+")",e}}class T{constructor(e){this.sheet=e??new x,this.sheet.ellipse=null}verify(){return this.verifyAEG(this.sheet)}verifyAEG(e){for(let t=0;t<e.children.length;t++){if(!e.containsNode(e.children[t]))return!1;for(let s=t+1;s<e.children.length;s++)if(this.overlaps(e.children[t],e.children[s]))return!1}for(let t=0;t<e.children.length;t++)if(e.children[t]instanceof x&&!this.verifyAEG(e.children[t]))return!1;return!0}canInsert(e){const t=this.sheet.getCurrentCut(e);for(let s=0;s<t.children.length;s++)if(this.overlaps(e,t.children[s]))return!1;return!0}insert(e){if(!this.canInsert(e))throw new Error("Insertion failed. "+e+" had a collision.");const t=this.sheet.getCurrentCut(e),s=[...t.children];if(t.children.push(e),e instanceof x)for(let i=0;i<s.length;i++)e.containsNode(s[i])&&(e.children.push(s[i]),t.children=t.children.splice(i,1))}remove(e){this.sheet.remove(e)}overlaps(e,t){let s,i;return e instanceof f?t instanceof f?e.rect.overlaps(t.rect):(s=t.ellipse,e.rect.overlaps(s)):t instanceof f?(s=e.ellipse,s.overlaps(t.rect)):(s=e.ellipse,i=t.ellipse,s.overlaps(i))}toString(){return this.sheet.toFormulaString()}}const M=document.getElementById("canvas"),R=M.getContext("2d"),W=document.getElementById("showRect"),H=document.getElementById("mode");if(R===null)throw Error("2d rendering context not supported");const p=R;let S=!1,E=new P,B=new o;function g(r){let e=new x;const t=new o;r.type==="mousedown"?(S=!0,B.x=r.clientX,B.y=r.clientY):r.type==="mousemove"&&S?(t.x=r.clientX,t.y=r.clientY,p.clearRect(0,0,M.width,M.height),w(a.sheet),E=D(B,t),e.ellipse=E,a.canInsert(e)&&E.radiusX>15&&E.radiusY>15?A(e,"#00FF00"):A(e,"#FF0000")):r.type==="mouseup"&&S?(e=new x(E),a.canInsert(e)&&E.radiusX>15&&E.radiusY>15&&a.insert(e),S=!1,B=new o,p.clearRect(0,0,M.width,M.height),w(a.sheet),console.log(a.toString())):r.type==="mouseout"&&S&&(S=!1,B=new o,p.clearRect(0,0,M.width,M.height),w(a.sheet))}function D(r,e){const t=new o((e.x-r.x)/2+r.x,(e.y-r.y)/2+r.y),s=r.x-e.x,i=r.y-e.y,n=Math.abs(s),v=Math.abs(i);let I,Y;if(H.value==="circumscribed"){const V=Math.floor(t.distance(e));Y=Math.floor(V*(v/n)),I=Math.floor(V*(n/v))}else I=n/2,Y=v/2;return W.checked&&(p.beginPath(),p.rect(r.x,r.y,-s,-i),p.stroke()),new P(t,I,Y)}function A(r,e){p.strokeStyle=e;const t=r.ellipse,s=t.center;p.beginPath(),p.ellipse(s.x,s.y,t.radiusX,t.radiusY,0,0,2*Math.PI),p.stroke()}const y=document.getElementById("canvas"),k=y.getContext("2d");if(k===null)throw Error("2d rendering context not supported");const u=k;let C,L=!1,F=!1,c=new f;function d(r){if(r.type==="keypress"){const e=r;new RegExp(/^[A-Za-z]$/).test(e.key)&&(c.identifier=e.key,F=!0)}else if(r.type==="mousedown"&&F){const e=r;C=u.measureText(c.identifier);const t=new o(e.clientX,e.clientY-C.actualBoundingBoxAscent);c.rect=new m(t,C.width,C.fontBoundingBoxDescent+C.actualBoundingBoxAscent),c.origin=new o(e.clientX,e.clientY),u.clearRect(0,0,y.width,y.height),w(a.sheet),a.canInsert(c)?X(c,"#00FF00"):X(c,"#6600ff"),L=!0}else if(r.type==="mousemove"&&L){const e=r;c.origin=new o(e.clientX,e.clientY),c.rect.startVertex=new o(e.clientX,e.clientY-C.actualBoundingBoxAscent),u.clearRect(0,0,y.width,y.height),w(a.sheet),a.canInsert(c)?X(c,"#00FF00"):X(c,"#FF0000")}else r.type==="mouseup"&&L?(a.canInsert(c)&&a.insert(c),c=new f(c.identifier),u.clearRect(0,0,y.width,y.height),w(a.sheet),L=!1,console.log(a.toString())):r.type==="mouseout"&&L&&(L=!1,c=new f(c.identifier),u.clearRect(0,0,y.width,y.height),w(a.sheet))}function X(r,e){u.fillStyle=e,u.strokeStyle=e;const t=r.rect;u.beginPath(),u.fillText(r.identifier,r.origin.x,r.origin.y),u.rect(t.startVertex.x,t.startVertex.y,t.width,t.height),u.stroke()}const l=document.getElementById("canvas");l.width=window.innerWidth;l.height=window.innerHeight;const O=l.getContext("2d");if(O===null)throw Error("2d rendering context not supported");const h=O;h.font="35pt arial";const G=document.getElementById("graphString");let b;const a=new T;window.atomMode=j;window.ellipseMode=q;function q(){b!=="ellipseMode"&&($(),b="ellipseMode"),l.addEventListener("mousedown",g),l.addEventListener("mousemove",g),l.addEventListener("mouseup",g),l.addEventListener("mouseout",g)}function j(){b!=="atomMode"&&($(),b="atomMode"),window.addEventListener("keypress",d),l.addEventListener("mousedown",d),l.addEventListener("mousemove",d),l.addEventListener("mouseup",d),l.addEventListener("mouseout",d)}function $(){b==="ellipseMode"?(l.removeEventListener("mousedown",g),l.removeEventListener("mousemove",g),l.removeEventListener("mouseup",g),l.removeEventListener("mouseout",g)):b==="atomMode"&&(window.removeEventListener("keypress",d),l.removeEventListener("mousedown",d),l.removeEventListener("mousemove",d),l.removeEventListener("mouseup",d),l.removeEventListener("mouseout",d))}function w(r){G.innerHTML=a.toString();for(let e=0;r.children.length>e;e++)r.children[e]instanceof f?z(r.children[e]):w(r.children[e]);r.ellipse instanceof P&&(h.strokeStyle="#000000",h.beginPath(),h.ellipse(r.ellipse.center.x,r.ellipse.center.y,r.ellipse.radiusX,r.ellipse.radiusY,0,0,2*Math.PI),h.stroke())}function z(r){const e=r.rect;h.strokeStyle="#000000",h.fillStyle="#000000",h.beginPath(),h.rect(e.startVertex.x,e.startVertex.y,e.width,e.height),h.fillText(r.identifier,r.origin.x,r.origin.y),h.stroke()}
