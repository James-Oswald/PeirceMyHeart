/* empty css               */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const g of u.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&o(g)}).observe(document,{childList:!0,subtree:!0});function n(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(i){if(i.ep)return;i.ep=!0;const u=n(i);fetch(i.href,u)}})();class c{constructor(t,n){if(this.x=t,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(t,n){if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=t,this.y=n}distance(t){const n=this.x-t.x,o=this.y-t.y;return Math.sqrt(n*n+o*o)}toString(){return"("+this.x+", "+this.y+")"}}function xe(e,t){return Kt(e,t)||Me(t,e)}function Kt(e,t){if(e instanceof ce)return t instanceof ce?Ot(e,t):Nt(t,e);if(t instanceof ce)return Nt(e,t);if(Ot(e.boundingBox,t.boundingBox)||Me(t.boundingBox,e.boundingBox)){const n=Zt(e);let o;for(let i=0;i<n.length;i++)if(o=We(t,n[i]),o<=0)return!0;return!1}return!1}function Nt(e,t){const n=t.getCorners(),o=Ne(e,n[0].x,1),i=Ne(e,n[1].x,1),u=Ne(e,n[0].x,-1),g=Ne(e,n[1].x,-1);if(n[0].y<o&&o<n[2].y||n[0].y<u&&u<n[2].y||n[0].y<i&&i<n[2].y||n[0].y<g&&g<n[2].y)return!0;const x=-1/Math.pow(e.radiusX,2),$=2*e.center.x/Math.pow(e.radiusX,2),ye=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[0].y-e.center.y)/e.radiusY,2),Bt=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[2].y-e.center.y)/e.radiusY,2),it=(-$+Math.sqrt(Math.pow($,2)-4*x*ye))/(2*x),lt=(-$-Math.sqrt(Math.pow($,2)-4*x*ye))/(2*x),st=(-$+Math.sqrt(Math.pow($,2)-4*x*Bt))/(2*x),ct=(-$-Math.sqrt(Math.pow($,2)-4*x*Bt))/(2*x);return!isNaN(it)&&n[0].x<it&&it<n[1].x||!isNaN(lt)&&n[0].x<lt&&lt<n[1].x||!isNaN(st)&&n[0].x<st&&st<n[1].x||!isNaN(ct)&&n[0].x<ct&&ct<n[1].x}function Me(e,t){if(e instanceof ce)if(t instanceof ce){const n=t.getCorners();for(let o=0;o<4;o++)if(!wt(e,n[o]))return!1;return!0}else{const n=bn(t);for(let o=0;o<4;o++)if(!wt(e,n[o]))return!1;return!0}else if(t instanceof ce){const n=t.getCorners();let o;for(let i=0;i<4;i++)if(o=We(e,n[i]),!(o<0))return!1;return!0}else{const n=Zt(t);let o;for(let i=0;i<n.length;i++)if(o=We(e,n[i]),!(o<0))return!1;return!0}}function Ot(e,t){const n=e.getCorners(),o=t.getCorners();return(n[0].y<=o[0].y&&n[2].y>=o[0].y||n[0].y<=o[2].y&&n[2].y>=o[2].y||o[0].y<=n[0].y&&o[2].y>=n[0].y||o[0].y<=n[2].y&&o[2].y>=n[2].y)&&(n[0].x<=o[0].x&&n[1].x>=o[0].x||n[0].x<=o[1].x&&n[1].x>=o[1].x||o[0].x<=n[0].x&&o[1].x>=n[0].x||o[0].x<=n[1].x&&o[1].x>=n[1].x)}function wt(e,t){const n=e.getCorners();return n[0].x<t.x&&n[1].x>t.x&&n[0].y<t.y&&n[2].y>t.y}function We(e,t){return Math.pow(t.x-e.center.x,2)/Math.pow(e.radiusX,2)+Math.pow(t.y-e.center.y,2)/Math.pow(e.radiusY,2)-1}function bn(e){return[new c(e.center.x,e.center.y-e.radiusY),new c(e.center.x+e.radiusX,e.center.y),new c(e.center.x,e.center.y+e.radiusY),new c(e.center.x-e.radiusX,e.center.y)]}function Zt(e){const t=[];let n,o,i=1;for(let u=0;u<360;u++)n=e.center.x+e.radiusX*Math.cos(u*(Math.PI/180)),u>180&&(i=-1),o=Ne(e,n,i),t[u]=new c(n,o);return t}function Ne(e,t,n){return e.radiusX===0||e.radiusY===0?e.center.y:n*e.radiusY*Math.sqrt(1-Math.pow((t-e.center.x)/e.radiusX,2))+e.center.y}class ce{constructor(t,n,o){if(!Number.isFinite(n)||!Number.isFinite(o))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(o!==void 0&&o<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=t,this.width=n,this.height=o}getCorners(){const t=[this.startVertex];return t.push(new c(this.startVertex.x+this.width,this.startVertex.y)),t.push(new c(this.startVertex.x+this.width,this.startVertex.y+this.height)),t.push(new c(this.startVertex.x,this.startVertex.y+this.height)),t}containsPoint(t){return wt(this,t)}overlaps(t){return xe(this,t)}contains(t){return Me(this,t)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}class f{constructor(t,n,o,i){if(t.length!==1)throw new Error("String of length "+t.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(t))throw new Error(t+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=t,this.internalOrigin=n,this.internalWidth=o,this.internalHeight=i}copy(){return new f(this.internalIdentifier,new c(this.internalOrigin.x,this.internalOrigin.y),this.internalWidth,this.internalHeight)}get width(){return this.internalWidth}set width(t){this.internalWidth=t}get height(){return this.internalHeight}set height(t){this.internalHeight=t}get identifier(){return this.internalIdentifier}set identifier(t){this.internalIdentifier=t}get origin(){return this.internalOrigin}set origin(t){this.internalOrigin=t}containsPoint(t){return this.calcRect().containsPoint(t)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.calcRect().toString()}calcRect(){return new ce(new c(this.internalOrigin.x,this.internalOrigin.y-this.internalHeight),this.internalWidth,this.internalHeight)}isEqualTo(t){return this.identifier===t.identifier}}class Q{constructor(t,n,o){if(this.center=t,this.radiusX=n,this.radiusY=o,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const i=new c(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new ce(i,this.radiusX*2,this.radiusY*2)}containsPoint(t){return We(this,t)<0}overlaps(t){return xe(this,t)}contains(t){return Me(this,t)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}class a{constructor(t,n){this.internalEllipse=t,this.internalChildren=n??[]}copy(){let t;const n=[];if(this.ellipse!==null?t=new Q(new c(this.ellipse.center.x,this.ellipse.center.y),this.ellipse.radiusX,this.ellipse.radiusY):t=null,this.children.length>0)for(let o=0;o<this.children.length;o++){const i=this.children[o];i instanceof f,n.push(i.copy())}return new a(t,n)}get ellipse(){return this.internalEllipse}set ellipse(t){this.internalEllipse=t}get children(){return this.internalChildren}set children(t){this.internalChildren=t}set child(t){this.internalChildren.push(t)}getCurrentCut(t){for(let n=0;n<this.internalChildren.length;n++){const o=this.internalChildren[n];if(o instanceof a&&o.containsNode(t))return o.getCurrentCut(t)}return this}containsPoint(t){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(t)}containsNode(t){return this.internalEllipse===null?!0:t instanceof f?Me(this.internalEllipse,t.calcRect()):Me(this.internalEllipse,t.internalEllipse)}getLowestNode(t){if(!this.containsPoint(t))return null;for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t))return this.internalChildren[n]instanceof f||this.internalChildren[n]instanceof a&&this.internalChildren[n].children.length===0?this.internalChildren[n]:this.internalChildren[n].getLowestNode(t);return this}getLowestParent(t){if(!this.containsPoint(t))throw new Error("This parent "+this.toString+" does not contain the point.");for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t)){if(this.internalChildren[n]instanceof f||this.internalChildren[n]instanceof a&&this.internalChildren[n].children.length===0)return this;{const o=this.internalChildren[n];for(let i=0;i<o.children.length;i++)if(o.children[i].containsPoint(t))return o.getLowestParent(t);return this}}return null}getLevel(t,n){for(let o=0;o<this.internalChildren.length;o++){if(this.internalChildren[o]===t)return n;if(this.internalChildren[o]instanceof a&&this.internalChildren[o].containsNode(t))return this.internalChildren[o].getLevel(t,n+1)}return-1}remove(t){if(!this.containsPoint(t))return!1;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(t)){if(this.children[n]instanceof f||this.children[n]instanceof a&&this.children[n].children.length===0)return this.children.splice(n,1),!0;for(let o=0;o<this.children[n].children.length;o++)if(this.children[n].children[o].containsPoint(t))if(this.children[n].children[o]instanceof f)this.children[n].children.splice(o,1);else return this.children[n].children[o].remove(t);return this.children.splice(n,1),!0}return!1}clear(){this.internalChildren=[]}toString(){let t;return this.internalEllipse===null?t="Sheet of Assertion of the AEG Tree":t="A cut node with boundary box of "+this.internalEllipse.toString(),this.internalChildren.length>0&&(t+=", With nested nodes: "+this.internalChildren.toString()),t}isEmptySheet(){return this.internalEllipse===null&&this.internalChildren.length===0}toFormulaString(){let t="";for(const n of this.internalChildren)n instanceof f?t+=n.identifier:n instanceof a&&(t+=n.toFormulaString()),t+=" ";return t=t.slice(0,-1),this.internalEllipse===null?t="["+t+"]":t="("+t+")",t}isEqualTo(t){if(this.children.length===t.children.length){if(this.children.length===0)return!0;const n=this.copy().children,o=t.copy().children;for(let i=0;i<n.length;i++)for(let u=0;u<o.length;u++){if(n[i]instanceof f&&o[u]instanceof f&&n[i].isEqualTo(o[u])||n[i]instanceof a&&o[u]instanceof a&&n[i].isEqualTo(o[u])){n.splice(i,1),o.splice(u,1),i--;break}if(u===o.length-1)return!1}return n.length===0&&o.length===0}return!1}}class F{constructor(t){t!==void 0?(this.internalSheet=t.copy(),this.internalSheet.ellipse=null):this.internalSheet=new a(null)}get sheet(){return this.internalSheet}set sheet(t){this.internalSheet=t}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(t){for(let n=0;n<t.children.length;n++){if(!t.containsNode(t.children[n]))return!1;for(let o=n+1;o<t.children.length;o++)if(this.overlaps(t.children[n],t.children[o]))return!1}for(let n=0;n<t.children.length;n++)if(t.children[n]instanceof a&&!this.verifyAEG(t.children[n]))return!1;return!0}canInsert(t){const n=this.internalSheet.getCurrentCut(t);for(let o=0;o<n.children.length;o++)if(this.intersects(t,n.children[o]))return!1;return!0}insert(t){if(!this.canInsert(t))throw new Error("Insertion failed. "+t+" had a collision.");const n=this.internalSheet.getCurrentCut(t),o=[...n.children];if(n.child=t,t instanceof a)for(let i=o.length-1;i>=0;i--)t.containsNode(o[i])&&(t.child=o[i],n.children.splice(i,1));return!0}getLowestNode(t){return this.internalSheet.getLowestNode(t)}getLowestParent(t){return this.internalSheet.getLowestParent(t)}getLevel(t){return this.internalSheet.getLevel(t,0)}remove(t){return this.internalSheet.remove(t)}clear(){this.internalSheet.clear()}intersects(t,n){const o=t instanceof f?t.calcRect():t.ellipse,i=n instanceof f?n.calcRect():n.ellipse;return Kt(o,i)}overlaps(t,n){let o,i;return t instanceof f?n instanceof f?xe(t.calcRect(),n.calcRect()):(o=n.ellipse,xe(t.calcRect(),o)):n instanceof f?(o=t.ellipse,xe(o,n.calcRect())):(o=t.ellipse,i=n.ellipse,xe(o,i))}isEqualTo(t){return this.sheet.isEqualTo(t.sheet)}toString(){return this.internalSheet.toFormulaString()}}class X{constructor(t,n){this.appliedRule=n??"",this.tree=new F(t==null?void 0:t.sheet),this.index=r.proof.length}}let pt,s=new c(0,0),Tt;function Sn(e){pt=new c(e.x-s.x,e.y-s.y),Tt=!1}function kn(e){Tt||(s=new c(e.x-pt.x,e.y-pt.y),r.modeState==="Proof"?w():d(r.tree))}function Cn(){Tt=!0,r.modeState==="Proof"?w():d(r.tree)}const En=document.getElementById("theme-select");function me(e){return getComputedStyle(document.body).getPropertyValue(e)}let Qt=me("--good-placement"),_t=me("--bad-placement"),en=me("--canvas-items");function tn(){setTimeout(()=>{Qt=me("--good-placement"),_t=me("--bad-placement"),en=me("--canvas-items"),r.modeState==="Draw"?d(r.tree):w()})}En.addEventListener("input",()=>{tn()});window.addEventListener("DOMContentLoaded",()=>{tn()});function h(){return _t}function p(){return Qt}function nn(){return en}const gt=document.getElementById("canvas"),on=gt.getContext("2d");if(on===null)throw Error("2d rendering context not supported");const M=on;M.font="35pt arial";const In=document.getElementById("graphString"),Dn=document.getElementById("proofString"),Ln=document.getElementById("atomBox"),rn=document.getElementById("atomBoxes");rn.addEventListener("input",$n);function L(e,t){const n=e.ellipse;if(n!==null){M.strokeStyle=t;const o=n.center;M.beginPath(),M.ellipse(o.x+s.x,o.y+s.y,n.radiusX,n.radiusY,0,0,2*Math.PI),M.stroke()}}function E(e,t,n){M.textBaseline="bottom";const o=M.measureText(e.identifier);M.fillStyle=t,M.strokeStyle=t,M.beginPath(),M.fillText(e.identifier,e.origin.x+s.x,e.origin.y+s.y),(rn.checked||Ln.checked&&n)&&M.rect(e.origin.x+s.x,e.origin.y+s.y-o.actualBoundingBoxAscent,e.width,e.height),M.stroke()}function ln(e,t,n){M.beginPath(),M.strokeStyle=n;const o=e.x-t.x+s.x,i=e.y-t.y+s.y;M.rect(e.x,e.y,-o,-i),M.stroke()}function $n(){d(r.tree)}function Qe(){M.clearRect(0,0,gt.width,gt.height)}function d(e,t){In.innerHTML=e.toString(),Qe(),Pt(e.sheet,t),window.treeString=rt(e)}function Pt(e,t){for(let n=0;e.children.length>n;n++)e.children[n]instanceof f?vn(e.children[n]):Pt(e.children[n]);e.ellipse instanceof Q&&(M.strokeStyle=t||nn(),M.beginPath(),M.ellipse(e.ellipse.center.x+s.x,e.ellipse.center.y+s.y,e.ellipse.radiusX,e.ellipse.radiusY,0,0,2*Math.PI),M.stroke())}function vn(e){E(e,nn(),!1)}function w(){let e;r.proof.length===0||r.currentProofStep===void 0?e=new F:e=r.currentProofStep.tree,Qe(),Dn.innerHTML=e.toString(),Pt(e.sheet)}function He(e,t){if(e instanceof f)E(e,t,!1);else if(e instanceof a){L(e,t);for(let n=0;n<e.children.length;n++)He(e.children[n],t)}}function sn(e,t){const n=new c(1,1);if(e instanceof a&&e.ellipse!==null){const o=e.ellipse,i=[new c(o.center.x-o.radiusX,o.center.y),new c(o.center.x,o.center.y-o.radiusY),new c(o.center.x+o.radiusX,o.center.y),new c(o.center.x,o.center.y+o.radiusY)];i[0].distance(t)>=i[2].distance(t)?n.x=1:n.x=-1,i[1].distance(t)>=i[3].distance(t)?n.y=1:n.y=-1}return n}function cn(e,t){var g;const n=document.createElement("div");n.className="row";const o=t||r.proof.length;n.id="Row: "+o;const i=document.createElement("button");i.type="button",i.id="Step: "+r.proof.length,i.className="proofNodeButton",i.title=e.tree.toString(),i.onclick=function(){Bn(e)};const u=document.createElement("Text");u.className="fa fa-"+{"Single Move":"mouse-pointer","Multi Move":"arrows",Resize:"arrows-alt","DC Insert":"dot-circle-o","DC Delete":"times-circle",Insertion:"plus",Erasure:"trash",Iteration:"expand",Deiteration:"compress",Pasted:"files-o"}[e.appliedRule],i.appendChild(u),n.appendChild(i),(g=document.getElementById("proofHistoryBar"))==null||g.appendChild(n)}function Bn(e){r.currentProofStep=e,w()}function yt(e){var t;for(let n=r.proof.length;n>e+1;n--)(t=document.getElementById("Row: "+n))==null||t.remove()}var l=(e=>(e[e.none=0]="none",e[e.atomTool=1]="atomTool",e[e.cutTool=2]="cutTool",e[e.dragTool=3]="dragTool",e[e.moveSingleTool=4]="moveSingleTool",e[e.moveMultiTool=5]="moveMultiTool",e[e.copySingleTool=6]="copySingleTool",e[e.copyMultiTool=7]="copyMultiTool",e[e.deleteSingleTool=8]="deleteSingleTool",e[e.deleteMultiTool=9]="deleteMultiTool",e[e.resizeTool=10]="resizeTool",e[e.copyFromDrawTool=11]="copyFromDrawTool",e[e.pasteInProofTool=12]="pasteInProofTool",e[e.doubleCutInsertionTool=13]="doubleCutInsertionTool",e[e.doubleCutDeletionTool=14]="doubleCutDeletionTool",e[e.insertionTool=15]="insertionTool",e[e.erasureTool=16]="erasureTool",e[e.proofMoveSingleTool=17]="proofMoveSingleTool",e[e.proofMoveMultiTool=18]="proofMoveMultiTool",e[e.proofResizeTool=19]="proofResizeTool",e[e.iterationTool=20]="iterationTool",e[e.deiterationTool=21]="deiterationTool",e[e.clearProofTool=22]="clearProofTool",e))(l||{});const Be=class Ge{static getLastProofStep(){return Ge.proof.length===0?new X(new F):Ge.proof[Ge.proof.length-1]}static pushToProof(t){var n;if(t.appliedRule==="Pasted")this.proof.pop(),(n=document.getElementById("Row: 1"))==null||n.remove(),t.index=0;else if(this.currentProofStep&&this.proof.length>0&&(!this.currentProofStep.tree.isEqualTo(this.proof[this.proof.length-1].tree)||this.currentProofStep.appliedRule!==this.proof[this.proof.length-1].appliedRule)){const o=this.currentProofStep.index;yt(o),this.proof=this.proof.splice(0,o+1),t.index=this.proof.length}this.currentProofStep=t,this.proof.push(t),cn(t)}static clearProof(){yt(-1),this.proof=[],this.pushToProof(new X),this.currentProofStep=this.proof[0]}};Be.tree=new F;Be.proof=[];Be.selectForProof=new F;Be.toolState=0;Be.modeState="Draw";let r=Be;async function Nn(e,t){const n=JSON.stringify(t,null,"	"),o=await e.createWritable();await o.write(n),await o.close()}function xt(e,t){const n=JSON.parse(t);if(e==="Draw"){const o=n.internalSheet.internalChildren;return Rt(o)}else{const o=[];let i;for(i of n){const u=i.tree.internalSheet.internalChildren;o.push(new X(Rt(u),i.appliedRule))}return o}}function Rt(e){const t=new F,n=[];for(const o of e)Object.prototype.hasOwnProperty.call(o,"internalEllipse")?n.push(an(o)):n.push(un(o));return t.sheet.children=n,t}function an(e){const t=new Q(new c(e.internalEllipse.center.x,e.internalEllipse.center.y),e.internalEllipse.radiusX,e.internalEllipse.radiusY),n=[];for(const o of e.internalChildren)"internalEllipse"in o?n.push(an(o)):n.push(un(o));return new a(t,n)}function un(e){const t=e.internalIdentifier,n=new c(e.internalOrigin.x,e.internalOrigin.y);return new f(t,n,e.internalWidth,e.internalHeight)}let at=!0,ut=null,ft=null,At=l.none,Ft=l.none;const Xt=document.getElementById("DrawButtons"),zt=document.getElementById("ProofButtons"),Yt=document.getElementById("proofHistoryBar");function On(){if(at=!at,at){Xt.style.display="block",Gt.style.display="block",zt.style.display="none",Wt.style.display="none",Yt.style.display="none",r.modeState="Draw",ft=JSON.stringify(r.proof),Ft=r.toolState;let e=null;if(ut!==null&&(e=xt(r.modeState,ut)),e!==null)r.tree.sheet=e.sheet;else throw Error("invalid cached AEG");r.toolState=At,d(r.tree)}else{Xt.style.display="none",Gt.style.display="none",zt.style.display="block",Wt.style.display="block",Yt.style.display="block",r.modeState="Proof",ut=JSON.stringify(r.tree),At=r.toolState,r.proof.length===0&&r.pushToProof(new X);let e=null;ft!==null&&(e=xt(r.modeState,ft)),e!==null&&(r.proof=e),r.toolState=Ft,w()}}const Rn=document.getElementById("mode");function ue(e,t,n){if(t.ellipse!==null){const o=q(t,n);if(!e.canInsert(o))return!1}for(let o=0;o<t.children.length;o++){if(t.children[o]instanceof a&&t.children[o].ellipse!==null&&!ue(e,t.children[o],n))return!1;if(t.children[o]instanceof f){let i=t.children[o];if(i=P(i,n),!e.canInsert(i))return!1}}return!0}function A(e,t,n){if(e instanceof a&&e.ellipse!==null){const o=q(e,n);if(L(o,t),e.children.length!==0)for(let i=0;i<e.children.length;i++)A(e.children[i],t,n)}else if(e instanceof f){const o=P(e,n);E(o,t,!0)}}function Ue(e,t,n){const o=n||r.tree;if(e instanceof a&&e.ellipse!==null){const i=q(e,t);if(o.insert(i),e.children.length!==0)for(let u=0;u<e.children.length;u++)Ue(e.children[u],t,n)}else if(e instanceof f){const i=P(e,t);o.insert(i)}}function Re(e,t){return e instanceof f?P(e,t):q(e,t)}function q(e,t){if(e.ellipse!==null)return new a(new Q(new c(e.ellipse.center.x+t.x-s.x,e.ellipse.center.y+t.y-s.y),e.ellipse.radiusX,e.ellipse.radiusY));throw new Error("Cannot alter the position of a cut without an ellipse.")}function bt(e,t){if(e.ellipse!==null){const n=[];for(let o=0;o<e.children.length;o++)e.children[o]instanceof a?n.push(bt(e.children[o],t)):e.children[o]instanceof f&&n.push(P(e.children[o],t));return new a(new Q(new c(e.ellipse.center.x+t.x-s.x,e.ellipse.center.y+t.y-s.y),e.ellipse.radiusX,e.ellipse.radiusY),n)}else throw new Error("Cannot alter the position of a cut without an ellipse.")}function P(e,t){return new f(e.identifier,new c(e.origin.x+t.x-s.x,e.origin.y+t.y-s.y),e.width,e.height)}function qe(e,t){if(e instanceof f)E(e,t,!0);else if(e instanceof a){L(e,t);for(let n=0;n<e.children.length;n++)qe(e.children[n],t)}}function _e(e,t,n){if(e.ellipse!==null)return new a(new Q(new c(e.ellipse.center.x+t.x,e.ellipse.center.y+t.y),e.ellipse.radiusX+t.x*n.x,e.ellipse.radiusY+t.y*n.y));throw new Error("Cannot alter the position of a cut without an ellipse.")}function et(e,t){const n=new c((t.x-e.x)/2+e.x,(t.y-e.y)/2+e.y),o=e.x-t.x,i=e.y-t.y,u=Math.abs(o),g=Math.abs(i);let x,$;if(Rn.value==="circumscribed"){const ye=Math.floor(n.distance(t));$=Math.floor(ye*(g/u)),x=Math.floor(ye*(u/g))}else x=u/2,$=g/2;return new Q(n,x,$)}function te(e){return e.radiusX>15&&e.radiusY>15}const An=document.getElementById("showRect");let je,tt;function Fn(e){je=new c(e.clientX-s.x,e.clientY-s.y),tt=!1}function Xn(e){const t=new a(new Q(new c(0,0),0,0)),n=new c(e.clientX-s.x,e.clientY-s.y);if(d(r.tree),t.ellipse=et(je,n),!tt){const i=r.tree.canInsert(t)&&te(t.ellipse)?p():h();L(t,i),An.checked&&ln(je,n,i)}}function zn(e){const t=new c(e.clientX-s.x,e.clientY-s.y),n=new a(et(je,t));r.tree.canInsert(n)&&!tt&&te(n.ellipse)&&r.tree.insert(n),d(r.tree)}function Yn(){tt=!0,d(r.tree)}const Hn=document.getElementById("canvas"),fn=Hn.getContext("2d");if(fn===null)throw Error("2d rendering context not supported");const Un=fn,qn=document.getElementById("atomDisplay");let nt,St,v=Ve("A",new c(0,0));function Vn(e){new RegExp(/^[A-Za-z]$/).test(e.key)&&(v=Ve(e.key,new c(v.origin.x,v.origin.y)),v.origin.x!==0&&v.origin.y!==0&&St&&kt())}function Gn(e){nt=!1,St=!0,v=Ve(v.identifier,new c(e.clientX-s.x,e.clientY-s.y)),kt()}function Wn(e){v=Ve(v.identifier,new c(e.clientX-s.x,e.clientY-s.y)),kt()}function jn(e){v=Ve(v.identifier,new c(e.clientX-s.x,e.clientY-s.y)),r.tree.canInsert(v)&&!nt&&r.tree.insert(v),d(r.tree),St=!1}function Jn(){nt=!0,d(r.tree)}function Ve(e,t){qn.innerHTML=e;const n=Un.measureText(e);return new f(e,new c(t.x,t.y),n.width,n.fontBoundingBoxDescent+n.actualBoundingBoxAscent)}function kt(){d(r.tree),nt||(r.tree.canInsert(v)?E(v,p(),!0):E(v,h(),!0))}let ne,m=null,he;function Kn(e){if(ne=new c(e.x-s.x,e.y-s.y),m=r.tree.getLowestNode(ne),m!==r.tree.sheet&&m!==null){const t=r.tree.getLowestParent(ne);if(t!==null&&t.remove(ne),m instanceof a&&m.children.length!==0){for(let n=0;n<m.children.length;n++)r.tree.insert(m.children[n]);m.children=[]}he=!0,d(r.tree),m instanceof f?E(m,p(),!0):L(m,p())}else he=!1}function Zn(e){if(he){const t=new c(e.x-ne.x,e.y-ne.y);if(m instanceof a){const n=q(m,t);d(r.tree);const o=r.tree.canInsert(n)?p():h();L(n,o)}else if(m instanceof f){const n=P(m,t);d(r.tree);const o=r.tree.canInsert(n)?p():h();E(n,o,!0)}}}function Qn(e){if(he){const t=new c(e.x-ne.x,e.y-ne.y);if(m instanceof a){const n=q(m,t);r.tree.canInsert(n)?r.tree.insert(n):r.tree.insert(m)}else if(m instanceof f){const n=P(m,t);r.tree.canInsert(n)?r.tree.insert(n):r.tree.insert(m)}d(r.tree)}he=!1}function _n(){he&&m!==null&&r.tree.insert(m),he=!1,d(r.tree)}let oe,C=null,we;function eo(e){if(oe=new c(e.x-s.x,e.y-s.y),C=r.tree.getLowestNode(oe),C!==r.tree.sheet&&C!==null){const t=r.tree.getLowestParent(oe);t!==null&&t.remove(oe),we=!0,d(r.tree),He(C,p())}else we=!1}function to(e){if(we){const t=new c(e.x-oe.x,e.y-oe.y);if(d(r.tree),C instanceof a){const n=ue(r.tree,C,t)?p():h();A(C,n,t)}else if(C instanceof f){const n=P(C,t),o=r.tree.canInsert(n)?p():h();E(n,o,!0)}}}function no(e){if(we){const t=new c(e.x-oe.x,e.y-oe.y);if(C instanceof a)ue(r.tree,C,t)?Ue(C,t):r.tree.insert(C);else if(C instanceof f){const n=P(C,t);r.tree.canInsert(n)?r.tree.insert(n):r.tree.insert(C)}}d(r.tree),we=!1}function oo(){we&&C!==null&&r.tree.insert(C),we=!1,d(r.tree)}let re,U=null,Te;function ro(e){re=new c(e.x-s.x,e.y-s.y);const t=r.tree.getLowestNode(re),n=new c(e.x-re.x,e.y-re.y);t!==r.tree.sheet&&t!==null?(t instanceof a?(U=q(t,n),U.children=[]):t instanceof f&&(U=t),Te=!0):Te=!1}function io(e){if(Te){const t=new c(e.x-re.x,e.y-re.y);if(U instanceof a){const n=q(U,t);d(r.tree);const o=r.tree.canInsert(n)?p():h();L(n,o)}else if(U instanceof f){const n=P(U,t);d(r.tree);const o=r.tree.canInsert(n)?p():h();E(n,o,!0)}}}function lo(e){if(Te){const t=new c(e.x-re.x,e.y-re.y);if(U instanceof a&&U.ellipse!==null){const n=q(U,t);r.tree.canInsert(n)&&r.tree.insert(n)}else if(U instanceof f){const n=P(U,t);r.tree.canInsert(n)&&r.tree.insert(n)}d(r.tree)}Te=!1}function so(){Te=!1,d(r.tree)}let Pe,Y=null,be;function co(e){Pe=new c(e.x-s.x,e.y-s.y),Y=r.tree.getLowestNode(Pe),Y!==r.tree.sheet&&Y!==null?be=!0:be=!1}function ao(e){if(be){const t=new c(e.x-Pe.x,e.y-Pe.y);if(d(r.tree),Y instanceof a){const n=ue(r.tree,Y,t)?p():h();A(Y,n,t)}else if(Y instanceof f){const n=P(Y,t),o=r.tree.canInsert(n)?p():h();E(n,o,!0)}}}function uo(e){if(be){const t=new c(e.x-Pe.x,e.y-Pe.y);if(Y instanceof a)ue(r.tree,Y,t)&&Ue(Y,t);else if(Y instanceof f){const n=P(Y,t);r.tree.canInsert(n)&&r.tree.insert(n)}}d(r.tree),be=!1}function fo(){be=!1,d(r.tree)}let Ht,S=null,Se;function ho(e){Ht=new c(e.x-s.x,e.y-s.y),S=r.tree.getLowestNode(Ht),S!==null&&(Se=!0,S instanceof f?E(S,h(),!0):L(S,h()))}function wo(e){const t=new c(e.x-s.x,e.y-s.y),n=r.tree.getLowestNode(t);S!==null&&S!==n&&(Se=!0,d(r.tree),n===null?(S=null,Se=!1):(S=n,S instanceof f?E(S,h(),!0):L(S,h())))}function po(e){const t=new c(e.x-s.x,e.y-s.y);if(Se){const n=r.tree.getLowestParent(t);if(n!==null&&n.remove(t),S!==r.tree.sheet&&S instanceof a&&S.children.length!==0)for(let o=0;o<S.children.length;o++)r.tree.insert(S.children[o])}d(r.tree),S=null,Se=!1}function go(){S=null,Se=!1}let Ut,W=null,ke;function yo(e){Ut=new c(e.x-s.x,e.y-s.y),W=r.tree.getLowestNode(Ut),W!==null&&(ke=!0,qe(W,h()))}function xo(e){const t=new c(e.x-s.x,e.y-s.y),n=r.tree.getLowestNode(t);W!==null&&W!==r.tree.getLowestNode(t)&&(ke=!0,d(r.tree),n===null?(W=null,ke=!1):(W=n,qe(W,h())))}function mo(e){const t=new c(e.x-s.x,e.y-s.y);if(ke){const n=r.tree.getLowestParent(t);n!==null?n.remove(t):r.tree.clear(),d(r.tree)}W=null,ke=!1}function Mo(){W=null,ke=!1,d(r.tree)}let Ce,b=null,Ee,Oe;const To=document.getElementById("selectionString");function Po(e){Oe=new F(r.tree.sheet),r.selectForProof.sheet=new F().sheet,Ce=new c(e.x-s.x,e.y-s.y),b=r.tree.getLowestNode(Ce),dn()}function bo(e){Ee&&(d(r.tree),Ce=new c(e.x-s.x,e.y-s.y),b=r.tree.getLowestNode(Ce),dn())}function So(){if(Ee&&b!==null){if(b instanceof a&&b.ellipse===null)for(let e=0;e<b.children.length;e++)r.selectForProof.insert(b.children[e]);else r.selectForProof.insert(b);d(r.tree)}b=null,Ee=!1}function ko(){b=null,Ee=!1,d(r.tree)}function dn(){const e=new F;let t=!1;if(b!==null){if(Ee=!0,b instanceof f||!b.isEqualTo(Oe.sheet)){e.insert(b);const n=Oe.getLowestParent(Ce);n!==null&&(n.remove(Ce),t=!0),d(Oe)}else e.sheet=b,Qe();b instanceof f?E(b,p(),!0):He(b,p()),t&&Oe.insert(b)}else Ee=!1;To.innerHTML=e.toString()}function G(){const e=new F;return r.currentProofStep&&(e.sheet=r.currentProofStep.tree.sheet.copy()),e}function Ie(e,t){return e.canInsert(t)&&hn(new F(e.sheet),t)}function hn(e,t){return r.currentProofStep?(e.insert(t.copy()),e.isEqualTo(new F(r.currentProofStep.tree.sheet))):!1}const Co=document.getElementById("showRect");let Je,ot,fe;function Eo(e){Je=new c(e.clientX-s.x,e.clientY-s.y),fe=G(),ot=!1}function Io(e){const t=new c(e.clientX-s.x,e.clientY-s.y),n=new a(et(Je,t)),o=new a(wn(n.ellipse));if(w(),!ot&&n.ellipse!==null&&o.ellipse!==null){const u=fe.canInsert(n)&&te(n.ellipse)&&fe.canInsert(o)&&te(o.ellipse)?p():h();L(n,u),L(o,u),Co.checked&&ln(Je,t,u)}}function Do(e){const t=new c(e.clientX-s.x,e.clientY-s.y);fe=new F(r.getLastProofStep().tree.sheet);const n=new a(et(Je,t)),o=new a(wn(n.ellipse)),i=new X(fe,"DC Insert");!ot&&n.ellipse!==null&&o.ellipse!==null&&fe.canInsert(n)&&te(n.ellipse)&&fe.canInsert(o)&&te(o.ellipse)&&(i.tree.insert(n),i.tree.insert(o),r.pushToProof(i)),w()}function Lo(){ot=!0,w()}function wn(e){return new Q(e.center,Math.floor(e.radiusX*.8),Math.floor(e.radiusY*.8))}let ae=null,Ke,Ae;function $o(e){const t=new c(e.x-s.x,e.y-s.y);Ae=G(),ae=Ae.getLowestNode(t),pn()}function vo(e){const t=new c(e.x-s.x,e.y-s.y);ae=Ae.getLowestNode(t),w(),pn()}function Bo(e){const t=new X(Ae,"DC Delete"),n=new c(e.x-s.x,e.y-s.y);if(Ke&&ae instanceof a){const o=t.tree.getLowestParent(n),i=ae.children[0];if(o!==null&&i instanceof a){o.remove(n);for(let u=0;u<i.children.length;u++)t.tree.insert(i.children[u]);r.pushToProof(t)}}w()}function No(){Ke=!1,w()}function Oo(e){return e.children.length===1&&e.children[0]instanceof a&&ae!==Ae.sheet}function Ro(e){L(e,h()),e.children[0]instanceof a&&L(e.children[0],h())}function pn(){ae instanceof a&&Oo(ae)?(Ke=!0,Ro(ae)):Ke=!1}let y,k,R,I,De;function Ao(e){R=G();const t=r.selectForProof.sheet.children,n=new c(e.x-s.x,e.y-s.y);if(r.proof.length>0&&t.length===1){De=!0,y=t[0];const o=Ct(e,y),i=R.getLowestNode(n),u=R.getLowestParent(n);if(k=i instanceof f?u:i,o){const g=Re(y,o);if(k!==null&&!k.containsNode(g))I=!1,A(y,h(),o);else if(k!==null&&k instanceof a&&k.ellipse!==null&&R.getLevel(k)%2===0){if(g instanceof a){I=!0;for(let x=0;x<k.children.length;x++)if(g.containsNode(k.children[x])){I=!1;break}}else I=!0;if(I){let x="";if(y instanceof a)x=ue(R,y,o)?p():h();else if(y instanceof f){const $=Re(y,o);x=R.canInsert($)?p():h()}I=x===p(),A(y,x,o)}else A(y,h(),o)}else I=!1,A(y,h(),o)}}else I=!1,De=!1,A(y,h(),n)}function Fo(e){if(De){const t=new c(e.x-s.x,e.y-s.y);w();const n=Ct(e,y),o=R.getLowestNode(t),i=R.getLowestParent(t);if(k=o instanceof f?i:o,n){const u=Re(y,n);if(k!==null&&!k.containsNode(u))I=!1,A(y,h(),n);else if(k!==null&&k instanceof a&&k.ellipse!==null&&R.getLevel(k)%2===0){if(u instanceof a){I=!0;for(let g=0;g<k.children.length;g++)if(u.containsNode(k.children[g])){I=!1;break}}else I=!0;if(I){let g="";if(y instanceof a)g=ue(R,y,n)?p():h();else if(y instanceof f){const x=Re(y,n);g=R.canInsert(x)?p():h()}I=g===p(),A(y,g,n)}else A(y,h(),n)}else I=!1,A(y,h(),n)}}else I=!1}function Xo(e){if(De&&I){const t=Ct(e,y);if(t){if(y instanceof a)Ue(y,t,R);else if(y instanceof f){const n=Re(y,t);R.insert(n)}r.pushToProof(new X(R,"Insertion"))}}w(),De=!1}function zo(){De=!1,w()}function Ct(e,t){if(t instanceof a&&t.ellipse!==null)return new c(e.x-t.ellipse.center.x,e.y-t.ellipse.center.y);if(t instanceof f)return new c(e.x-t.origin.x,e.y-t.origin.y)}let ie=null,Fe,Le;function Yo(e){const t=new c(e.x-s.x,e.y-s.y);Le=G(),ie=Le.getLowestNode(t),gn()}function Ho(e){const t=new c(e.x-s.x,e.y-s.y);ie=Le.getLowestNode(t),w(),gn()}function Uo(e){if(Fe){const t=new X(Le,"Erasure"),n=new c(e.x-s.x,e.y-s.y),o=t.tree.getLowestParent(n);o!==null&&o.remove(n),r.pushToProof(t),w()}ie=null,Fe=!1}function qo(){ie=null,Fe=!1,w()}function gn(){ie!==Le.sheet&&ie!==null&&Le.getLevel(ie)%2===0?(Fe=!0,qe(ie,h())):Fe=!1}let _,O=null,$e,Et=new c(1,1);function Vo(e){if(_=new c(e.x-s.x,e.y-s.y),O=r.tree.getLowestNode(_),O instanceof a&&O.ellipse!==null){$e=!0;const t=r.tree.getLowestParent(_);t!==null&&t.remove(_);for(let n=0;n<O.children.length;n++)r.tree.insert(O.children[n]);Et=sn(O,_),O.children=[]}}function Go(e){if($e){const t=new c((e.x-s.x-_.x)/2,(e.y-s.y-_.y)/2);if(O instanceof a){const n=_e(O,t,Et);if(n.ellipse!==null){d(r.tree);const i=r.tree.canInsert(n)&&te(n.ellipse)?p():h();L(n,i)}}}}function Wo(e){if($e){const t=new c((e.x-s.x-_.x)/2,(e.y-s.y-_.y)/2);if(O instanceof a){const n=_e(O,t,Et);n.ellipse!==null&&(r.tree.canInsert(n)&&te(n.ellipse)?r.tree.insert(n):r.tree.insert(O))}d(r.tree),$e=!1}}function jo(){$e&&O!==null&&r.tree.insert(O),$e=!1,d(r.tree)}let le,T=null,pe,H;function Jo(e){if(H=G(),le=new c(e.x-s.x,e.y-s.y),T=H.getLowestNode(le),T!==H.sheet&&T!==null){const t=H.getLowestParent(le);if(t!==null&&t.remove(le),T instanceof a&&T.children.length!==0){for(let n=0;n<T.children.length;n++)H.insert(T.children[n]);T.children=[]}pe=!0,d(H),T instanceof f?E(T,p(),!0):L(T,p())}else pe=!1}function Ko(e){if(pe){const t=new c(e.x-le.x,e.y-le.y);if(d(H),T instanceof a){const n=q(T,t),o=Ie(H,n)?p():h();L(n,o)}else if(T instanceof f){const n=P(T,t),o=Ie(H,n)?p():h();E(n,o,!0)}}}function Zo(e){if(pe){const t=new X(H,"Single Move"),n=new c(e.x-le.x,e.y-le.y);let o=null;T instanceof a?o=q(T,n):T instanceof f&&(o=P(T,n)),o!==null&&Ie(H,o)&&(t.tree.insert(o),r.pushToProof(t))}w(),pe=!1}function Qo(){pe&&T!==null&&H.insert(T),pe=!1,w()}let se,N=null,dt=null,ge,V;function _o(e){V=G(),se=new c(e.x-s.x,e.y-s.y),N=V.getLowestNode(se),N!==V.sheet&&N!==null?(dt=V.getLowestParent(se),dt!==null&&dt.remove(se),ge=!0,d(V),He(N,p())):ge=!1}function er(e){if(ge){const t=new c(e.x-se.x,e.y-se.y);if(d(V),N instanceof a){const n=bt(N,t),o=Ie(V,n)?p():h();A(N,o,t)}else if(N instanceof f){const n=P(N,t),o=Ie(V,n)?p():h();E(n,o,!0)}}}function tr(e){if(ge){const t=new X(V,"Multi Move"),n=new c(e.x-se.x,e.y-se.y);let o=null;N instanceof a?o=bt(N,n):N instanceof f&&(o=P(N,n)),o!==null&&Ie(V,o)&&(t.tree.insert(o),r.pushToProof(t))}w(),ge=!1}function nr(){ge&&N!==null&&V.insert(N),ge=!1,w()}let mt,Ze,Xe;function or(){Ze=G(),mt=r.selectForProof.sheet,mt.children.length>0&&r.proof.length===1&&Ze.sheet.isEmptySheet()&&(Xe=!0)}function rr(){Xe=!1,w()}function ir(){Xe&&(Ze.sheet=mt,r.pushToProof(new X(Ze,"Pasted"))),Xe=!1,w()}function lr(){Xe=!1,w()}let de,B=null,Mt=null,ze,j;function sr(e){j=G(),de=new c(e.x-s.x,e.y-s.y),B=j.getLowestNode(de),Mt=j.getLowestParent(de),ze=B!==j.sheet&&B!==null}function cr(e){if(ze){const t=new c(e.x-de.x,e.y-de.y);w();const n=new c(e.x-s.x,e.y-s.y),o=yn(t,n)?p():h();if(B instanceof a)A(B,o,t);else if(B instanceof f){const i=P(B,t);E(i,o,!0)}}}function ar(e){if(ze){const t=new c(e.x-de.x,e.y-de.y);if(yn(t,new c(e.x-s.x,e.y-s.y))){if(B instanceof a)Ue(B,t,j);else if(B instanceof f){const n=P(B,t);j.insert(n)}r.pushToProof(new X(j,"Iteration"))}}w(),ze=!1}function ur(){ze=!1,w()}function yn(e,t){return Mt!==null&&Mt.containsPoint(t)&&(B instanceof a&&ue(j,B,e)&&xn(j.sheet,q(B,e).ellipse)||B instanceof f&&j.canInsert(P(B,e)))}function xn(e,t){for(let n=0;n<e.children.length;n++)if(e.children[n]instanceof a){if(e.children[n].ellipse instanceof Q&&(t.contains(e.children[n].ellipse)||!xn(e.children[n],t)))return!1}else if(e.children[n]instanceof f&&t.contains(e.children[n].calcRect()))return!1;return!0}let ee,z=null,ve,It=new c(1,1),J;function fr(e){if(J=G(),ee=new c(e.x-s.x,e.y-s.y),z=J.getLowestNode(ee),z instanceof a&&z.ellipse!==null){ve=!0;const t=J.getLowestParent(ee);t!==null&&t.remove(ee);for(let n=0;n<z.children.length;n++)J.insert(z.children[n]);It=sn(z,ee),z.children=[]}}function dr(e){if(ve){const t=new c((e.x-s.x-ee.x)/2,(e.y-s.y-ee.y)/2);if(z instanceof a){const n=_e(z,t,It);if(n.ellipse!==null){d(J);const o=mn(n)?p():h();L(n,o)}}}}function hr(e){if(ve){const t=new c((e.x-s.x-ee.x)/2,(e.y-s.y-ee.y)/2);if(z instanceof a){const n=_e(z,t,It);n.ellipse!==null&&mn(n)&&(J.insert(n),r.pushToProof(new X(J,"Resize")))}w(),ve=!1}}function wr(){ve&&z!==null&&J.insert(z),ve=!1,w()}function mn(e){return J.canInsert(e)&&te(e.ellipse)&&hn(new F(J.sheet),e)}let D=null,Ye,K;function pr(e){const t=new c(e.x-s.x,e.y-s.y);K=G(),D=K.getLowestNode(t),Mn()}function gr(e){const t=new c(e.x-s.x,e.y-s.y);D=K.getLowestNode(t),w(),Mn()}function yr(e){if(Ye){const t=new c(e.x-s.x,e.y-s.y);if(D!==null&&Dt(K.sheet,K.getLevel(D))){const n=K.getLowestParent(t);n instanceof a&&n.remove(t),r.pushToProof(new X(K,"Deiteration"))}}Ye=!1,w()}function Mn(){D!==null&&!(D instanceof a&&D.ellipse===null)&&Dt(K.sheet,K.getLevel(D))?(qe(D,h()),Ye=!0):Ye=!1}function xr(){Ye=!1,D=null,w()}function Dt(e,t){let n=null;for(let o=0;o<e.children.length;o++){if(e.children[o]instanceof a&&D instanceof a&&D.isEqualTo(e.children[o])&&D.ellipse!==e.children[o].ellipse)return!0;if(e.children[o]instanceof f&&D instanceof f&&e.children[o].identifier===D.identifier&&e.children[o].toString()!==D.toString())return!0;e.children[o]instanceof a&&e.children[o].containsNode(D)&&K.getLevel(e.children[o])<t&&(n=e.children[o])}return n!==null?Dt(n,t):!1}let qt,Lt;function mr(){qt=G(),Lt=!0,Qe(),He(qt.sheet,h())}function Mr(){Lt&&(yt(-1),r.clearProof(),w())}function Tr(){Lt=!1,w()}const Z=document.getElementById("canvas");Z.width=window.innerWidth;Z.height=window.innerHeight;const Tn=Z.getContext("2d");if(Tn===null)throw Error("2d rendering context not supported");const Pr=Tn;Pr.font="35pt arial";const ht=document.getElementById("cutTools"),Vt=document.getElementById("atomTools"),Gt=document.getElementById("graphString"),Wt=document.getElementById("proofString"),jt=document.getElementById("toProofTools");window.addEventListener("keydown",Cr);Z.addEventListener("mousedown",Er);Z.addEventListener("mousemove",Ir);Z.addEventListener("mouseup",Dr);Z.addEventListener("mouseout",Lr);Z.addEventListener("mouseenter",$r);let $t=!1,vt=!0;window.tree=r.tree;window.treeString=rt(window.tree);window.atomTool=l.atomTool;window.cutTool=l.cutTool;window.dragTool=l.dragTool;window.aegStringify=rt;window.saveMode=Pn;window.loadMode=kr;window.moveSingleTool=l.moveSingleTool;window.moveMultiTool=l.moveMultiTool;window.copySingleTool=l.copySingleTool;window.copyMultiTool=l.copyMultiTool;window.deleteSingleTool=l.deleteSingleTool;window.deleteMultiTool=l.deleteMultiTool;window.copyFromDrawTool=l.copyFromDrawTool;window.pasteInProofTool=l.pasteInProofTool;window.doubleCutInsertionTool=l.doubleCutInsertionTool;window.resizeTool=l.resizeTool;window.doubleCutDeletionTool=l.doubleCutDeletionTool;window.insertionTool=l.insertionTool;window.erasureTool=l.erasureTool;window.proofMoveSingleTool=l.proofMoveSingleTool;window.proofMoveMultiTool=l.proofMoveMultiTool;window.proofResizeTool=l.proofResizeTool;window.iterationTool=l.iterationTool;window.deiterationTool=l.deiterationTool;window.clearProofTool=l.clearProofTool;window.setTool=Sr;window.setHighlight=br;window.toggleHandler=On;function br(e,t){const n=document.getElementById(t);switch(e){case"mousedown":n==null||n.classList.remove("no-highlight");break;case"mouseleave":n==null||n.classList.add("no-highlight");break}}const Jt=document.querySelectorAll(".toolButton");Jt.forEach(e=>{e.addEventListener("click",()=>{e.classList.add("toolButtonPressed"),Jt.forEach(t=>{t!==e&&t.classList.remove("toolButtonPressed")})})});function Sr(e){switch(r.toolState=e,ht.style.display="none",Vt.style.display="none",jt.style.display="none",r.toolState){case l.atomTool:Vt.style.display="block";break;case l.cutTool:ht.style.display="block";break;case l.copyFromDrawTool:jt.style.display="block";break;case l.doubleCutInsertionTool:ht.style.display="block";break}}function rt(e){return JSON.stringify(e,null,"	")}async function Pn(){let e,t;r.modeState==="Draw"?(e="AEG Tree",t=r.tree):(r.proof.length===0?e="[] → []":e=r.proof[0].tree.toString()+"→"+r.getLastProofStep().tree.toString(),t=r.proof);try{if("showSaveFilePicker"in window){const n=await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:e,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]});Nn(n,t)}else{const n=document.createElement("a");n.href=rt(t),n.download=e+".json",n.click()}}catch{}}async function kr(){try{const[e]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),t=await e.getFile(),n=new FileReader;n.addEventListener("load",()=>{var i;const o=n.result;if(typeof o=="string"){const u=xt(r.modeState,o);if(r.modeState==="Draw")r.tree=u,d(r.tree);else if(r.modeState==="Proof"){r.clearProof(),r.proof=u,(i=document.getElementById("Row: 1"))==null||i.remove();for(let g=0;g<r.proof.length;g++)cn(r.proof[g],g+1);w()}}else console.log("Loading failed because reading the file was unsuccessful")}),n.readAsText(t)}catch{}}function Cr(e){if(e.ctrlKey&&e.key==="s")e.preventDefault(),Pn();else switch(r.toolState){case l.atomTool:Vn(e);break}}function Er(e){switch(r.toolState){case l.cutTool:Fn(e);break;case l.atomTool:Gn(e);break;case l.dragTool:Sn(e);break;case l.moveSingleTool:Kn(e);break;case l.moveMultiTool:eo(e);break;case l.copySingleTool:ro(e);break;case l.copyMultiTool:co(e);break;case l.deleteSingleTool:ho(e);break;case l.deleteMultiTool:yo(e);break;case l.resizeTool:Vo(e);break;case l.copyFromDrawTool:Po(e);break;case l.pasteInProofTool:or();break;case l.doubleCutInsertionTool:Eo(e);break;case l.doubleCutDeletionTool:$o(e);break;case l.insertionTool:Ao(e);break;case l.erasureTool:Yo(e);break;case l.proofMoveSingleTool:Jo(e);break;case l.proofMoveMultiTool:_o(e);break;case l.proofResizeTool:fr(e);break;case l.iterationTool:sr(e);break;case l.deiterationTool:pr(e);break;case l.clearProofTool:mr();break}$t=!0}function Ir(e){if($t&&vt)switch(r.toolState){case l.cutTool:Xn(e);break;case l.atomTool:Wn(e);break;case l.dragTool:kn(e);break;case l.moveSingleTool:Zn(e);break;case l.moveMultiTool:to(e);break;case l.copySingleTool:io(e);break;case l.copyMultiTool:ao(e);break;case l.deleteSingleTool:wo(e);break;case l.deleteMultiTool:xo(e);break;case l.resizeTool:Go(e);break;case l.copyFromDrawTool:bo(e);break;case l.pasteInProofTool:rr();break;case l.doubleCutInsertionTool:Io(e);break;case l.doubleCutDeletionTool:vo(e);break;case l.insertionTool:Fo(e);break;case l.erasureTool:Ho(e);break;case l.proofMoveSingleTool:Ko(e);break;case l.proofMoveMultiTool:er(e);break;case l.proofResizeTool:dr(e);break;case l.iterationTool:cr(e);break;case l.deiterationTool:gr(e);break}}function Dr(e){switch(r.toolState){case l.cutTool:zn(e);break;case l.atomTool:jn(e);break;case l.moveSingleTool:Qn(e);break;case l.moveMultiTool:no(e);break;case l.copySingleTool:lo(e);break;case l.copyMultiTool:uo(e);break;case l.deleteSingleTool:po(e);break;case l.deleteMultiTool:mo(e);break;case l.resizeTool:Wo(e);break;case l.copyFromDrawTool:So();break;case l.pasteInProofTool:ir();break;case l.doubleCutInsertionTool:Do(e);break;case l.doubleCutDeletionTool:Bo(e);break;case l.insertionTool:Xo(e);break;case l.erasureTool:Uo(e);break;case l.proofMoveSingleTool:Zo(e);break;case l.proofMoveMultiTool:tr(e);break;case l.proofResizeTool:hr(e);break;case l.iterationTool:ar(e);break;case l.deiterationTool:yr(e);break;case l.clearProofTool:Mr();break}$t=!1}function Lr(){switch(r.toolState){case l.cutTool:Yn();break;case l.atomTool:Jn();break;case l.dragTool:Cn();break;case l.moveSingleTool:_n();break;case l.moveMultiTool:oo();break;case l.copySingleTool:so();break;case l.copyMultiTool:fo();break;case l.deleteSingleTool:go();break;case l.deleteMultiTool:Mo();break;case l.resizeTool:jo();break;case l.copyFromDrawTool:ko();break;case l.pasteInProofTool:lr();break;case l.doubleCutInsertionTool:Lo();break;case l.doubleCutDeletionTool:No();break;case l.insertionTool:zo();break;case l.erasureTool:qo();break;case l.proofMoveSingleTool:Qo();break;case l.proofMoveMultiTool:nr();break;case l.proofResizeTool:wr();break;case l.iterationTool:ur();break;case l.deiterationTool:xr();break;case l.clearProofTool:Tr();break}vt=!1}function $r(){vt=!0}function vr(){Z.width=window.innerWidth,Z.height=window.innerHeight}window.onresize=vr;
