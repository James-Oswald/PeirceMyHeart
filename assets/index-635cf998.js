/* empty css               */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const I of a.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&i(I)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();class l{constructor(t,n){if(this.x=t,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(t,n){if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=t,this.y=n}distance(t){const n=this.x-t.x,i=this.y-t.y;return Math.sqrt(n*n+i*i)}toString(){return"("+this.x+", "+this.y+")"}}function H(e,t){return Ae(e,t)||F(t,e)}function Ae(e,t){if(e instanceof O)return t instanceof O?Ce(e,t):be(t,e);if(t instanceof O)return be(e,t);if(Ce(e.boundingBox,t.boundingBox)||F(t.boundingBox,e.boundingBox)){const n=Xe(e);let i;for(let s=0;s<n.length;s++)if(i=Z(t,n[s]),i<=0)return!0;return!1}return!1}function be(e,t){const n=t.getCorners(),i=J(e,n[0].x,1),s=J(e,n[1].x,1),a=J(e,n[0].x,-1),I=J(e,n[1].x,-1);if(n[0].y<i&&i<n[2].y||n[0].y<a&&a<n[2].y||n[0].y<s&&s<n[2].y||n[0].y<I&&I<n[2].y)return!0;const x=-1/Math.pow(e.radiusX,2),m=2*e.center.x/Math.pow(e.radiusX,2),z=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[0].y-e.center.y)/e.radiusY,2),Ee=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[2].y-e.center.y)/e.radiusY,2),se=(-m+Math.sqrt(Math.pow(m,2)-4*x*z))/(2*x),oe=(-m-Math.sqrt(Math.pow(m,2)-4*x*z))/(2*x),le=(-m+Math.sqrt(Math.pow(m,2)-4*x*Ee))/(2*x),ce=(-m-Math.sqrt(Math.pow(m,2)-4*x*Ee))/(2*x);return!isNaN(se)&&n[0].x<se&&se<n[1].x||!isNaN(oe)&&n[0].x<oe&&oe<n[1].x||!isNaN(le)&&n[0].x<le&&le<n[1].x||!isNaN(ce)&&n[0].x<ce&&ce<n[1].x}function F(e,t){if(e instanceof O)if(t instanceof O){const n=t.getCorners();for(let i=0;i<4;i++)if(!fe(e,n[i]))return!1;return!0}else{const n=Ze(t);for(let i=0;i<4;i++)if(!fe(e,n[i]))return!1;return!0}else if(t instanceof O){const n=t.getCorners();let i;for(let s=0;s<4;s++)if(i=Z(e,n[s]),!(i<0))return!1;return!0}else{const n=Xe(t);let i;for(let s=0;s<n.length;s++)if(i=Z(e,n[s]),!(i<0))return!1;return!0}}function Ce(e,t){const n=e.getCorners(),i=t.getCorners();return(n[0].y<=i[0].y&&n[2].y>=i[0].y||n[0].y<=i[2].y&&n[2].y>=i[2].y||i[0].y<=n[0].y&&i[2].y>=n[0].y||i[0].y<=n[2].y&&i[2].y>=n[2].y)&&(n[0].x<=i[0].x&&n[1].x>=i[0].x||n[0].x<=i[1].x&&n[1].x>=i[1].x||i[0].x<=n[0].x&&i[1].x>=n[0].x||i[0].x<=n[1].x&&i[1].x>=n[1].x)}function fe(e,t){const n=e.getCorners();return n[0].x<t.x&&n[1].x>t.x&&n[0].y<t.y&&n[2].y>t.y}function Z(e,t){return Math.pow(t.x-e.center.x,2)/Math.pow(e.radiusX,2)+Math.pow(t.y-e.center.y,2)/Math.pow(e.radiusY,2)-1}function Ze(e){return[new l(e.center.x,e.center.y-e.radiusY),new l(e.center.x+e.radiusX,e.center.y),new l(e.center.x,e.center.y+e.radiusY),new l(e.center.x-e.radiusX,e.center.y)]}function Xe(e){const t=[];let n,i,s=1;for(let a=0;a<360;a++)n=e.center.x+e.radiusX*Math.cos(a*(Math.PI/180)),a>180&&(s=-1),i=J(e,n,s),t[a]=new l(n,i);return t}function J(e,t,n){return e.radiusX===0||e.radiusY===0?e.center.y:n*e.radiusY*Math.sqrt(1-Math.pow((t-e.center.x)/e.radiusX,2))+e.center.y}class O{constructor(t,n,i){if(!Number.isFinite(n)||!Number.isFinite(i))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(i!==void 0&&i<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=t,this.width=n,this.height=i}getCorners(){const t=[this.startVertex];return t.push(new l(this.startVertex.x+this.width,this.startVertex.y)),t.push(new l(this.startVertex.x+this.width,this.startVertex.y+this.height)),t.push(new l(this.startVertex.x,this.startVertex.y+this.height)),t}containsPoint(t){return fe(this,t)}overlaps(t){return H(this,t)}contains(t){return F(this,t)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}class u{constructor(t,n,i,s){if(t.length!==1)throw new Error("String of length "+t.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(t))throw new Error(t+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=t,this.internalOrigin=n,this.internalWidth=i,this.internalHeight=s}get width(){return this.internalWidth}set width(t){this.internalWidth=t}get height(){return this.internalHeight}set height(t){this.internalHeight=t}get identifier(){return this.internalIdentifier}set identifier(t){this.internalIdentifier=t}get origin(){return this.internalOrigin}set origin(t){this.internalOrigin=t}containsPoint(t){return this.calcRect().containsPoint(t)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.calcRect().toString()}calcRect(){return new O(new l(this.internalOrigin.x,this.internalOrigin.y-this.internalHeight),this.internalWidth,this.internalHeight)}}class f{constructor(t,n){this.internalEllipse=t,this.internalChildren=n??[]}get ellipse(){return this.internalEllipse}set ellipse(t){this.internalEllipse=t}get children(){return this.internalChildren}set children(t){this.internalChildren=t}set child(t){this.internalChildren.push(t)}getCurrentCut(t){for(let n=0;n<this.internalChildren.length;n++){const i=this.internalChildren[n];if(i instanceof f&&i.containsNode(t))return i.getCurrentCut(t)}return this}containsPoint(t){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(t)}containsNode(t){return this.internalEllipse===null?!0:t instanceof u?F(this.internalEllipse,t.calcRect()):F(this.internalEllipse,t.internalEllipse)}getLowestNode(t){if(!this.containsPoint(t))return null;for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t))return this.internalChildren[n]instanceof u||this.internalChildren[n]instanceof f&&this.internalChildren[n].children.length===0?this.internalChildren[n]:this.internalChildren[n].getLowestNode(t);return this}getLowestParent(t){if(!this.containsPoint(t))throw new Error("This parent "+this.toString+" does not contain the point.");for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t)){if(this.internalChildren[n]instanceof u||this.internalChildren[n]instanceof f&&this.internalChildren[n].children.length===0)return this;{const i=this.internalChildren[n];for(let s=0;s<i.children.length;s++)if(i.children[s].containsPoint(t))return i.getLowestParent(t);return this}}return null}remove(t){if(!this.containsPoint(t))return!1;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(t)){if(this.children[n]instanceof u||this.children[n]instanceof f&&this.children[n].children.length===0)return this.children.splice(n,1),!0;for(let i=0;i<this.children[n].children.length;i++)if(this.children[n].children[i].containsPoint(t))if(this.children[n].children[i]instanceof u)this.children[n].children.splice(i,1);else return this.children[n].children[i].remove(t);return this.children.splice(n,1),!0}return!1}toString(){let t;return this.internalEllipse===null?t="Sheet of Assertion of the AEG Tree":t="A cut node with boundary box of "+this.internalEllipse.toString(),this.internalChildren.length>0&&(t+=", With nested nodes: "+this.internalChildren.toString()),t}toFormulaString(){let t="";for(const n of this.internalChildren)n instanceof u?t+=n.identifier:n instanceof f&&(t+=n.toFormulaString()),t+=" ";return t=t.slice(0,-1),this.internalEllipse===null?t="["+t+"]":t="("+t+")",t}}class ee{constructor(t){this.internalSheet=t??new f(null)}get sheet(){return this.internalSheet}set sheet(t){this.internalSheet=t}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(t){for(let n=0;n<t.children.length;n++){if(!t.containsNode(t.children[n]))return!1;for(let i=n+1;i<t.children.length;i++)if(this.overlaps(t.children[n],t.children[i]))return!1}for(let n=0;n<t.children.length;n++)if(t.children[n]instanceof f&&!this.verifyAEG(t.children[n]))return!1;return!0}canInsert(t){const n=this.internalSheet.getCurrentCut(t);for(let i=0;i<n.children.length;i++)if(this.intersects(t,n.children[i]))return!1;return!0}insert(t){if(!this.canInsert(t))throw new Error("Insertion failed. "+t+" had a collision.");const n=this.internalSheet.getCurrentCut(t),i=[...n.children];if(n.child=t,t instanceof f)for(let s=i.length-1;s>=0;s--)t.containsNode(i[s])&&(t.child=i[s],n.children.splice(s,1));return!0}getLowestNode(t){return this.internalSheet.getLowestNode(t)}getLowestParent(t){return this.internalSheet.getLowestParent(t)}remove(t){return this.internalSheet.remove(t)}intersects(t,n){const i=t instanceof u?t.calcRect():t.ellipse,s=n instanceof u?n.calcRect():n.ellipse;return Ae(i,s)}overlaps(t,n){let i,s;return t instanceof u?n instanceof u?H(t.calcRect(),n.calcRect()):(i=n.ellipse,H(t.calcRect(),i)):n instanceof u?(i=t.ellipse,H(i,n.calcRect())):(i=t.ellipse,s=n.ellipse,H(i,s))}toString(){return this.internalSheet.toFormulaString()}}class q{constructor(t,n,i){if(this.center=t,this.radiusX=n,this.radiusY=i,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const s=new l(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new O(s,this.radiusX*2,this.radiusY*2)}containsPoint(t){return Z(this,t)<0}overlaps(t){return H(this,t)}contains(t){return F(this,t)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}const Qe=document.getElementById("theme-select");function R(e){return getComputedStyle(document.body).getPropertyValue(e)}let De=R("--good-placement"),$e=R("--bad-placement"),Ye=R("--canvas-items");function He(){setTimeout(()=>{De=R("--good-placement"),$e=R("--bad-placement"),Ye=R("--canvas-items"),c(r)})}Qe.addEventListener("input",()=>{He()});window.addEventListener("DOMContentLoaded",()=>{He()});function y(){return $e}function E(){return De}function Re(){return Ye}const de=document.getElementById("canvas"),Fe=de.getContext("2d");if(Fe===null)throw Error("2d rendering context not supported");const d=Fe;d.font="35pt arial";const _e=document.getElementById("graphString"),et=document.getElementById("atomBox"),Te=document.getElementById("atomBoxes");Te.addEventListener("input",tt);function L(e,t){d.strokeStyle=t;const n=e.ellipse,i=n.center;d.beginPath(),d.ellipse(i.x+o.x,i.y+o.y,n.radiusX,n.radiusY,0,0,2*Math.PI),d.stroke()}function b(e,t,n){d.textBaseline="bottom";const i=d.measureText(e.identifier);d.fillStyle=t,d.strokeStyle=t,d.beginPath(),d.fillText(e.identifier,e.origin.x+o.x,e.origin.y+o.y),(Te.checked||et.checked&&n)&&d.rect(e.origin.x+o.x,e.origin.y+o.y-i.actualBoundingBoxAscent,e.width,e.height),d.stroke()}function Ne(e,t,n){d.beginPath(),d.strokeStyle=n;const i=e.x-t.x+o.x,s=e.y-t.y+o.y;d.rect(e.x,e.y,-i,-s),d.stroke()}function tt(){c(r)}function c(e){_e.innerHTML=e.toString(),d.clearRect(0,0,de.width,de.height),Ve(e.sheet)}function Ve(e){for(let t=0;e.children.length>t;t++)e.children[t]instanceof u?nt(e.children[t]):Ve(e.children[t]);e.ellipse instanceof q&&(d.strokeStyle=Re(),d.beginPath(),d.ellipse(e.ellipse.center.x+o.x,e.ellipse.center.y+o.y,e.ellipse.radiusX,e.ellipse.radiusY,0,0,2*Math.PI),d.stroke())}function nt(e){b(e,Re(),!1)}let he,o=new l(0,0),ye;function it(e){he=new l(e.x-o.x,e.y-o.y),ye=!1}function rt(e){ye||(o=new l(e.x-he.x,e.y-he.y),c(r))}function st(){ye=!0,c(r)}const ot=document.getElementById("showRect"),lt=document.getElementById("mode");let Q,te;function ct(e){Q=new l(e.clientX-o.x,e.clientY-o.y),te=!1}function at(e){const t=new f(new q(new l(0,0),0,0)),n=new l(e.clientX-o.x,e.clientY-o.y);if(c(r),t.ellipse=ne(Q,n),!te){const s=r.canInsert(t)&&T(t.ellipse)?E():y();L(t,s),ot.checked&&Ne(Q,n,s)}}function ut(e){const t=new l(e.clientX-o.x,e.clientY-o.y),n=new f(ne(Q,t));r.canInsert(n)&&!te&&T(n.ellipse)&&r.insert(n),c(r)}function ft(){te=!0,c(r)}function ne(e,t){const n=new l((t.x-e.x)/2+e.x,(t.y-e.y)/2+e.y),i=e.x-t.x,s=e.y-t.y,a=Math.abs(i),I=Math.abs(s);let x,m;if(lt.value==="circumscribed"){const z=Math.floor(n.distance(t));m=Math.floor(z*(I/a)),x=Math.floor(z*(a/I))}else x=a/2,m=I/2;return new q(n,x,m)}function T(e){return e.radiusX>15&&e.radiusY>15}const dt=document.getElementById("canvas"),Ue=dt.getContext("2d");if(Ue===null)throw Error("2d rendering context not supported");const ht=Ue,Ge=document.getElementById("atomDisplay");let P,ie,D="A";Ge.innerHTML=D;function wt(e){new RegExp(/^[A-Za-z]$/).test(e.key)&&(D=e.key,Ge.innerHTML=D)}function yt(e){P=ht.measureText(D),ie=!1;const t=new u(D,new l(e.clientX-o.x,e.clientY-o.y),P.width,P.fontBoundingBoxDescent+P.actualBoundingBoxAscent);c(r);const n=r.canInsert(t)?E():y();b(t,n,!0)}function gt(e){const t=new u(D,new l(e.clientX-o.x,e.clientY-o.y),P.width,P.fontBoundingBoxDescent+P.actualBoundingBoxAscent);c(r),ie||(r.canInsert(t)?b(t,E(),!0):b(t,y(),!0))}function pt(e){const t=new u(D,new l(e.clientX-o.x,e.clientY-o.y),P.width,P.fontBoundingBoxDescent+P.actualBoundingBoxAscent);r.canInsert(t)&&!ie&&r.insert(t),c(r)}function xt(){ie=!0,c(r)}async function mt(e,t){const n=JSON.stringify(t,null,"	"),i=await e.createWritable();await i.write(n),await i.close()}function We(e){if(typeof e=="string"){const n=JSON.parse(e).internalSheet.internalChildren,i=new ee,s=[];return n.forEach(a=>{Object.prototype.hasOwnProperty.call(a,"internalEllipse")?s.push(je(a)):s.push(qe(a))}),i.sheet.children=s,i}return null}function je(e){const t=new q(new l(e.internalEllipse.center.x,e.internalEllipse.center.y),e.internalEllipse.radiusX,e.internalEllipse.radiusY),n=[];return e.internalChildren.forEach(i=>{"internalEllipse"in i?n.push(je(i)):n.push(qe(i))}),new f(t,n)}function qe(e){const t=e.internalIdentifier,n=new l(e.internalOrigin.x,e.internalOrigin.y);return new u(t,n,e.internalWidth,e.internalHeight)}function K(e,t){if(e.ellipse!==null){const n=X(e,t);if(!r.canInsert(n))return!1}for(let n=0;n<e.children.length;n++){if(e.children[n]instanceof f&&e.children[n].ellipse!==null&&!K(e.children[n],t))return!1;if(e.children[n]instanceof u){let i=e.children[n];if(i=k(i,t),!r.canInsert(i))return!1}}return!0}function ge(e,t,n){if(e instanceof f&&e.ellipse!==null){const i=X(e,n);if(L(i,t),e.children.length!==0)for(let s=0;s<e.children.length;s++)ge(e.children[s],t,n)}else if(e instanceof u){const i=k(e,n);b(i,t,!0)}}function pe(e,t){if(e instanceof f&&e.ellipse!==null){const n=X(e,t);if(r.insert(n),e.children.length!==0)for(let i=0;i<e.children.length;i++)pe(e.children[i],t)}else if(e instanceof u){const n=k(e,t);r.insert(n)}}function X(e,t){if(e.ellipse!==null)return new f(new q(new l(e.ellipse.center.x+t.x-o.x,e.ellipse.center.y+t.y-o.y),e.ellipse.radiusX,e.ellipse.radiusY));throw new Error("Cannot alter the position of a cut without an ellipse.")}function k(e,t){return new u(e.identifier,new l(e.origin.x+t.x-o.x,e.origin.y+t.y-o.y),e.width,e.height)}let S,h=null,$;function Mt(e){if(S=new l(e.x-o.x,e.y-o.y),h=r.getLowestNode(S),h!==r.sheet&&h!==null){const t=r.getLowestParent(S);if(t!==null&&t.remove(S),h instanceof f&&h.children.length!==0){for(let n=0;n<h.children.length;n++)r.insert(h.children[n]);h.children=[]}$=!0}else $=!1}function Et(e){if($){const t=new l(e.x-S.x,e.y-S.y);if(h instanceof f){const n=X(h,t);c(r);const i=r.canInsert(n)?E():y();L(n,i)}else if(h instanceof u){const n=k(h,t);c(r);const i=r.canInsert(n)?E():y();b(n,i,!0)}}}function bt(e){if($){const t=new l(e.x-S.x,e.y-S.y);if(h instanceof f){const n=X(h,t);r.canInsert(n)?r.insert(n):r.insert(h)}else if(h instanceof u){const n=k(h,t);r.canInsert(n)?r.insert(n):r.insert(h)}c(r)}$=!1}function Ct(){$&&h!==null&&r.insert(h),$=!1,c(r)}let v,g=null,Y;function kt(e){if(v=new l(e.x-o.x,e.y-o.y),g=r.getLowestNode(v),g!==r.sheet&&g!==null){const t=r.getLowestParent(v);t!==null&&t.remove(v),Y=!0}else Y=!1}function It(e){if(Y){const t=new l(e.x-v.x,e.y-v.y);if(c(r),g instanceof f){const n=K(g,t)?E():y();ge(g,n,t)}else if(g instanceof u){const n=k(g,t),i=r.canInsert(n)?E():y();b(n,i,!0)}}}function Pt(e){if(Y){const t=new l(e.x-v.x,e.y-v.y);if(g instanceof f)K(g,t)?pe(g,t):r.insert(g);else if(g instanceof u){const n=k(g,t);r.canInsert(n)?r.insert(n):r.insert(g)}}c(r),Y=!1}function Bt(){Y&&g!==null&&r.insert(g),Y=!1,c(r)}let N,M=null,V;function Lt(e){N=new l(e.x-o.x,e.y-o.y);const t=r.getLowestNode(N);t!==r.sheet&&t!==null?(t instanceof f?(M=X(t,new l(0,0)),M.children=[]):t instanceof u&&(M=t),V=!0):V=!1}function St(e){if(V){const t=new l(e.x-N.x,e.y-N.y);if(M instanceof f){const n=X(M,t);c(r);const i=r.canInsert(n)?E():y();L(n,i)}else if(M instanceof u){const n=k(M,t);c(r);const i=r.canInsert(n)?E():y();b(n,i,!0)}}}function vt(e){if(V){const t=new l(e.x-N.x,e.y-N.y);if(M instanceof f&&M.ellipse!==null){const n=X(M,t);r.canInsert(n)&&r.insert(n)}else if(M instanceof u){const n=k(M,t);r.canInsert(n)&&r.insert(n)}c(r)}V=!1}function Ot(){V=!1,c(r)}let U,p=null,G;function At(e){U=new l(e.x-o.x,e.y-o.y),p=r.getLowestNode(U),p!==r.sheet&&p!==null?G=!0:G=!1}function Xt(e){if(G){const t=new l(e.x-U.x,e.y-U.y);if(c(r),p instanceof f){const n=K(p,t)?E():y();ge(p,n,t)}else if(p instanceof u){const n=k(p,t),i=r.canInsert(n)?E():y();b(n,i,!0)}}}function Dt(e){if(G){const t=new l(e.x-U.x,e.y-U.y);if(p instanceof f)K(p,t)&&pe(p,t);else if(p instanceof u){const n=k(p,t);r.canInsert(n)&&r.insert(n)}}c(r),G=!1}function $t(){G=!1,c(r)}let ke,w=null,W;function Yt(e){ke=new l(e.x-o.x,e.y-o.y),w=r.getLowestNode(ke),w!==r.sheet&&w!==null&&(W=!0,w instanceof u?b(w,y(),!0):L(w,y()))}function Ht(e){const t=new l(e.x-o.x,e.y-o.y),n=r.getLowestNode(t);w!==null&&w!==n&&(W=!0,c(r),n===r.sheet||n===null?(w=null,W=!1):(w=n,w instanceof u?b(w,y(),!0):L(w,y())))}function Rt(e){const t=new l(e.x-o.x,e.y-o.y);if(W){const n=r.getLowestParent(t);if(n!==null&&n.remove(t),w instanceof f&&w.children.length!==0)for(let i=0;i<w.children.length;i++)r.insert(w.children[i])}c(r),w=null,W=!1}function Ft(){w=null,W=!1}let Ie,C=null,j;function Tt(e){Ie=new l(e.x-o.x,e.y-o.y),C=r.getLowestNode(Ie),C!==r.sheet&&C!==null&&(j=!0,xe(C,y()))}function Nt(e){const t=new l(e.x-o.x,e.y-o.y),n=r.getLowestNode(t);C!==null&&C!==r.getLowestNode(t)&&(j=!0,c(r),n===r.sheet||n===null?(C=null,j=!1):(C=n,xe(C,y())))}function Vt(e){const t=new l(e.x-o.x,e.y-o.y);if(j){const n=r.getLowestParent(t);n!==null&&n.remove(t),c(r)}C=null,j=!1}function Ut(){C=null,j=!1}function xe(e,t){if(e instanceof u)b(e,t,!0);else if(e instanceof f){L(e,t);for(let n=0;n<e.children.length;n++)xe(e.children[n],t)}}const Gt=document.getElementById("showRect");let _,re;function Wt(e){_=new l(e.clientX-o.x,e.clientY-o.y),re=!1}function jt(e){const t=new l(e.clientX-o.x,e.clientY-o.y),n=new f(ne(_,t)),i=new f(ze(n.ellipse));if(c(r),!re&&n.ellipse!==null&&i.ellipse!==null){const a=r.canInsert(n)&&T(n.ellipse)&&r.canInsert(i)&&T(i.ellipse)?E():y();L(n,a),L(i,a),Gt.checked&&Ne(_,t,a)}}function qt(e){const t=new l(e.clientX-o.x,e.clientY-o.y),n=new f(ne(_,t)),i=new f(ze(n.ellipse));!re&&n.ellipse!==null&&i.ellipse!==null&&r.canInsert(n)&&T(n.ellipse)&&r.canInsert(i)&&T(i.ellipse)&&(r.insert(n),r.insert(i)),c(r)}function zt(){re=!0,c(r)}function ze(e){return new q(e.center,Math.floor(e.radiusX*.8),Math.floor(e.radiusY*.8))}let ae=!0,Pe=null,Be=null;const Le=document.getElementById("DrawButtons"),Se=document.getElementById("ProofButtons");function Jt(){if(ae=!ae,ae){Le.style.display="block",Se.style.display="none";const e=We(Pe);if(e!==null)r.sheet=e.sheet;else throw Error("invalid cached AEG");we(Be)}else Le.style.display="none",Se.style.display="block",Pe=JSON.stringify(r),Be=A,r.sheet=new ee().sheet,we(null);c(r)}const B=document.getElementById("canvas");B.width=window.innerWidth;B.height=window.innerHeight;const Je=B.getContext("2d");if(Je===null)throw Error("2d rendering context not supported");const Kt=Je;Kt.font="35pt arial";const ue=document.getElementById("cutTools"),ve=document.getElementById("atomTools");window.addEventListener("keydown",_t);B.addEventListener("mousedown",en);B.addEventListener("mousemove",tn);B.addEventListener("mouseup",nn);B.addEventListener("mouseout",rn);B.addEventListener("mouseenter",sn);let A=null,me=!1,Me=!0,r=new ee;window.atomMode=0;window.cutMode=1;window.dragMode=2;window.saveMode=Ke;window.loadMode=Qt;window.moveSingleMode=3;window.moveMultiMode=4;window.copySingleMode=5;window.copyMultiMode=6;window.deleteSingleMode=7;window.deleteMultiMode=8;window.doubleCutInsertionTool=9;window.setMode=we;window.setHighlight=Zt;window.toggleHandler=Jt;function Zt(e,t){const n=document.getElementById(t);switch(e){case"mousedown":n==null||n.classList.remove("no-highlight");break;case"mouseleave":n==null||n.classList.add("no-highlight");break}}const Oe=document.querySelectorAll(".modeButton");Oe.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("modeButtonPressed"),Oe.forEach(t=>{t!==e&&t.classList.remove("modeButtonPressed")})})});function we(e){switch(A=e,ue.style.display="none",ve.style.display="none",A){case 0:ve.style.display="block";break;case 1:ue.style.display="block";break;case 9:ue.style.display="block";break}}async function Ke(){if("showSaveFilePicker"in window){const e=await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"AEG Tree",startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]});mt(e,r)}else{const e=document.createElement("a");e.href=JSON.stringify(r,null,"	"),e.download="AEGTree.json",e.click()}}async function Qt(){const[e]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),t=await e.getFile(),n=new FileReader;n.addEventListener("load",()=>{const i=n.result,s=We(i);s instanceof ee&&(r=s,c(r))}),n.readAsText(t)}function _t(e){if(e.ctrlKey&&e.key==="s")e.preventDefault(),Ke();else switch(A){case 0:wt(e);break}}function en(e){switch(A){case 1:ct(e);break;case 0:yt(e);break;case 2:it(e);break;case 3:Mt(e);break;case 4:kt(e);break;case 5:Lt(e);break;case 6:At(e);break;case 7:Yt(e);break;case 8:Tt(e);break;case 9:Wt(e);break}me=!0}function tn(e){if(me&&Me)switch(A){case 1:at(e);break;case 0:gt(e);break;case 2:rt(e);break;case 3:Et(e);break;case 4:It(e);break;case 5:St(e);break;case 6:Xt(e);break;case 7:Ht(e);break;case 8:Nt(e);break;case 9:jt(e);break}}function nn(e){switch(A){case 1:ut(e);break;case 0:pt(e);break;case 3:bt(e);break;case 4:Pt(e);break;case 5:vt(e);break;case 6:Dt(e);break;case 7:Rt(e);break;case 8:Vt(e);break;case 9:qt(e);break}me=!1}function rn(){switch(A){case 1:ft();break;case 0:xt();break;case 2:st();break;case 3:Ct();break;case 4:Bt();break;case 5:Ot();break;case 6:$t();break;case 7:Ft();break;case 8:Ut();break;case 9:zt();break}Me=!1}function sn(){Me=!0}function on(){B.width=window.innerWidth,B.height=window.innerHeight}window.onresize=on;
