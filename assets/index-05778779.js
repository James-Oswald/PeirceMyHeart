/* empty css               */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const f of s)if(f.type==="childList")for(const A of f.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&i(A)}).observe(document,{childList:!0,subtree:!0});function n(s){const f={};return s.integrity&&(f.integrity=s.integrity),s.referrerPolicy&&(f.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?f.credentials="include":s.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function i(s){if(s.ep)return;s.ep=!0;const f=n(s);fetch(s.href,f)}})();class o{constructor(t,n){if(this.x=t,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(t,n){if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=t,this.y=n}distance(t){const n=this.x-t.x,i=this.y-t.y;return Math.sqrt(n*n+i*i)}toString(){return"("+this.x+", "+this.y+")"}}function X(e,t){return Be(e,t)||Y(t,e)}function Be(e,t){if(e instanceof L)return t instanceof L?xe(e,t):pe(t,e);if(t instanceof L)return pe(e,t);if(xe(e.boundingBox,t.boundingBox)||Y(t.boundingBox,e.boundingBox)){const n=ae(e);let i;for(let s=0;s<n.length;s++)if(i=J(t,n[s]),i<=0)return!0;return!1}return!1}function pe(e,t){const n=ae(e);for(let i=0;i<n.length;i++)if(z(t,n[i]))return!0;return!1}function Y(e,t){if(e instanceof L)if(t instanceof L){const n=t.getCorners();for(let i=0;i<4;i++)if(!z(e,n[i]))return!1;return!0}else{const n=je(t);for(let i=0;i<4;i++)if(!z(e,n[i]))return!1;return!0}else if(t instanceof L){const n=t.getCorners();let i;for(let s=0;s<4;s++)if(i=J(e,n[s]),!(i<0))return!1;return!0}else{const n=ae(t);let i;for(let s=0;s<n.length;s++)if(i=J(e,n[s]),!(i<0))return!1;return!0}}function xe(e,t){const n=e.getCorners(),i=t.getCorners();return(n[0].y<=i[0].y&&n[2].y>=i[0].y||n[0].y<=i[2].y&&n[2].y>=i[2].y||i[0].y<=n[0].y&&i[2].y>=n[0].y||i[0].y<=n[2].y&&i[2].y>=n[2].y)&&(n[0].x<=i[0].x&&n[1].x>=i[0].x||n[0].x<=i[1].x&&n[1].x>=i[1].x||i[0].x<=n[0].x&&i[1].x>=n[0].x||i[0].x<=n[1].x&&i[1].x>=n[1].x)}function z(e,t){const n=e.getCorners();return n[0].x<t.x&&n[1].x>t.x&&n[0].y<t.y&&n[2].y>t.y}function J(e,t){return Math.pow(t.x-e.center.x,2)/Math.pow(e.radiusX,2)+Math.pow(t.y-e.center.y,2)/Math.pow(e.radiusY,2)-1}function je(e){return[new o(e.center.x,e.center.y-e.radiusY),new o(e.center.x+e.radiusX,e.center.y),new o(e.center.x,e.center.y+e.radiusY),new o(e.center.x-e.radiusX,e.center.y)]}function ae(e){const t=[];let n,i,s=1;for(let f=0;f<360;f++)n=e.center.x+e.radiusX*Math.cos(f*(Math.PI/180)),f>180&&(s=-1),i=Ne(e,n,s),t[f]=new o(n,i);return t}function Ne(e,t,n){return e.radiusX===0||e.radiusY===0?e.center.y:n*e.radiusY*Math.sqrt(1-Math.pow((t-e.center.x)/e.radiusX,2))+e.center.y}class L{constructor(t,n,i){if(!Number.isFinite(n)||!Number.isFinite(i))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(i!==void 0&&i<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=t,this.width=n,this.height=i}getCorners(){const t=[this.startVertex];return t.push(new o(this.startVertex.x+this.width,this.startVertex.y)),t.push(new o(this.startVertex.x+this.width,this.startVertex.y+this.height)),t.push(new o(this.startVertex.x,this.startVertex.y+this.height)),t}containsPoint(t){return z(this,t)}overlaps(t){return X(this,t)}contains(t){return Y(this,t)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}class a{constructor(t,n,i,s){if(t.length!==1)throw new Error("String of length "+t.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(t))throw new Error(t+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=t,this.internalOrigin=n,this.internalWidth=i,this.internalHeight=s}get width(){return this.internalWidth}set width(t){this.internalWidth=t}get height(){return this.internalHeight}set height(t){this.internalHeight=t}get identifier(){return this.internalIdentifier}set identifier(t){this.internalIdentifier=t}get origin(){return this.internalOrigin}set origin(t){this.internalOrigin=t}containsPoint(t){return this.calcRect().containsPoint(t)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.calcRect().toString()}calcRect(){return new L(new o(this.internalOrigin.x,this.internalOrigin.y-this.internalHeight),this.internalWidth,this.internalHeight)}}class u{constructor(t,n){this.internalEllipse=t,this.internalChildren=n??[]}get ellipse(){return this.internalEllipse}set ellipse(t){this.internalEllipse=t}get children(){return this.internalChildren}set children(t){this.internalChildren=t}set child(t){this.internalChildren.push(t)}getCurrentCut(t){for(let n=0;n<this.internalChildren.length;n++){const i=this.internalChildren[n];if(i instanceof u&&i.containsNode(t))return i.getCurrentCut(t)}return this}containsPoint(t){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(t)}containsNode(t){return this.internalEllipse===null?!0:t instanceof a?Y(this.internalEllipse,t.calcRect()):Y(this.internalEllipse,t.internalEllipse)}getLowestNode(t){if(!this.containsPoint(t))return null;for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t))return this.internalChildren[n]instanceof a||this.internalChildren[n]instanceof u&&this.internalChildren[n].children.length===0?this.internalChildren[n]:this.internalChildren[n].getLowestNode(t);return this}getLowestParent(t){if(!this.containsPoint(t))throw new Error("This parent "+this.toString+" does not contain the point.");for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t)){if(this.internalChildren[n]instanceof a||this.internalChildren[n]instanceof u&&this.internalChildren[n].children.length===0)return this;{const i=this.internalChildren[n];for(let s=0;s<i.children.length;s++)if(i.children[s].containsPoint(t))return i.getLowestParent(t);return this}}return null}remove(t){if(!this.containsPoint(t))return!1;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(t)){if(this.children[n]instanceof a||this.children[n]instanceof u&&this.children[n].children.length===0)return this.children.splice(n,1),!0;for(let i=0;i<this.children[n].children.length;i++)if(this.children[n].children[i].containsPoint(t))if(this.children[n].children[i]instanceof a)this.children[n].children.splice(i,1);else return this.children[n].children[i].remove(t);return this.children.splice(n,1),!0}return!1}toString(){let t;return this.internalEllipse===null?t="Sheet of Assertion of the AEG Tree":t="A cut node with boundary box of "+this.internalEllipse.toString(),this.internalChildren.length>0&&(t+=", With nested nodes: "+this.internalChildren.toString()),t}toFormulaString(){let t="";for(const n of this.internalChildren)n instanceof a?t+=n.identifier:n instanceof u&&(t+=n.toFormulaString()),t+=" ";return t=t.slice(0,-1),this.internalEllipse===null?t="["+t+"]":t="("+t+")",t}}class Z{constructor(t){this.internalSheet=t??new u(null)}get sheet(){return this.internalSheet}set sheet(t){this.internalSheet=t}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(t){for(let n=0;n<t.children.length;n++){if(!t.containsNode(t.children[n]))return!1;for(let i=n+1;i<t.children.length;i++)if(this.overlaps(t.children[n],t.children[i]))return!1}for(let n=0;n<t.children.length;n++)if(t.children[n]instanceof u&&!this.verifyAEG(t.children[n]))return!1;return!0}canInsert(t){const n=this.internalSheet.getCurrentCut(t);for(let i=0;i<n.children.length;i++)if(this.intersects(t,n.children[i]))return!1;return!0}insert(t){if(!this.canInsert(t))throw new Error("Insertion failed. "+t+" had a collision.");const n=this.internalSheet.getCurrentCut(t),i=[...n.children];if(n.child=t,t instanceof u)for(let s=i.length-1;s>=0;s--)t.containsNode(i[s])&&(t.child=i[s],n.children.splice(s,1));return!0}getLowestNode(t){return this.internalSheet.getLowestNode(t)}getLowestParent(t){return this.internalSheet.getLowestParent(t)}remove(t){return this.internalSheet.remove(t)}intersects(t,n){const i=t instanceof a?t.calcRect():t.ellipse,s=n instanceof a?n.calcRect():n.ellipse;return Be(i,s)}overlaps(t,n){let i,s;return t instanceof a?n instanceof a?X(t.calcRect(),n.calcRect()):(i=n.ellipse,X(t.calcRect(),i)):n instanceof a?(i=t.ellipse,X(i,n.calcRect())):(i=t.ellipse,s=n.ellipse,X(i,s))}toString(){return this.internalSheet.toFormulaString()}}class j{constructor(t,n,i){if(this.center=t,this.radiusX=n,this.radiusY=i,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const s=new o(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new L(s,this.radiusX*2,this.radiusY*2)}containsPoint(t){return J(this,t)<0}overlaps(t){return X(this,t)}contains(t){return Y(this,t)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}const ze=document.getElementById("theme-select");function H(e){return getComputedStyle(document.body).getPropertyValue(e)}let Le=H("--good-placement"),Se=H("--bad-placement"),Oe=H("--canvas-items");function Ae(){setTimeout(()=>{Le=H("--good-placement"),Se=H("--bad-placement"),Oe=H("--canvas-items"),c(r)})}ze.addEventListener("input",()=>{Ae()});window.addEventListener("DOMContentLoaded",()=>{Ae()});function y(){return Se}function m(){return Le}function ve(){return Oe}const le=document.getElementById("canvas"),De=le.getContext("2d");if(De===null)throw Error("2d rendering context not supported");const d=De;d.font="35pt arial";const Je=document.getElementById("graphString"),qe=document.getElementById("atomBox"),$e=document.getElementById("atomBoxes");$e.addEventListener("input",Ke);function I(e,t){d.strokeStyle=t;const n=e.ellipse,i=n.center;d.beginPath(),d.ellipse(i.x+l.x,i.y+l.y,n.radiusX,n.radiusY,0,0,2*Math.PI),d.stroke()}function M(e,t,n){d.textBaseline="bottom";const i=d.measureText(e.identifier);d.fillStyle=t,d.strokeStyle=t,d.beginPath(),d.fillText(e.identifier,e.origin.x+l.x,e.origin.y+l.y),($e.checked||qe.checked&&n)&&d.rect(e.origin.x+l.x,e.origin.y+l.y-i.actualBoundingBoxAscent,e.width,e.height),d.stroke()}function Xe(e,t,n){d.beginPath(),d.strokeStyle=n;const i=e.x-t.x+l.x,s=e.y-t.y+l.y;d.rect(e.x,e.y,-i,-s),d.stroke()}function Ke(){c(r)}function c(e){Je.innerHTML=e.toString(),d.clearRect(0,0,le.width,le.height),He(e.sheet)}function He(e){for(let t=0;e.children.length>t;t++)e.children[t]instanceof a?Ze(e.children[t]):He(e.children[t]);e.ellipse instanceof j&&(d.strokeStyle=ve(),d.beginPath(),d.ellipse(e.ellipse.center.x+l.x,e.ellipse.center.y+l.y,e.ellipse.radiusX,e.ellipse.radiusY,0,0,2*Math.PI),d.stroke())}function Ze(e){M(e,ve(),!1)}let oe,l=new o(0,0),ue;function Qe(e){oe=new o(e.x-l.x,e.y-l.y),ue=!1}function _e(e){ue||(l=new o(e.x-oe.x,e.y-oe.y),c(r))}function et(){ue=!0,c(r)}const tt=document.getElementById("showRect"),nt=document.getElementById("mode");let q,Q;function it(e){q=new o(e.clientX-l.x,e.clientY-l.y),Q=!1}function rt(e){const t=new u(new j(new o(0,0),0,0)),n=new o(e.clientX-l.x,e.clientY-l.y);if(c(r),t.ellipse=_(q,n),!Q){const s=r.canInsert(t)&&R(t.ellipse)?m():y();I(t,s),tt.checked&&Xe(q,n,s)}}function st(e){const t=new o(e.clientX-l.x,e.clientY-l.y),n=new u(_(q,t));r.canInsert(n)&&!Q&&R(n.ellipse)&&r.insert(n),c(r)}function lt(){Q=!0,c(r)}function _(e,t){const n=new o((t.x-e.x)/2+e.x,(t.y-e.y)/2+e.y),i=e.x-t.x,s=e.y-t.y,f=Math.abs(i),A=Math.abs(s);let ne,ie;if(nt.value==="circumscribed"){const ge=Math.floor(n.distance(t));ie=Math.floor(ge*(A/f)),ne=Math.floor(ge*(f/A))}else ne=f/2,ie=A/2;return new j(n,ne,ie)}function R(e){return e.radiusX>15&&e.radiusY>15}const ot=document.getElementById("canvas"),Ye=ot.getContext("2d");if(Ye===null)throw Error("2d rendering context not supported");const ct=Ye,Re=document.getElementById("atomDisplay");let C,ee,v="A";Re.innerHTML=v;function at(e){new RegExp(/^[A-Za-z]$/).test(e.key)&&(v=e.key,Re.innerHTML=v)}function ut(e){C=ct.measureText(v),ee=!1;const t=new a(v,new o(e.clientX-l.x,e.clientY-l.y),C.width,C.fontBoundingBoxDescent+C.actualBoundingBoxAscent);c(r);const n=r.canInsert(t)?m():y();M(t,n,!0)}function ft(e){const t=new a(v,new o(e.clientX-l.x,e.clientY-l.y),C.width,C.fontBoundingBoxDescent+C.actualBoundingBoxAscent);c(r),ee||(r.canInsert(t)?M(t,m(),!0):M(t,y(),!0))}function dt(e){const t=new a(v,new o(e.clientX-l.x,e.clientY-l.y),C.width,C.fontBoundingBoxDescent+C.actualBoundingBoxAscent);r.canInsert(t)&&!ee&&r.insert(t),c(r)}function ht(){ee=!0,c(r)}async function wt(e,t){const n=JSON.stringify(t,null,"	"),i=await e.createWritable();await i.write(n),await i.close()}function Fe(e){if(typeof e=="string"){const n=JSON.parse(e).internalSheet.internalChildren,i=new Z,s=[];return n.forEach(f=>{Object.prototype.hasOwnProperty.call(f,"internalEllipse")?s.push(Te(f)):s.push(Ve(f))}),i.sheet.children=s,i}return null}function Te(e){const t=new j(new o(e.internalEllipse.center.x,e.internalEllipse.center.y),e.internalEllipse.radiusX,e.internalEllipse.radiusY),n=[];return e.internalChildren.forEach(i=>{"internalEllipse"in i?n.push(Te(i)):n.push(Ve(i))}),new u(t,n)}function Ve(e){const t=e.internalIdentifier,n=new o(e.internalOrigin.x,e.internalOrigin.y);return new a(t,n,e.internalWidth,e.internalHeight)}function N(e,t){if(e.ellipse!==null){const n=O(e,t);if(!r.canInsert(n))return!1}for(let n=0;n<e.children.length;n++){if(e.children[n]instanceof u&&e.children[n].ellipse!==null&&!N(e.children[n],t))return!1;if(e.children[n]instanceof a){let i=e.children[n];if(i=b(i,t),!r.canInsert(i))return!1}}return!0}function fe(e,t,n){if(e instanceof u&&e.ellipse!==null){const i=O(e,n);if(I(i,t),e.children.length!==0)for(let s=0;s<e.children.length;s++)fe(e.children[s],t,n)}else if(e instanceof a){const i=b(e,n);M(i,t,!0)}}function de(e,t){if(e instanceof u&&e.ellipse!==null){const n=O(e,t);if(r.insert(n),e.children.length!==0)for(let i=0;i<e.children.length;i++)de(e.children[i],t)}else if(e instanceof a){const n=b(e,t);r.insert(n)}}function O(e,t){if(e.ellipse!==null)return new u(new j(new o(e.ellipse.center.x+t.x-l.x,e.ellipse.center.y+t.y-l.y),e.ellipse.radiusX,e.ellipse.radiusY));throw new Error("Cannot alter the position of a cut without an ellipse.")}function b(e,t){return new a(e.identifier,new o(e.origin.x+t.x-l.x,e.origin.y+t.y-l.y),e.width,e.height)}let P,h=null,D;function yt(e){if(P=new o(e.x-l.x,e.y-l.y),h=r.getLowestNode(P),h!==r.sheet&&h!==null){const t=r.getLowestParent(P);if(t!==null&&t.remove(P),h instanceof u&&h.children.length!==0){for(let n=0;n<h.children.length;n++)r.insert(h.children[n]);h.children=[]}D=!0}else D=!1}function gt(e){if(D){const t=new o(e.x-P.x,e.y-P.y);if(h instanceof u){const n=O(h,t);c(r);const i=r.canInsert(n)?m():y();I(n,i)}else if(h instanceof a){const n=b(h,t);c(r);const i=r.canInsert(n)?m():y();M(n,i,!0)}}}function pt(e){if(D){const t=new o(e.x-P.x,e.y-P.y);if(h instanceof u){const n=O(h,t);r.canInsert(n)?r.insert(n):r.insert(h)}else if(h instanceof a){const n=b(h,t);r.canInsert(n)?r.insert(n):r.insert(h)}c(r)}D=!1}function xt(){D&&h!==null&&r.insert(h),D=!1,c(r)}let B,g=null,$;function mt(e){if(B=new o(e.x-l.x,e.y-l.y),g=r.getLowestNode(B),g!==r.sheet&&g!==null){const t=r.getLowestParent(B);t!==null&&t.remove(B),$=!0}else $=!1}function Mt(e){if($){const t=new o(e.x-B.x,e.y-B.y);if(c(r),g instanceof u){const n=N(g,t)?m():y();fe(g,n,t)}else if(g instanceof a){const n=b(g,t),i=r.canInsert(n)?m():y();M(n,i,!0)}}}function Et(e){if($){const t=new o(e.x-B.x,e.y-B.y);if(g instanceof u)N(g,t)?de(g,t):r.insert(g);else if(g instanceof a){const n=b(g,t);r.canInsert(n)?r.insert(n):r.insert(g)}}c(r),$=!1}function bt(){$&&g!==null&&r.insert(g),$=!1,c(r)}let F,x=null,T;function Ct(e){F=new o(e.x-l.x,e.y-l.y);const t=r.getLowestNode(F);t!==r.sheet&&t!==null?(t instanceof u?(x=O(t,new o(0,0)),x.children=[]):t instanceof a&&(x=t),T=!0):T=!1}function kt(e){if(T){const t=new o(e.x-F.x,e.y-F.y);if(x instanceof u){const n=O(x,t);c(r);const i=r.canInsert(n)?m():y();I(n,i)}else if(x instanceof a){const n=b(x,t);c(r);const i=r.canInsert(n)?m():y();M(n,i,!0)}}}function It(e){if(T){const t=new o(e.x-F.x,e.y-F.y);if(x instanceof u&&x.ellipse!==null){const n=O(x,t);r.canInsert(n)&&r.insert(n)}else if(x instanceof a){const n=b(x,t);r.canInsert(n)&&r.insert(n)}c(r)}T=!1}function Pt(){T=!1,c(r)}let V,p=null,G;function Bt(e){V=new o(e.x-l.x,e.y-l.y),p=r.getLowestNode(V),p!==r.sheet&&p!==null?G=!0:G=!1}function Lt(e){if(G){const t=new o(e.x-V.x,e.y-V.y);if(c(r),p instanceof u){const n=N(p,t)?m():y();fe(p,n,t)}else if(p instanceof a){const n=b(p,t),i=r.canInsert(n)?m():y();M(n,i,!0)}}}function St(e){if(G){const t=new o(e.x-V.x,e.y-V.y);if(p instanceof u)N(p,t)&&de(p,t);else if(p instanceof a){const n=b(p,t);r.canInsert(n)&&r.insert(n)}}c(r),G=!1}function Ot(){G=!1,c(r)}let me,w=null,U;function At(e){me=new o(e.x-l.x,e.y-l.y),w=r.getLowestNode(me),w!==r.sheet&&w!==null&&(U=!0,w instanceof a?M(w,y(),!0):I(w,y()))}function vt(e){const t=new o(e.x-l.x,e.y-l.y),n=r.getLowestNode(t);w!==null&&w!==n&&(U=!0,c(r),n===r.sheet||n===null?(w=null,U=!1):(w=n,w instanceof a?M(w,y(),!0):I(w,y())))}function Dt(e){const t=new o(e.x-l.x,e.y-l.y);if(U){const n=r.getLowestParent(t);if(n!==null&&n.remove(t),w instanceof u&&w.children.length!==0)for(let i=0;i<w.children.length;i++)r.insert(w.children[i])}c(r),w=null,U=!1}function $t(){w=null,U=!1}let Me,E=null,W;function Xt(e){Me=new o(e.x-l.x,e.y-l.y),E=r.getLowestNode(Me),E!==r.sheet&&E!==null&&(W=!0,he(E,y()))}function Ht(e){const t=new o(e.x-l.x,e.y-l.y),n=r.getLowestNode(t);E!==null&&E!==r.getLowestNode(t)&&(W=!0,c(r),n===r.sheet||n===null?(E=null,W=!1):(E=n,he(E,y())))}function Yt(e){const t=new o(e.x-l.x,e.y-l.y);if(W){const n=r.getLowestParent(t);n!==null&&n.remove(t),c(r)}E=null,W=!1}function Rt(){E=null,W=!1}function he(e,t){if(e instanceof a)M(e,t,!0);else if(e instanceof u){I(e,t);for(let n=0;n<e.children.length;n++)he(e.children[n],t)}}const Ft=document.getElementById("showRect");let K,te;function Tt(e){K=new o(e.clientX-l.x,e.clientY-l.y),te=!1}function Vt(e){const t=new o(e.clientX-l.x,e.clientY-l.y),n=new u(_(K,t)),i=new u(Ge(n.ellipse));if(c(r),!te&&n.ellipse!==null&&i.ellipse!==null){const f=r.canInsert(n)&&R(n.ellipse)&&r.canInsert(i)&&R(i.ellipse)?m():y();I(n,f),I(i,f),Ft.checked&&Xe(K,t,f)}}function Gt(e){const t=new o(e.clientX-l.x,e.clientY-l.y),n=new u(_(K,t)),i=new u(Ge(n.ellipse));!te&&n.ellipse!==null&&i.ellipse!==null&&r.canInsert(n)&&R(n.ellipse)&&r.canInsert(i)&&R(i.ellipse)&&(r.insert(n),r.insert(i)),c(r)}function Ut(){te=!0,c(r)}function Ge(e){return new j(e.center,Math.floor(e.radiusX*.8),Math.floor(e.radiusY*.8))}let re=!0,Ee=null,be=null;const Ce=document.getElementById("DrawButtons"),ke=document.getElementById("ProofButtons");function Wt(){if(re=!re,re){Ce.style.display="block",ke.style.display="none";const e=Fe(Ee);if(e!==null)r.sheet=e.sheet;else throw Error("invalid cached AEG");ce(be)}else Ce.style.display="none",ke.style.display="block",Ee=JSON.stringify(r),be=S,r.sheet=new Z().sheet,ce(null);c(r)}const k=document.getElementById("canvas");k.width=window.innerWidth;k.height=window.innerHeight;const Ue=k.getContext("2d");if(Ue===null)throw Error("2d rendering context not supported");const jt=Ue;jt.font="35pt arial";const se=document.getElementById("cutTools"),Ie=document.getElementById("atomTools");window.addEventListener("keydown",Jt);k.addEventListener("mousedown",qt);k.addEventListener("mousemove",Kt);k.addEventListener("mouseup",Zt);k.addEventListener("mouseout",Qt);k.addEventListener("mouseenter",_t);let S=null,we=!1,ye=!0,r=new Z;window.atomMode=0;window.cutMode=1;window.dragMode=2;window.saveMode=We;window.loadMode=zt;window.moveSingleMode=3;window.moveMultiMode=4;window.copySingleMode=5;window.copyMultiMode=6;window.deleteSingleMode=7;window.deleteMultiMode=8;window.doubleCutInsertionTool=9;window.setMode=ce;window.setHighlight=Nt;window.toggleHandler=Wt;function Nt(e,t){const n=document.getElementById(t);switch(e){case"mousedown":n==null||n.classList.remove("no-highlight");break;case"mouseleave":n==null||n.classList.add("no-highlight");break}}const Pe=document.querySelectorAll(".modeButton");Pe.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("modeButtonPressed"),Pe.forEach(t=>{t!==e&&t.classList.remove("modeButtonPressed")})})});function ce(e){switch(S=e,se.style.display="none",Ie.style.display="none",S){case 0:Ie.style.display="block";break;case 1:se.style.display="block";break;case 9:se.style.display="block";break}}async function We(){if("showSaveFilePicker"in window){const e=await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"AEG Tree",startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]});wt(e,r)}else{const e=document.createElement("a");e.href=JSON.stringify(r,null,"	"),e.download="AEGTree.json",e.click()}}async function zt(){const[e]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),t=await e.getFile(),n=new FileReader;n.addEventListener("load",()=>{const i=n.result,s=Fe(i);s instanceof Z&&(r=s,c(r))}),n.readAsText(t)}function Jt(e){if(e.ctrlKey&&e.key==="s")e.preventDefault(),We();else switch(S){case 0:at(e);break}}function qt(e){switch(S){case 1:it(e);break;case 0:ut(e);break;case 2:Qe(e);break;case 3:yt(e);break;case 4:mt(e);break;case 5:Ct(e);break;case 6:Bt(e);break;case 7:At(e);break;case 8:Xt(e);break;case 9:Tt(e);break}we=!0}function Kt(e){if(we&&ye)switch(S){case 1:rt(e);break;case 0:ft(e);break;case 2:_e(e);break;case 3:gt(e);break;case 4:Mt(e);break;case 5:kt(e);break;case 6:Lt(e);break;case 7:vt(e);break;case 8:Ht(e);break;case 9:Vt(e);break}}function Zt(e){switch(S){case 1:st(e);break;case 0:dt(e);break;case 3:pt(e);break;case 4:Et(e);break;case 5:It(e);break;case 6:St(e);break;case 7:Dt(e);break;case 8:Yt(e);break;case 9:Gt(e);break}we=!1}function Qt(){switch(S){case 1:lt();break;case 0:ht();break;case 2:et();break;case 3:xt();break;case 4:bt();break;case 5:Pt();break;case 6:Ot();break;case 7:$t();break;case 8:Rt();break;case 9:Ut();break}ye=!1}function _t(){ye=!0}function en(){k.width=window.innerWidth,k.height=window.innerHeight}window.onresize=en;
