/* empty css               */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const f of i)if(f.type==="childList")for(const x of f.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&o(x)}).observe(document,{childList:!0,subtree:!0});function n(i){const f={};return i.integrity&&(f.integrity=i.integrity),i.referrerPolicy&&(f.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?f.credentials="include":i.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function o(i){if(i.ep)return;i.ep=!0;const f=n(i);fetch(i.href,f)}})();class c{constructor(t,n){if(this.x=t,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(t,n){if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=t,this.y=n}distance(t){const n=this.x-t.x,o=this.y-t.y;return Math.sqrt(n*n+o*o)}toString(){return"("+this.x+", "+this.y+")"}}function ge(e,t){return qt(e,t)||me(t,e)}function qt(e,t){if(e instanceof le)return t instanceof le?$t(e,t):Dt(t,e);if(t instanceof le)return Dt(e,t);if($t(e.boundingBox,t.boundingBox)||me(t.boundingBox,e.boundingBox)){const n=Vt(e);let o;for(let i=0;i<n.length;i++)if(o=Ve(t,n[i]),o<=0)return!0;return!1}return!1}function Dt(e,t){const n=t.getCorners(),o=Oe(e,n[0].x,1),i=Oe(e,n[1].x,1),f=Oe(e,n[0].x,-1),x=Oe(e,n[1].x,-1);if(n[0].y<o&&o<n[2].y||n[0].y<f&&f<n[2].y||n[0].y<i&&i<n[2].y||n[0].y<x&&x<n[2].y)return!0;const g=-1/Math.pow(e.radiusX,2),D=2*e.center.x/Math.pow(e.radiusX,2),ye=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[0].y-e.center.y)/e.radiusY,2),It=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[2].y-e.center.y)/e.radiusY,2),nt=(-D+Math.sqrt(Math.pow(D,2)-4*g*ye))/(2*g),ot=(-D-Math.sqrt(Math.pow(D,2)-4*g*ye))/(2*g),rt=(-D+Math.sqrt(Math.pow(D,2)-4*g*It))/(2*g),it=(-D-Math.sqrt(Math.pow(D,2)-4*g*It))/(2*g);return!isNaN(nt)&&n[0].x<nt&&nt<n[1].x||!isNaN(ot)&&n[0].x<ot&&ot<n[1].x||!isNaN(rt)&&n[0].x<rt&&rt<n[1].x||!isNaN(it)&&n[0].x<it&&it<n[1].x}function me(e,t){if(e instanceof le)if(t instanceof le){const n=t.getCorners();for(let o=0;o<4;o++)if(!ft(e,n[o]))return!1;return!0}else{const n=gn(t);for(let o=0;o<4;o++)if(!ft(e,n[o]))return!1;return!0}else if(t instanceof le){const n=t.getCorners();let o;for(let i=0;i<4;i++)if(o=Ve(e,n[i]),!(o<0))return!1;return!0}else{const n=Vt(t);let o;for(let i=0;i<n.length;i++)if(o=Ve(e,n[i]),!(o<0))return!1;return!0}}function $t(e,t){const n=e.getCorners(),o=t.getCorners();return(n[0].y<=o[0].y&&n[2].y>=o[0].y||n[0].y<=o[2].y&&n[2].y>=o[2].y||o[0].y<=n[0].y&&o[2].y>=n[0].y||o[0].y<=n[2].y&&o[2].y>=n[2].y)&&(n[0].x<=o[0].x&&n[1].x>=o[0].x||n[0].x<=o[1].x&&n[1].x>=o[1].x||o[0].x<=n[0].x&&o[1].x>=n[0].x||o[0].x<=n[1].x&&o[1].x>=n[1].x)}function ft(e,t){const n=e.getCorners();return n[0].x<t.x&&n[1].x>t.x&&n[0].y<t.y&&n[2].y>t.y}function Ve(e,t){return Math.pow(t.x-e.center.x,2)/Math.pow(e.radiusX,2)+Math.pow(t.y-e.center.y,2)/Math.pow(e.radiusY,2)-1}function gn(e){return[new c(e.center.x,e.center.y-e.radiusY),new c(e.center.x+e.radiusX,e.center.y),new c(e.center.x,e.center.y+e.radiusY),new c(e.center.x-e.radiusX,e.center.y)]}function Vt(e){const t=[];let n,o,i=1;for(let f=0;f<360;f++)n=e.center.x+e.radiusX*Math.cos(f*(Math.PI/180)),f>180&&(i=-1),o=Oe(e,n,i),t[f]=new c(n,o);return t}function Oe(e,t,n){return e.radiusX===0||e.radiusY===0?e.center.y:n*e.radiusY*Math.sqrt(1-Math.pow((t-e.center.x)/e.radiusX,2))+e.center.y}class le{constructor(t,n,o){if(!Number.isFinite(n)||!Number.isFinite(o))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(o!==void 0&&o<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=t,this.width=n,this.height=o}getCorners(){const t=[this.startVertex];return t.push(new c(this.startVertex.x+this.width,this.startVertex.y)),t.push(new c(this.startVertex.x+this.width,this.startVertex.y+this.height)),t.push(new c(this.startVertex.x,this.startVertex.y+this.height)),t}containsPoint(t){return ft(this,t)}overlaps(t){return ge(this,t)}contains(t){return me(this,t)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}class u{constructor(t,n,o,i){if(t.length!==1)throw new Error("String of length "+t.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(t))throw new Error(t+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=t,this.internalOrigin=n,this.internalWidth=o,this.internalHeight=i}copy(){return new u(this.internalIdentifier,new c(this.internalOrigin.x,this.internalOrigin.y),this.internalWidth,this.internalHeight)}get width(){return this.internalWidth}set width(t){this.internalWidth=t}get height(){return this.internalHeight}set height(t){this.internalHeight=t}get identifier(){return this.internalIdentifier}set identifier(t){this.internalIdentifier=t}get origin(){return this.internalOrigin}set origin(t){this.internalOrigin=t}containsPoint(t){return this.calcRect().containsPoint(t)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.calcRect().toString()}calcRect(){return new le(new c(this.internalOrigin.x,this.internalOrigin.y-this.internalHeight),this.internalWidth,this.internalHeight)}isEqualTo(t){return this.identifier===t.identifier}}class Z{constructor(t,n,o){if(this.center=t,this.radiusX=n,this.radiusY=o,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const i=new c(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new le(i,this.radiusX*2,this.radiusY*2)}containsPoint(t){return Ve(this,t)<0}overlaps(t){return ge(this,t)}contains(t){return me(this,t)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}class a{constructor(t,n){this.internalEllipse=t,this.internalChildren=n??[]}copy(){let t;const n=[];if(this.ellipse!==null?t=new Z(new c(this.ellipse.center.x,this.ellipse.center.y),this.ellipse.radiusX,this.ellipse.radiusY):t=null,this.children.length>0)for(let o=0;o<this.children.length;o++){const i=this.children[o];i instanceof u,n.push(i.copy())}return new a(t,n)}get ellipse(){return this.internalEllipse}set ellipse(t){this.internalEllipse=t}get children(){return this.internalChildren}set children(t){this.internalChildren=t}set child(t){this.internalChildren.push(t)}getCurrentCut(t){for(let n=0;n<this.internalChildren.length;n++){const o=this.internalChildren[n];if(o instanceof a&&o.containsNode(t))return o.getCurrentCut(t)}return this}containsPoint(t){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(t)}containsNode(t){return this.internalEllipse===null?!0:t instanceof u?me(this.internalEllipse,t.calcRect()):me(this.internalEllipse,t.internalEllipse)}getLowestNode(t){if(!this.containsPoint(t))return null;for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t))return this.internalChildren[n]instanceof u||this.internalChildren[n]instanceof a&&this.internalChildren[n].children.length===0?this.internalChildren[n]:this.internalChildren[n].getLowestNode(t);return this}getLowestParent(t){if(!this.containsPoint(t))throw new Error("This parent "+this.toString+" does not contain the point.");for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t)){if(this.internalChildren[n]instanceof u||this.internalChildren[n]instanceof a&&this.internalChildren[n].children.length===0)return this;{const o=this.internalChildren[n];for(let i=0;i<o.children.length;i++)if(o.children[i].containsPoint(t))return o.getLowestParent(t);return this}}return null}getLevel(t,n){for(let o=0;o<this.internalChildren.length;o++){if(this.internalChildren[o]===t)return n;if(this.internalChildren[o]instanceof a&&this.internalChildren[o].containsNode(t))return this.internalChildren[o].getLevel(t,n+1)}return-1}remove(t){if(!this.containsPoint(t))return!1;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(t)){if(this.children[n]instanceof u||this.children[n]instanceof a&&this.children[n].children.length===0)return this.children.splice(n,1),!0;for(let o=0;o<this.children[n].children.length;o++)if(this.children[n].children[o].containsPoint(t))if(this.children[n].children[o]instanceof u)this.children[n].children.splice(o,1);else return this.children[n].children[o].remove(t);return this.children.splice(n,1),!0}return!1}clear(){this.internalChildren=[]}toString(){let t;return this.internalEllipse===null?t="Sheet of Assertion of the AEG Tree":t="A cut node with boundary box of "+this.internalEllipse.toString(),this.internalChildren.length>0&&(t+=", With nested nodes: "+this.internalChildren.toString()),t}isEmptySheet(){return this.internalEllipse===null&&this.internalChildren.length===0}toFormulaString(){let t="";for(const n of this.internalChildren)n instanceof u?t+=n.identifier:n instanceof a&&(t+=n.toFormulaString()),t+=" ";return t=t.slice(0,-1),this.internalEllipse===null?t="["+t+"]":t="("+t+")",t}isEqualTo(t){if(this.children.length===t.children.length){if(this.children.length===0)return!0;const n=this.copy().children,o=t.copy().children;for(let i=0;i<n.length;i++)for(let f=0;f<o.length;f++){if(n[i]instanceof u&&o[f]instanceof u&&n[i].isEqualTo(o[f])||n[i]instanceof a&&o[f]instanceof a&&n[i].isEqualTo(o[f])){n.splice(i,1),o.splice(f,1),i--;break}if(f===o.length-1)return!1}return n.length===0&&o.length===0}return!1}}class m{constructor(t){t!==void 0?(this.internalSheet=t.copy(),this.internalSheet.ellipse=null):this.internalSheet=new a(null)}get sheet(){return this.internalSheet}set sheet(t){this.internalSheet=t}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(t){for(let n=0;n<t.children.length;n++){if(!t.containsNode(t.children[n]))return!1;for(let o=n+1;o<t.children.length;o++)if(this.overlaps(t.children[n],t.children[o]))return!1}for(let n=0;n<t.children.length;n++)if(t.children[n]instanceof a&&!this.verifyAEG(t.children[n]))return!1;return!0}canInsert(t){const n=this.internalSheet.getCurrentCut(t);for(let o=0;o<n.children.length;o++)if(this.intersects(t,n.children[o]))return!1;return!0}insert(t){if(!this.canInsert(t))throw new Error("Insertion failed. "+t+" had a collision.");const n=this.internalSheet.getCurrentCut(t),o=[...n.children];if(n.child=t,t instanceof a)for(let i=o.length-1;i>=0;i--)t.containsNode(o[i])&&(t.child=o[i],n.children.splice(i,1));return!0}getLowestNode(t){return this.internalSheet.getLowestNode(t)}getLowestParent(t){return this.internalSheet.getLowestParent(t)}getLevel(t){return this.internalSheet.getLevel(t,0)}remove(t){return this.internalSheet.remove(t)}clear(){this.internalSheet.clear()}intersects(t,n){const o=t instanceof u?t.calcRect():t.ellipse,i=n instanceof u?n.calcRect():n.ellipse;return qt(o,i)}overlaps(t,n){let o,i;return t instanceof u?n instanceof u?ge(t.calcRect(),n.calcRect()):(o=n.ellipse,ge(t.calcRect(),o)):n instanceof u?(o=t.ellipse,ge(o,n.calcRect())):(o=t.ellipse,i=n.ellipse,ge(o,i))}isEqualTo(t){return this.sheet.isEqualTo(t.sheet)}toString(){return this.internalSheet.toFormulaString()}}class z{constructor(t,n){this.appliedRule=n??"",this.tree=new m(t==null?void 0:t.sheet)}}var s=(e=>(e[e.none=0]="none",e[e.atomTool=1]="atomTool",e[e.cutTool=2]="cutTool",e[e.dragTool=3]="dragTool",e[e.moveSingleTool=4]="moveSingleTool",e[e.moveMultiTool=5]="moveMultiTool",e[e.copySingleTool=6]="copySingleTool",e[e.copyMultiTool=7]="copyMultiTool",e[e.deleteSingleTool=8]="deleteSingleTool",e[e.deleteMultiTool=9]="deleteMultiTool",e[e.resizeTool=10]="resizeTool",e[e.copyFromDrawTool=11]="copyFromDrawTool",e[e.pasteInProofTool=12]="pasteInProofTool",e[e.doubleCutInsertionTool=13]="doubleCutInsertionTool",e[e.doubleCutDeletionTool=14]="doubleCutDeletionTool",e[e.insertionTool=15]="insertionTool",e[e.erasureTool=16]="erasureTool",e[e.proofMoveSingleTool=17]="proofMoveSingleTool",e[e.proofMoveMultiTool=18]="proofMoveMultiTool",e[e.proofResizeTool=19]="proofResizeTool",e[e.iterationTool=20]="iterationTool",e[e.deiterationTool=21]="deiterationTool",e))(s||{});const ve=class qe{static getLastProofStep(){return qe.proofHistory.length===0?new z(new m):qe.proofHistory[qe.proofHistory.length-1]}};ve.tree=new m;ve.proofHistory=[];ve.selectForProof=new m;ve.toolState=0;ve.modeState="Draw";let r=ve;const xn=document.getElementById("theme-select");function xe(e){return getComputedStyle(document.body).getPropertyValue(e)}let Gt=xe("--good-placement"),Wt=xe("--bad-placement"),jt=xe("--canvas-items");function Jt(){setTimeout(()=>{Gt=xe("--good-placement"),Wt=xe("--bad-placement"),jt=xe("--canvas-items"),r.modeState==="Draw"?d(r.tree):w()})}xn.addEventListener("input",()=>{Jt()});window.addEventListener("DOMContentLoaded",()=>{Jt()});function h(){return Wt}function y(){return Gt}function Kt(){return jt}const dt=document.getElementById("canvas"),Zt=dt.getContext("2d");if(Zt===null)throw Error("2d rendering context not supported");const M=Zt;M.font="35pt arial";const mn=document.getElementById("graphString"),Mn=document.getElementById("proofString"),Tn=document.getElementById("atomBox"),Qt=document.getElementById("atomBoxes");Qt.addEventListener("input",bn);function H(e,t){const n=e.ellipse;if(n!==null){M.strokeStyle=t;const o=n.center;M.beginPath(),M.ellipse(o.x+l.x,o.y+l.y,n.radiusX,n.radiusY,0,0,2*Math.PI),M.stroke()}}function O(e,t,n){M.textBaseline="bottom";const o=M.measureText(e.identifier);M.fillStyle=t,M.strokeStyle=t,M.beginPath(),M.fillText(e.identifier,e.origin.x+l.x,e.origin.y+l.y),(Qt.checked||Tn.checked&&n)&&M.rect(e.origin.x+l.x,e.origin.y+l.y-o.actualBoundingBoxAscent,e.width,e.height),M.stroke()}function _t(e,t,n){M.beginPath(),M.strokeStyle=n;const o=e.x-t.x+l.x,i=e.y-t.y+l.y;M.rect(e.x,e.y,-o,-i),M.stroke()}function bn(){d(r.tree)}function gt(){M.clearRect(0,0,dt.width,dt.height)}function d(e,t){mn.innerHTML=e.toString(),gt(),xt(e.sheet,t),window.treeString=tt(e)}function xt(e,t){for(let n=0;e.children.length>n;n++)e.children[n]instanceof u?Sn(e.children[n]):xt(e.children[n]);e.ellipse instanceof Z&&(M.strokeStyle=t||Kt(),M.beginPath(),M.ellipse(e.ellipse.center.x+l.x,e.ellipse.center.y+l.y,e.ellipse.radiusX,e.ellipse.radiusY,0,0,2*Math.PI),M.stroke())}function Sn(e){O(e,Kt(),!1)}function w(){let e;r.proofHistory.length===0?e=new m:e=r.proofHistory[r.proofHistory.length-1].tree,gt(),Mn.innerHTML=e.toString(),xt(e.sheet)}function en(e,t){if(e instanceof u)O(e,t,!1);else if(e instanceof a){H(e,t);for(let n=0;n<e.children.length;n++)en(e.children[n],t)}}function tn(e,t){const n=new c(1,1);if(e instanceof a&&e.ellipse!==null){const o=e.ellipse,i=[new c(o.center.x-o.radiusX,o.center.y),new c(o.center.x,o.center.y-o.radiusY),new c(o.center.x+o.radiusX,o.center.y),new c(o.center.x,o.center.y+o.radiusY)];i[0].distance(t)>=i[2].distance(t)?n.x=1:n.x=-1,i[1].distance(t)>=i[3].distance(t)?n.y=1:n.y=-1}return n}let ht,l=new c(0,0),mt;function Pn(e){ht=new c(e.x-l.x,e.y-l.y),mt=!1}function kn(e){mt||(l=new c(e.x-ht.x,e.y-ht.y),d(r.tree))}function Cn(){mt=!0,d(r.tree)}const En=document.getElementById("showRect"),Ln=document.getElementById("mode");let Ge,Ke;function In(e){Ge=new c(e.clientX-l.x,e.clientY-l.y),Ke=!1}function Dn(e){const t=new a(new Z(new c(0,0),0,0)),n=new c(e.clientX-l.x,e.clientY-l.y);if(d(r.tree),t.ellipse=Ze(Ge,n),!Ke){const i=r.tree.canInsert(t)&&ee(t.ellipse)?y():h();H(t,i),En.checked&&_t(Ge,n,i)}}function $n(e){const t=new c(e.clientX-l.x,e.clientY-l.y),n=new a(Ze(Ge,t));r.tree.canInsert(n)&&!Ke&&ee(n.ellipse)&&r.tree.insert(n),d(r.tree)}function vn(){Ke=!0,d(r.tree)}function Ze(e,t){const n=new c((t.x-e.x)/2+e.x,(t.y-e.y)/2+e.y),o=e.x-t.x,i=e.y-t.y,f=Math.abs(o),x=Math.abs(i);let g,D;if(Ln.value==="circumscribed"){const ye=Math.floor(n.distance(t));D=Math.floor(ye*(x/f)),g=Math.floor(ye*(f/x))}else g=f/2,D=x/2;return new Z(n,g,D)}function ee(e){return e.radiusX>15&&e.radiusY>15}const On=document.getElementById("canvas"),nn=On.getContext("2d");if(nn===null)throw Error("2d rendering context not supported");const Hn=nn,Nn=document.getElementById("atomDisplay");let Qe,Mt,$=Ye("A",new c(0,0));function Bn(e){new RegExp(/^[A-Za-z]$/).test(e.key)&&($=Ye(e.key,new c($.origin.x,$.origin.y)),$.origin.x!==0&&$.origin.y!==0&&Mt&&Tt())}function An(e){Qe=!1,Mt=!0,$=Ye($.identifier,new c(e.clientX-l.x,e.clientY-l.y)),Tt()}function Fn(e){$=Ye($.identifier,new c(e.clientX-l.x,e.clientY-l.y)),Tt()}function Rn(e){$=Ye($.identifier,new c(e.clientX-l.x,e.clientY-l.y)),r.tree.canInsert($)&&!Qe&&r.tree.insert($),d(r.tree),Mt=!1}function Xn(){Qe=!0,d(r.tree)}function Ye(e,t){Nn.innerHTML=e;const n=Hn.measureText(e);return new u(e,new c(t.x,t.y),n.width,n.fontBoundingBoxDescent+n.actualBoundingBoxAscent)}function Tt(){d(r.tree),Qe||(r.tree.canInsert($)?O($,y(),!0):O($,h(),!0))}async function Yn(e,t){const n=JSON.stringify(t,null,"	"),o=await e.createWritable();await o.write(n),await o.close()}function wt(e,t){const n=JSON.parse(t);if(e==="Draw"){const o=n.internalSheet.internalChildren;return vt(o)}else{const o=[];let i;for(i of n){const f=i.tree.internalSheet.internalChildren;o.push(new z(vt(f),i.appliedRule))}return o}}function vt(e){const t=new m,n=[];for(const o of e)Object.prototype.hasOwnProperty.call(o,"internalEllipse")?n.push(on(o)):n.push(rn(o));return t.sheet.children=n,t}function on(e){const t=new Z(new c(e.internalEllipse.center.x,e.internalEllipse.center.y),e.internalEllipse.radiusX,e.internalEllipse.radiusY),n=[];for(const o of e.internalChildren)"internalEllipse"in o?n.push(on(o)):n.push(rn(o));return new a(t,n)}function rn(e){const t=e.internalIdentifier,n=new c(e.internalOrigin.x,e.internalOrigin.y);return new u(t,n,e.internalWidth,e.internalHeight)}function ae(e,t,n){if(t.ellipse!==null){const o=U(t,n);if(!e.canInsert(o))return!1}for(let o=0;o<t.children.length;o++){if(t.children[o]instanceof a&&t.children[o].ellipse!==null&&!ae(e,t.children[o],n))return!1;if(t.children[o]instanceof u){let i=t.children[o];if(i=b(i,n),!e.canInsert(i))return!1}}return!0}function A(e,t,n){if(e instanceof a&&e.ellipse!==null){const o=U(e,n);if(H(o,t),e.children.length!==0)for(let i=0;i<e.children.length;i++)A(e.children[i],t,n)}else if(e instanceof u){const o=b(e,n);O(o,t,!0)}}function ze(e,t,n){const o=n||r.tree;if(e instanceof a&&e.ellipse!==null){const i=U(e,t);if(o.insert(i),e.children.length!==0)for(let f=0;f<e.children.length;f++)ze(e.children[f],t,n)}else if(e instanceof u){const i=b(e,t);o.insert(i)}}function Ne(e,t){return e instanceof u?b(e,t):U(e,t)}function U(e,t){if(e.ellipse!==null)return new a(new Z(new c(e.ellipse.center.x+t.x-l.x,e.ellipse.center.y+t.y-l.y),e.ellipse.radiusX,e.ellipse.radiusY));throw new Error("Cannot alter the position of a cut without an ellipse.")}function bt(e,t){if(e.ellipse!==null){const n=[];for(let o=0;o<e.children.length;o++)e.children[o]instanceof a?n.push(bt(e.children[o],t)):e.children[o]instanceof u&&n.push(b(e.children[o],t));return new a(new Z(new c(e.ellipse.center.x+t.x-l.x,e.ellipse.center.y+t.y-l.y),e.ellipse.radiusX,e.ellipse.radiusY),n)}else throw new Error("Cannot alter the position of a cut without an ellipse.")}function b(e,t){return new u(e.identifier,new c(e.origin.x+t.x-l.x,e.origin.y+t.y-l.y),e.width,e.height)}function Ue(e,t){if(e instanceof u)O(e,t,!0);else if(e instanceof a){H(e,t);for(let n=0;n<e.children.length;n++)Ue(e.children[n],t)}}function _e(e,t,n){if(e.ellipse!==null)return new a(new Z(new c(e.ellipse.center.x+t.x,e.ellipse.center.y+t.y),e.ellipse.radiusX+t.x*n.x,e.ellipse.radiusY+t.y*n.y));throw new Error("Cannot alter the position of a cut without an ellipse.")}let te,T=null,de;function zn(e){if(te=new c(e.x-l.x,e.y-l.y),T=r.tree.getLowestNode(te),T!==r.tree.sheet&&T!==null){const t=r.tree.getLowestParent(te);if(t!==null&&t.remove(te),T instanceof a&&T.children.length!==0){for(let n=0;n<T.children.length;n++)r.tree.insert(T.children[n]);T.children=[]}de=!0}else de=!1}function Un(e){if(de){const t=new c(e.x-te.x,e.y-te.y);if(T instanceof a){const n=U(T,t);d(r.tree);const o=r.tree.canInsert(n)?y():h();H(n,o)}else if(T instanceof u){const n=b(T,t);d(r.tree);const o=r.tree.canInsert(n)?y():h();O(n,o,!0)}}}function qn(e){if(de){const t=new c(e.x-te.x,e.y-te.y);if(T instanceof a){const n=U(T,t);r.tree.canInsert(n)?r.tree.insert(n):r.tree.insert(T)}else if(T instanceof u){const n=b(T,t);r.tree.canInsert(n)?r.tree.insert(n):r.tree.insert(T)}d(r.tree)}de=!1}function Vn(){de&&T!==null&&r.tree.insert(T),de=!1,d(r.tree)}let ne,L=null,he;function Gn(e){if(ne=new c(e.x-l.x,e.y-l.y),L=r.tree.getLowestNode(ne),L!==r.tree.sheet&&L!==null){const t=r.tree.getLowestParent(ne);t!==null&&t.remove(ne),he=!0}else he=!1}function Wn(e){if(he){const t=new c(e.x-ne.x,e.y-ne.y);if(d(r.tree),L instanceof a){const n=ae(r.tree,L,t)?y():h();A(L,n,t)}else if(L instanceof u){const n=b(L,t),o=r.tree.canInsert(n)?y():h();O(n,o,!0)}}}function jn(e){if(he){const t=new c(e.x-ne.x,e.y-ne.y);if(L instanceof a)ae(r.tree,L,t)?ze(L,t):r.tree.insert(L);else if(L instanceof u){const n=b(L,t);r.tree.canInsert(n)?r.tree.insert(n):r.tree.insert(L)}}d(r.tree),he=!1}function Jn(){he&&L!==null&&r.tree.insert(L),he=!1,d(r.tree)}let oe,Y=null,Me;function Kn(e){oe=new c(e.x-l.x,e.y-l.y);const t=r.tree.getLowestNode(oe),n=new c(e.x-oe.x,e.y-oe.y);t!==r.tree.sheet&&t!==null?(t instanceof a?(Y=U(t,n),Y.children=[]):t instanceof u&&(Y=t),Me=!0):Me=!1}function Zn(e){if(Me){const t=new c(e.x-oe.x,e.y-oe.y);if(Y instanceof a){const n=U(Y,t);d(r.tree);const o=r.tree.canInsert(n)?y():h();H(n,o)}else if(Y instanceof u){const n=b(Y,t);d(r.tree);const o=r.tree.canInsert(n)?y():h();O(n,o,!0)}}}function Qn(e){if(Me){const t=new c(e.x-oe.x,e.y-oe.y);if(Y instanceof a&&Y.ellipse!==null){const n=U(Y,t);r.tree.canInsert(n)&&r.tree.insert(n)}else if(Y instanceof u){const n=b(Y,t);r.tree.canInsert(n)&&r.tree.insert(n)}d(r.tree)}Me=!1}function _n(){Me=!1,d(r.tree)}let Te,X=null,be;function eo(e){Te=new c(e.x-l.x,e.y-l.y),X=r.tree.getLowestNode(Te),X!==r.tree.sheet&&X!==null?be=!0:be=!1}function to(e){if(be){const t=new c(e.x-Te.x,e.y-Te.y);if(d(r.tree),X instanceof a){const n=ae(r.tree,X,t)?y():h();A(X,n,t)}else if(X instanceof u){const n=b(X,t),o=r.tree.canInsert(n)?y():h();O(n,o,!0)}}}function no(e){if(be){const t=new c(e.x-Te.x,e.y-Te.y);if(X instanceof a)ae(r.tree,X,t)&&ze(X,t);else if(X instanceof u){const n=b(X,t);r.tree.canInsert(n)&&r.tree.insert(n)}}d(r.tree),be=!1}function oo(){be=!1,d(r.tree)}let Ot,P=null,Se;function ro(e){Ot=new c(e.x-l.x,e.y-l.y),P=r.tree.getLowestNode(Ot),P!==null&&(Se=!0,P instanceof u?O(P,h(),!0):H(P,h()))}function io(e){const t=new c(e.x-l.x,e.y-l.y),n=r.tree.getLowestNode(t);P!==null&&P!==n&&(Se=!0,d(r.tree),n===null?(P=null,Se=!1):(P=n,P instanceof u?O(P,h(),!0):H(P,h())))}function so(e){const t=new c(e.x-l.x,e.y-l.y);if(Se){const n=r.tree.getLowestParent(t);if(n!==null&&n.remove(t),P!==r.tree.sheet&&P instanceof a&&P.children.length!==0)for(let o=0;o<P.children.length;o++)r.tree.insert(P.children[o])}d(r.tree),P=null,Se=!1}function lo(){P=null,Se=!1}let Ht,V=null,Pe;function co(e){Ht=new c(e.x-l.x,e.y-l.y),V=r.tree.getLowestNode(Ht),V!==null&&(Pe=!0,Ue(V,h()))}function ao(e){const t=new c(e.x-l.x,e.y-l.y),n=r.tree.getLowestNode(t);V!==null&&V!==r.tree.getLowestNode(t)&&(Pe=!0,d(r.tree),n===null?(V=null,Pe=!1):(V=n,Ue(V,h())))}function uo(e){const t=new c(e.x-l.x,e.y-l.y);if(Pe){const n=r.tree.getLowestParent(t);n!==null?n.remove(t):r.tree.clear(),d(r.tree)}V=null,Pe=!1}function fo(){V=null,Pe=!1,d(r.tree)}let ke,S=null,Ce,He;const ho=document.getElementById("selectionString");function wo(e){He=new m(r.tree.sheet),r.selectForProof.sheet=new m().sheet,ke=new c(e.x-l.x,e.y-l.y),S=r.tree.getLowestNode(ke),sn()}function po(e){Ce&&(d(r.tree),ke=new c(e.x-l.x,e.y-l.y),S=r.tree.getLowestNode(ke),sn())}function yo(){if(Ce&&S!==null){if(S instanceof a&&S.ellipse===null)for(let e=0;e<S.children.length;e++)r.selectForProof.insert(S.children[e]);else r.selectForProof.insert(S);d(r.tree)}S=null,Ce=!1}function go(){S=null,Ce=!1,d(r.tree)}function sn(){const e=new m;let t=!1;if(S!==null){if(Ce=!0,S instanceof u||!S.isEqualTo(He.sheet)){e.insert(S);const n=He.getLowestParent(ke);n!==null&&(n.remove(ke),t=!0),d(He)}else e.sheet=S,gt();S instanceof u?O(S,y(),!0):en(S,y()),t&&He.insert(S)}else Ce=!1;ho.innerHTML=e.toString()}const xo=document.getElementById("showRect");let We,et,ue;function mo(e){We=new c(e.clientX-l.x,e.clientY-l.y),ue=new m(r.getLastProofStep().tree.sheet),et=!1}function Mo(e){const t=new c(e.clientX-l.x,e.clientY-l.y),n=new a(Ze(We,t)),o=new a(ln(n.ellipse));if(w(),!et&&n.ellipse!==null&&o.ellipse!==null){const f=ue.canInsert(n)&&ee(n.ellipse)&&ue.canInsert(o)&&ee(o.ellipse)?y():h();H(n,f),H(o,f),xo.checked&&_t(We,t,f)}}function To(e){const t=new c(e.clientX-l.x,e.clientY-l.y);ue=new m(r.getLastProofStep().tree.sheet);const n=new a(Ze(We,t)),o=new a(ln(n.ellipse)),i=new z(ue,"Double Cut Insertion");!et&&n.ellipse!==null&&o.ellipse!==null&&ue.canInsert(n)&&ee(n.ellipse)&&ue.canInsert(o)&&ee(o.ellipse)&&(i.tree.insert(n),i.tree.insert(o),r.proofHistory.push(i)),w()}function bo(){et=!0,w()}function ln(e){return new Z(e.center,Math.floor(e.radiusX*.8),Math.floor(e.radiusY*.8))}let ce=null,je,Be;function So(e){const t=new c(e.x-l.x,e.y-l.y);Be=new m(r.getLastProofStep().tree.sheet),ce=Be.getLowestNode(t),cn()}function Po(e){const t=new c(e.x-l.x,e.y-l.y);ce=Be.getLowestNode(t),w(),cn()}function ko(e){const t=new z(Be,"Double Cut Deletion"),n=new c(e.x-l.x,e.y-l.y);if(je&&ce instanceof a){const o=t.tree.getLowestParent(n),i=ce.children[0];if(o!==null&&i instanceof a){o.remove(n);for(let f=0;f<i.children.length;f++)t.tree.insert(i.children[f])}r.proofHistory.push(t)}w()}function Co(){je=!1,w()}function Eo(e){return e.children.length===1&&e.children[0]instanceof a&&ce!==Be.sheet}function Lo(e){H(e,h()),e.children[0]instanceof a&&H(e.children[0],h())}function cn(){ce instanceof a&&Eo(ce)?(je=!0,Lo(ce)):je=!1}let p,k,B,E,Ee;function Io(e){B=new m(r.getLastProofStep().tree.sheet);const t=r.selectForProof.sheet.children,n=new c(e.x-l.x,e.y-l.y);if(r.proofHistory.length>0&&t.length===1){Ee=!0,p=t[0];const o=St(e,p),i=B.getLowestNode(n),f=B.getLowestParent(n);if(k=i instanceof u?f:i,o){const x=Ne(p,o);if(k!==null&&!k.containsNode(x))E=!1,A(p,h(),o);else if(k!==null&&k instanceof a&&k.ellipse!==null&&B.getLevel(k)%2===0){if(x instanceof a){E=!0;for(let g=0;g<k.children.length;g++)if(x.containsNode(k.children[g])){E=!1;break}}else E=!0;if(E){let g="";if(p instanceof a)g=ae(B,p,o)?y():h();else if(p instanceof u){const D=Ne(p,o);g=B.canInsert(D)?y():h()}E=g===y(),A(p,g,o)}else A(p,h(),o)}else E=!1,A(p,h(),o)}}else E=!1,Ee=!1,A(p,h(),n)}function Do(e){if(Ee){const t=new c(e.x-l.x,e.y-l.y);w();const n=St(e,p),o=B.getLowestNode(t),i=B.getLowestParent(t);if(k=o instanceof u?i:o,n){const f=Ne(p,n);if(k!==null&&!k.containsNode(f))E=!1,A(p,h(),n);else if(k!==null&&k instanceof a&&k.ellipse!==null&&B.getLevel(k)%2===0){if(f instanceof a){E=!0;for(let x=0;x<k.children.length;x++)if(f.containsNode(k.children[x])){E=!1;break}}else E=!0;if(E){let x="";if(p instanceof a)x=ae(B,p,n)?y():h();else if(p instanceof u){const g=Ne(p,n);x=B.canInsert(g)?y():h()}E=x===y(),A(p,x,n)}else A(p,h(),n)}else E=!1,A(p,h(),n)}}else E=!1}function $o(e){if(Ee&&E){const t=St(e,p);if(t){if(p instanceof a)ze(p,t,B);else if(p instanceof u){const n=Ne(p,t);B.insert(n)}r.proofHistory.push(new z(B,"Insertion"))}}w(),Ee=!1}function vo(){Ee=!1,w()}function St(e,t){if(t instanceof a&&t.ellipse!==null)return new c(e.x-t.ellipse.center.x-l.x,e.y-t.ellipse.center.y-l.y);if(t instanceof u)return new c(e.x-t.origin.x-l.x,e.y-t.origin.y-l.y)}let re=null,Ae,Le;function Oo(e){const t=new c(e.x-l.x,e.y-l.y);Le=new m(r.getLastProofStep().tree.sheet),re=Le.getLowestNode(t),an()}function Ho(e){const t=new c(e.x-l.x,e.y-l.y);re=Le.getLowestNode(t),w(),an()}function No(e){if(Ae){const t=new z(Le,"Erasure"),n=new c(e.x-l.x,e.y-l.y),o=t.tree.getLowestParent(n);o!==null&&o.remove(n),r.proofHistory.push(t),w()}re=null,Ae=!1}function Bo(){re=null,Ae=!1,w()}function an(){re!==Le.sheet&&re!==null&&Le.getLevel(re)%2===0?(Ae=!0,Ue(re,h())):Ae=!1}let st=!0,lt=null,ct=null,Nt=s.none,Bt=s.none;const At=document.getElementById("DrawButtons"),Ft=document.getElementById("ProofButtons");function Ao(){if(st=!st,st){At.style.display="block",Xt.style.display="block",Ft.style.display="none",Yt.style.display="none",r.modeState="Draw",ct=JSON.stringify(r.proofHistory),Bt=r.toolState;let e=null;if(lt!==null&&(e=wt(r.modeState,lt)),e!==null)r.tree.sheet=e.sheet;else throw Error("invalid cached AEG");r.toolState=Nt,d(r.tree)}else{At.style.display="none",Xt.style.display="none",Ft.style.display="block",Yt.style.display="block",r.modeState="Proof",lt=JSON.stringify(r.tree),Nt=r.toolState;let e=null;ct!==null&&(e=wt(r.modeState,ct)),e!==null&&(r.proofHistory=e),r.toolState=Bt,w()}}let Q,N=null,Ie,Pt=new c(1,1);function Fo(e){if(Q=new c(e.x-l.x,e.y-l.y),N=r.tree.getLowestNode(Q),N instanceof a&&N.ellipse!==null){Ie=!0;const t=r.tree.getLowestParent(Q);t!==null&&t.remove(Q);for(let n=0;n<N.children.length;n++)r.tree.insert(N.children[n]);Pt=tn(N,Q),N.children=[]}}function Ro(e){if(Ie){const t=new c((e.x-l.x-Q.x)/2,(e.y-l.y-Q.y)/2);if(N instanceof a){const n=_e(N,t,Pt);if(n.ellipse!==null){d(r.tree);const i=r.tree.canInsert(n)&&ee(n.ellipse)?y():h();H(n,i)}}}}function Xo(e){if(Ie){const t=new c((e.x-l.x-Q.x)/2,(e.y-l.y-Q.y)/2);if(N instanceof a){const n=_e(N,t,Pt);n.ellipse!==null&&(r.tree.canInsert(n)&&ee(n.ellipse)?r.tree.insert(n):r.tree.insert(N))}d(r.tree),Ie=!1}}function Yo(){Ie&&N!==null&&r.tree.insert(N),Ie=!1,d(r.tree)}function De(e,t){return e.canInsert(t)&&un(new m(e.sheet),t)}function un(e,t){return e.insert(t.copy()),e.isEqualTo(new m(r.getLastProofStep().tree.sheet))}let ie,C=null,we,q;function zo(e){if(q=new m(r.getLastProofStep().tree.sheet),ie=new c(e.x-l.x,e.y-l.y),C=q.getLowestNode(ie),C!==q.sheet&&C!==null){const t=q.getLowestParent(ie);if(t!==null&&t.remove(ie),C instanceof a&&C.children.length!==0){for(let n=0;n<C.children.length;n++)q.insert(C.children[n]);C.children=[]}we=!0}else we=!1}function Uo(e){if(we){const t=new c(e.x-ie.x,e.y-ie.y);if(d(q),C instanceof a){const n=U(C,t),o=De(q,n)?y():h();H(n,o)}else if(C instanceof u){const n=b(C,t),o=De(q,n)?y():h();O(n,o,!0)}}}function qo(e){if(we){const t=new z(q,"Single Movement"),n=new c(e.x-ie.x,e.y-ie.y);let o=null;C instanceof a?o=U(C,n):C instanceof u&&(o=b(C,n)),o!==null&&De(q,o)&&(t.tree.insert(o),r.proofHistory.push(t))}w(),we=!1}function Vo(){we&&C!==null&&q.insert(C),we=!1,d(r.getLastProofStep().tree)}let se,F=null,at=null,pe,G;function Go(e){G=new m(r.getLastProofStep().tree.sheet),se=new c(e.x-l.x,e.y-l.y),F=G.getLowestNode(se),F!==G.sheet&&F!==null?(at=G.getLowestParent(se),at!==null&&at.remove(se),pe=!0):pe=!1}function Wo(e){if(pe){const t=new c(e.x-se.x,e.y-se.y);if(d(G),F instanceof a){const n=bt(F,t),o=De(G,n)?y():h();A(F,o,t)}else if(F instanceof u){const n=b(F,t),o=De(G,n)?y():h();O(n,o,!0)}}}function jo(e){if(pe){const t=new z(G,"Multi Movement"),n=new c(e.x-se.x,e.y-se.y);let o=null;F instanceof a?o=bt(F,n):F instanceof u&&(o=b(F,n)),o!==null&&De(G,o)&&(t.tree.insert(o),r.proofHistory.push(t),d(t.tree))}w(),pe=!1}function Jo(){pe&&F!==null&&G.insert(F),pe=!1,d(r.getLastProofStep().tree)}let pt,Je,Fe;function Ko(){Je=new m(r.getLastProofStep().tree.sheet),pt=r.selectForProof.sheet,pt.children.length>0&&r.proofHistory.length===0&&Je.sheet.isEmptySheet()&&(Fe=!0)}function Zo(){Fe=!1,w()}function Qo(){Fe&&(Je.sheet=pt,r.proofHistory.push(new z(Je,"Copied from Draw Mode"))),Fe=!1,w()}function _o(){Fe=!1,w()}let fe,v=null,yt=null,Re,W;function er(e){W=new m(r.getLastProofStep().tree.sheet),fe=new c(e.x-l.x,e.y-l.y),v=W.getLowestNode(fe),yt=W.getLowestParent(fe),Re=v!==W.sheet&&v!==null}function tr(e){if(Re){const t=new c(e.x-fe.x,e.y-fe.y);w();const n=new c(e.x-l.x,e.y-l.y),o=fn(t,n)?y():h();if(v instanceof a)A(v,o,t);else if(v instanceof u){const i=b(v,t);O(i,o,!0)}}}function nr(e){if(Re){const t=new c(e.x-fe.x,e.y-fe.y);if(fn(t,new c(e.x-l.x,e.y-l.y))){if(v instanceof a)ze(v,t,W);else if(v instanceof u){const n=b(v,t);W.insert(n)}r.proofHistory.push(new z(W,"Iteration"))}}w(),Re=!1}function or(){Re=!1,w()}function fn(e,t){return yt!==null&&yt.containsPoint(t)&&(v instanceof a&&ae(W,v,e)&&dn(W.sheet,U(v,e).ellipse)||v instanceof u&&W.canInsert(b(v,e)))}function dn(e,t){for(let n=0;n<e.children.length;n++)if(e.children[n]instanceof a){if(e.children[n].ellipse instanceof Z&&(t.contains(e.children[n].ellipse)||!dn(e.children[n],t)))return!1}else if(e.children[n]instanceof u&&t.contains(e.children[n].calcRect()))return!1;return!0}let _,R=null,$e,kt=new c(1,1),j;function rr(e){if(j=new m(r.getLastProofStep().tree.sheet),_=new c(e.x-l.x,e.y-l.y),R=j.getLowestNode(_),R instanceof a&&R.ellipse!==null){$e=!0;const t=j.getLowestParent(_);t!==null&&t.remove(_);for(let n=0;n<R.children.length;n++)j.insert(R.children[n]);kt=tn(R,_),R.children=[]}}function ir(e){if($e){const t=new c((e.x-l.x-_.x)/2,(e.y-l.y-_.y)/2);if(R instanceof a){const n=_e(R,t,kt);if(n.ellipse!==null){d(j);const o=hn(n)?y():h();H(n,o)}}}}function sr(e){if($e){const t=new c((e.x-l.x-_.x)/2,(e.y-l.y-_.y)/2);if(R instanceof a){const n=_e(R,t,kt);n.ellipse!==null&&hn(n)&&(j.insert(n),r.proofHistory.push(new z(j,"Resize Cut")),w())}w(),$e=!1}}function lr(){$e&&R!==null&&j.insert(R),$e=!1,d(r.getLastProofStep().tree)}function hn(e){return j.canInsert(e)&&ee(e.ellipse)&&un(new m(j.sheet),e)}let I=null,Xe,J;function cr(e){const t=new c(e.x-l.x,e.y-l.y);J=new m(r.getLastProofStep().tree.sheet),I=J.getLowestNode(t),wn()}function ar(e){const t=new c(e.x-l.x,e.y-l.y);I=J.getLowestNode(t),w(),wn()}function ur(e){if(Xe){const t=new c(e.x-l.x,e.y-l.y);if(I!==null&&Ct(J.sheet,J.getLevel(I))){const n=J.getLowestParent(t);n instanceof a&&n.remove(t),r.proofHistory.push(new z(J,"Deiteration"))}}Xe=!1,w()}function wn(){I!==null&&!(I instanceof a&&I.ellipse===null)&&Ct(J.sheet,J.getLevel(I))?(Ue(I,h()),Xe=!0):Xe=!1}function fr(){Xe=!1,I=null,w()}function Ct(e,t){let n=null;for(let o=0;o<e.children.length;o++){if(e.children[o]instanceof a&&I instanceof a&&I.isEqualTo(e.children[o])&&I.ellipse!==e.children[o].ellipse)return!0;if(e.children[o]instanceof u&&I instanceof u&&e.children[o].identifier===I.identifier&&e.children[o].toString()!==I.toString())return!0;e.children[o]instanceof a&&e.children[o].containsNode(I)&&J.getLevel(e.children[o])<t&&(n=e.children[o])}return n!==null?Ct(n,t):!1}const K=document.getElementById("canvas");K.width=window.innerWidth;K.height=window.innerHeight;const pn=K.getContext("2d");if(pn===null)throw Error("2d rendering context not supported");const dr=pn;dr.font="35pt arial";const ut=document.getElementById("cutTools"),Rt=document.getElementById("atomTools"),Xt=document.getElementById("graphString"),Yt=document.getElementById("proofString"),zt=document.getElementById("toProofTools");window.addEventListener("keydown",yr);K.addEventListener("mousedown",gr);K.addEventListener("mousemove",xr);K.addEventListener("mouseup",mr);K.addEventListener("mouseout",Mr);K.addEventListener("mouseenter",Tr);let Et=!1,Lt=!0;window.tree=r.tree;window.treeString=tt(window.tree);window.atomTool=s.atomTool;window.cutTool=s.cutTool;window.dragTool=s.dragTool;window.aegStringify=tt;window.saveMode=yn;window.loadMode=pr;window.moveSingleTool=s.moveSingleTool;window.moveMultiTool=s.moveMultiTool;window.copySingleTool=s.copySingleTool;window.copyMultiTool=s.copyMultiTool;window.deleteSingleTool=s.deleteSingleTool;window.deleteMultiTool=s.deleteMultiTool;window.copyFromDrawTool=s.copyFromDrawTool;window.pasteInProofTool=s.pasteInProofTool;window.doubleCutInsertionTool=s.doubleCutInsertionTool;window.resizeTool=s.resizeTool;window.doubleCutDeletionTool=s.doubleCutDeletionTool;window.insertionTool=s.insertionTool;window.erasureTool=s.erasureTool;window.proofMoveSingleTool=s.proofMoveSingleTool;window.proofMoveMultiTool=s.proofMoveMultiTool;window.proofResizeTool=s.proofResizeTool;window.iterationTool=s.iterationTool;window.deiterationTool=s.deiterationTool;window.setTool=wr;window.setHighlight=hr;window.toggleHandler=Ao;function hr(e,t){const n=document.getElementById(t);switch(e){case"mousedown":n==null||n.classList.remove("no-highlight");break;case"mouseleave":n==null||n.classList.add("no-highlight");break}}const Ut=document.querySelectorAll(".toolButton");Ut.forEach(e=>{e.addEventListener("click",()=>{e.classList.add("toolButtonPressed"),Ut.forEach(t=>{t!==e&&t.classList.remove("toolButtonPressed")})})});function wr(e){switch(r.toolState=e,ut.style.display="none",Rt.style.display="none",zt.style.display="none",r.toolState){case s.atomTool:Rt.style.display="block";break;case s.cutTool:ut.style.display="block";break;case s.copyFromDrawTool:zt.style.display="block";break;case s.doubleCutInsertionTool:ut.style.display="block";break}}function tt(e){return JSON.stringify(e,null,"	")}async function yn(){let e,t;r.modeState==="Draw"?(e="AEG Tree",t=r.tree):(e=r.proofHistory[0].tree.toString()+"→"+r.getLastProofStep().tree.toString(),t=r.proofHistory);try{if("showSaveFilePicker"in window){const n=await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:e,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]});Yn(n,t)}else{const n=document.createElement("a");n.href=tt(t),n.download=e+".json",n.click()}}catch{}}async function pr(){try{const[e]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),t=await e.getFile(),n=new FileReader;n.addEventListener("load",()=>{const o=n.result;if(typeof o=="string"){const i=wt(r.modeState,o);r.modeState==="Draw"?(r.tree=i,d(r.tree)):r.modeState==="Proof"&&(r.proofHistory=i,w())}else console.log("Loading failed because reading the file was unsuccessful")}),n.readAsText(t)}catch{}}function yr(e){if(e.ctrlKey&&e.key==="s")e.preventDefault(),yn();else switch(r.toolState){case s.atomTool:Bn(e);break}}function gr(e){switch(r.toolState){case s.cutTool:In(e);break;case s.atomTool:An(e);break;case s.dragTool:Pn(e);break;case s.moveSingleTool:zn(e);break;case s.moveMultiTool:Gn(e);break;case s.copySingleTool:Kn(e);break;case s.copyMultiTool:eo(e);break;case s.deleteSingleTool:ro(e);break;case s.deleteMultiTool:co(e);break;case s.resizeTool:Fo(e);break;case s.copyFromDrawTool:wo(e);break;case s.pasteInProofTool:Ko();break;case s.doubleCutInsertionTool:mo(e);break;case s.doubleCutDeletionTool:So(e);break;case s.insertionTool:Io(e);break;case s.erasureTool:Oo(e);break;case s.proofMoveSingleTool:zo(e);break;case s.proofMoveMultiTool:Go(e);break;case s.proofResizeTool:rr(e);break;case s.iterationTool:er(e);break;case s.deiterationTool:cr(e);break}Et=!0}function xr(e){if(Et&&Lt)switch(r.toolState){case s.cutTool:Dn(e);break;case s.atomTool:Fn(e);break;case s.dragTool:kn(e);break;case s.moveSingleTool:Un(e);break;case s.moveMultiTool:Wn(e);break;case s.copySingleTool:Zn(e);break;case s.copyMultiTool:to(e);break;case s.deleteSingleTool:io(e);break;case s.deleteMultiTool:ao(e);break;case s.resizeTool:Ro(e);break;case s.copyFromDrawTool:po(e);break;case s.pasteInProofTool:Zo();break;case s.doubleCutInsertionTool:Mo(e);break;case s.doubleCutDeletionTool:Po(e);break;case s.insertionTool:Do(e);break;case s.erasureTool:Ho(e);break;case s.proofMoveSingleTool:Uo(e);break;case s.proofMoveMultiTool:Wo(e);break;case s.proofResizeTool:ir(e);break;case s.iterationTool:tr(e);break;case s.deiterationTool:ar(e);break}}function mr(e){switch(r.toolState){case s.cutTool:$n(e);break;case s.atomTool:Rn(e);break;case s.moveSingleTool:qn(e);break;case s.moveMultiTool:jn(e);break;case s.copySingleTool:Qn(e);break;case s.copyMultiTool:no(e);break;case s.deleteSingleTool:so(e);break;case s.deleteMultiTool:uo(e);break;case s.resizeTool:Xo(e);break;case s.copyFromDrawTool:yo();break;case s.pasteInProofTool:Qo();break;case s.doubleCutInsertionTool:To(e);break;case s.doubleCutDeletionTool:ko(e);break;case s.insertionTool:$o(e);break;case s.erasureTool:No(e);break;case s.proofMoveSingleTool:qo(e);break;case s.proofMoveMultiTool:jo(e);break;case s.proofResizeTool:sr(e);break;case s.iterationTool:nr(e);break;case s.deiterationTool:ur(e);break}Et=!1}function Mr(){switch(r.toolState){case s.cutTool:vn();break;case s.atomTool:Xn();break;case s.dragTool:Cn();break;case s.moveSingleTool:Vn();break;case s.moveMultiTool:Jn();break;case s.copySingleTool:_n();break;case s.copyMultiTool:oo();break;case s.deleteSingleTool:lo();break;case s.deleteMultiTool:fo();break;case s.resizeTool:Yo();break;case s.copyFromDrawTool:go();break;case s.pasteInProofTool:_o();break;case s.doubleCutInsertionTool:bo();break;case s.doubleCutDeletionTool:Co();break;case s.insertionTool:vo();break;case s.erasureTool:Bo();break;case s.proofMoveSingleTool:Vo();break;case s.proofMoveMultiTool:Jo();break;case s.proofResizeTool:lr();break;case s.iterationTool:or();break;case s.deiterationTool:fr();break}Lt=!1}function Tr(){Lt=!0}function br(){K.width=window.innerWidth,K.height=window.innerHeight}window.onresize=br;
