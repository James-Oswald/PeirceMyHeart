/* empty css               */(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const P of u.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&i(P)}).observe(document,{childList:!0,subtree:!0});function n(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerPolicy&&(u.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?u.credentials="include":s.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(s){if(s.ep)return;s.ep=!0;const u=n(s);fetch(s.href,u)}})();class l{constructor(t,n){if(this.x=t,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(t,n){if(!Number.isFinite(t)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=t,this.y=n}distance(t){const n=this.x-t.x,i=this.y-t.y;return Math.sqrt(n*n+i*i)}toString(){return"("+this.x+", "+this.y+")"}}function R(e,t){return Xe(e,t)||T(t,e)}function Xe(e,t){if(e instanceof D)return t instanceof D?Ie(e,t):ke(t,e);if(t instanceof D)return ke(e,t);if(Ie(e.boundingBox,t.boundingBox)||T(t.boundingBox,e.boundingBox)){const n=$e(e);let i;for(let s=0;s<n.length;s++)if(i=Q(t,n[s]),i<=0)return!0;return!1}return!1}function ke(e,t){const n=t.getCorners(),i=K(e,n[0].x,1),s=K(e,n[1].x,1),u=K(e,n[0].x,-1),P=K(e,n[1].x,-1);if(n[0].y<i&&i<n[2].y||n[0].y<u&&u<n[2].y||n[0].y<s&&s<n[2].y||n[0].y<P&&P<n[2].y)return!0;const p=-1/Math.pow(e.radiusX,2),m=2*e.center.x/Math.pow(e.radiusX,2),J=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[0].y-e.center.y)/e.radiusY,2),Ce=-Math.pow(e.center.x,2)/Math.pow(e.radiusX,2)+1-Math.pow((n[2].y-e.center.y)/e.radiusY,2),le=(-m+Math.sqrt(Math.pow(m,2)-4*p*J))/(2*p),ce=(-m-Math.sqrt(Math.pow(m,2)-4*p*J))/(2*p),ae=(-m+Math.sqrt(Math.pow(m,2)-4*p*Ce))/(2*p),ue=(-m-Math.sqrt(Math.pow(m,2)-4*p*Ce))/(2*p);return!isNaN(le)&&n[0].x<le&&le<n[1].x||!isNaN(ce)&&n[0].x<ce&&ce<n[1].x||!isNaN(ae)&&n[0].x<ae&&ae<n[1].x||!isNaN(ue)&&n[0].x<ue&&ue<n[1].x}function T(e,t){if(e instanceof D)if(t instanceof D){const n=t.getCorners();for(let i=0;i<4;i++)if(!he(e,n[i]))return!1;return!0}else{const n=et(t);for(let i=0;i<4;i++)if(!he(e,n[i]))return!1;return!0}else if(t instanceof D){const n=t.getCorners();let i;for(let s=0;s<4;s++)if(i=Q(e,n[s]),!(i<0))return!1;return!0}else{const n=$e(t);let i;for(let s=0;s<n.length;s++)if(i=Q(e,n[s]),!(i<0))return!1;return!0}}function Ie(e,t){const n=e.getCorners(),i=t.getCorners();return(n[0].y<=i[0].y&&n[2].y>=i[0].y||n[0].y<=i[2].y&&n[2].y>=i[2].y||i[0].y<=n[0].y&&i[2].y>=n[0].y||i[0].y<=n[2].y&&i[2].y>=n[2].y)&&(n[0].x<=i[0].x&&n[1].x>=i[0].x||n[0].x<=i[1].x&&n[1].x>=i[1].x||i[0].x<=n[0].x&&i[1].x>=n[0].x||i[0].x<=n[1].x&&i[1].x>=n[1].x)}function he(e,t){const n=e.getCorners();return n[0].x<t.x&&n[1].x>t.x&&n[0].y<t.y&&n[2].y>t.y}function Q(e,t){return Math.pow(t.x-e.center.x,2)/Math.pow(e.radiusX,2)+Math.pow(t.y-e.center.y,2)/Math.pow(e.radiusY,2)-1}function et(e){return[new l(e.center.x,e.center.y-e.radiusY),new l(e.center.x+e.radiusX,e.center.y),new l(e.center.x,e.center.y+e.radiusY),new l(e.center.x-e.radiusX,e.center.y)]}function $e(e){const t=[];let n,i,s=1;for(let u=0;u<360;u++)n=e.center.x+e.radiusX*Math.cos(u*(Math.PI/180)),u>180&&(s=-1),i=K(e,n,s),t[u]=new l(n,i);return t}function K(e,t,n){return e.radiusX===0||e.radiusY===0?e.center.y:n*e.radiusY*Math.sqrt(1-Math.pow((t-e.center.x)/e.radiusX,2))+e.center.y}class D{constructor(t,n,i){if(!Number.isFinite(n)||!Number.isFinite(i))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(i!==void 0&&i<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=t,this.width=n,this.height=i}getCorners(){const t=[this.startVertex];return t.push(new l(this.startVertex.x+this.width,this.startVertex.y)),t.push(new l(this.startVertex.x+this.width,this.startVertex.y+this.height)),t.push(new l(this.startVertex.x,this.startVertex.y+this.height)),t}containsPoint(t){return he(this,t)}overlaps(t){return R(this,t)}contains(t){return T(this,t)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}class f{constructor(t,n,i,s){if(t.length!==1)throw new Error("String of length "+t.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(t))throw new Error(t+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=t,this.internalOrigin=n,this.internalWidth=i,this.internalHeight=s}get width(){return this.internalWidth}set width(t){this.internalWidth=t}get height(){return this.internalHeight}set height(t){this.internalHeight=t}get identifier(){return this.internalIdentifier}set identifier(t){this.internalIdentifier=t}get origin(){return this.internalOrigin}set origin(t){this.internalOrigin=t}containsPoint(t){return this.calcRect().containsPoint(t)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.calcRect().toString()}calcRect(){return new D(new l(this.internalOrigin.x,this.internalOrigin.y-this.internalHeight),this.internalWidth,this.internalHeight)}}class c{constructor(t,n){this.internalEllipse=t,this.internalChildren=n??[]}get ellipse(){return this.internalEllipse}set ellipse(t){this.internalEllipse=t}get children(){return this.internalChildren}set children(t){this.internalChildren=t}set child(t){this.internalChildren.push(t)}getCurrentCut(t){for(let n=0;n<this.internalChildren.length;n++){const i=this.internalChildren[n];if(i instanceof c&&i.containsNode(t))return i.getCurrentCut(t)}return this}containsPoint(t){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(t)}containsNode(t){return this.internalEllipse===null?!0:t instanceof f?T(this.internalEllipse,t.calcRect()):T(this.internalEllipse,t.internalEllipse)}getLowestNode(t){if(!this.containsPoint(t))return null;for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t))return this.internalChildren[n]instanceof f||this.internalChildren[n]instanceof c&&this.internalChildren[n].children.length===0?this.internalChildren[n]:this.internalChildren[n].getLowestNode(t);return this}getLowestParent(t){if(!this.containsPoint(t))throw new Error("This parent "+this.toString+" does not contain the point.");for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(t)){if(this.internalChildren[n]instanceof f||this.internalChildren[n]instanceof c&&this.internalChildren[n].children.length===0)return this;{const i=this.internalChildren[n];for(let s=0;s<i.children.length;s++)if(i.children[s].containsPoint(t))return i.getLowestParent(t);return this}}return null}remove(t){if(!this.containsPoint(t))return!1;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(t)){if(this.children[n]instanceof f||this.children[n]instanceof c&&this.children[n].children.length===0)return this.children.splice(n,1),!0;for(let i=0;i<this.children[n].children.length;i++)if(this.children[n].children[i].containsPoint(t))if(this.children[n].children[i]instanceof f)this.children[n].children.splice(i,1);else return this.children[n].children[i].remove(t);return this.children.splice(n,1),!0}return!1}toString(){let t;return this.internalEllipse===null?t="Sheet of Assertion of the AEG Tree":t="A cut node with boundary box of "+this.internalEllipse.toString(),this.internalChildren.length>0&&(t+=", With nested nodes: "+this.internalChildren.toString()),t}toFormulaString(){let t="";for(const n of this.internalChildren)n instanceof f?t+=n.identifier:n instanceof c&&(t+=n.toFormulaString()),t+=" ";return t=t.slice(0,-1),this.internalEllipse===null?t="["+t+"]":t="("+t+")",t}}class ne{constructor(t){this.internalSheet=t??new c(null)}get sheet(){return this.internalSheet}set sheet(t){this.internalSheet=t}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(t){for(let n=0;n<t.children.length;n++){if(!t.containsNode(t.children[n]))return!1;for(let i=n+1;i<t.children.length;i++)if(this.overlaps(t.children[n],t.children[i]))return!1}for(let n=0;n<t.children.length;n++)if(t.children[n]instanceof c&&!this.verifyAEG(t.children[n]))return!1;return!0}canInsert(t){const n=this.internalSheet.getCurrentCut(t);for(let i=0;i<n.children.length;i++)if(this.intersects(t,n.children[i]))return!1;return!0}insert(t){if(!this.canInsert(t))throw new Error("Insertion failed. "+t+" had a collision.");const n=this.internalSheet.getCurrentCut(t),i=[...n.children];if(n.child=t,t instanceof c)for(let s=i.length-1;s>=0;s--)t.containsNode(i[s])&&(t.child=i[s],n.children.splice(s,1));return!0}getLowestNode(t){return this.internalSheet.getLowestNode(t)}getLowestParent(t){return this.internalSheet.getLowestParent(t)}remove(t){return this.internalSheet.remove(t)}intersects(t,n){const i=t instanceof f?t.calcRect():t.ellipse,s=n instanceof f?n.calcRect():n.ellipse;return Xe(i,s)}overlaps(t,n){let i,s;return t instanceof f?n instanceof f?R(t.calcRect(),n.calcRect()):(i=n.ellipse,R(t.calcRect(),i)):n instanceof f?(i=t.ellipse,R(i,n.calcRect())):(i=t.ellipse,s=n.ellipse,R(i,s))}toString(){return this.internalSheet.toFormulaString()}}class z{constructor(t,n,i){if(this.center=t,this.radiusX=n,this.radiusY=i,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const s=new l(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new D(s,this.radiusX*2,this.radiusY*2)}containsPoint(t){return Q(this,t)<0}overlaps(t){return R(this,t)}contains(t){return T(this,t)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}const tt=document.getElementById("theme-select");function F(e){return getComputedStyle(document.body).getPropertyValue(e)}let Ye=F("--good-placement"),He=F("--bad-placement"),Re=F("--canvas-items");function Fe(){setTimeout(()=>{Ye=F("--good-placement"),He=F("--bad-placement"),Re=F("--canvas-items"),a(r)})}tt.addEventListener("input",()=>{Fe()});window.addEventListener("DOMContentLoaded",()=>{Fe()});function w(){return He}function b(){return Ye}function Te(){return Re}const we=document.getElementById("canvas"),Ne=we.getContext("2d");if(Ne===null)throw Error("2d rendering context not supported");const d=Ne;d.font="35pt arial";const nt=document.getElementById("graphString"),it=document.getElementById("atomBox"),Ve=document.getElementById("atomBoxes");Ve.addEventListener("input",rt);function k(e,t){d.strokeStyle=t;const n=e.ellipse,i=n.center;d.beginPath(),d.ellipse(i.x+o.x,i.y+o.y,n.radiusX,n.radiusY,0,0,2*Math.PI),d.stroke()}function E(e,t,n){d.textBaseline="bottom";const i=d.measureText(e.identifier);d.fillStyle=t,d.strokeStyle=t,d.beginPath(),d.fillText(e.identifier,e.origin.x+o.x,e.origin.y+o.y),(Ve.checked||it.checked&&n)&&d.rect(e.origin.x+o.x,e.origin.y+o.y-i.actualBoundingBoxAscent,e.width,e.height),d.stroke()}function Ue(e,t,n){d.beginPath(),d.strokeStyle=n;const i=e.x-t.x+o.x,s=e.y-t.y+o.y;d.rect(e.x,e.y,-i,-s),d.stroke()}function rt(){a(r)}function a(e){nt.innerHTML=e.toString(),d.clearRect(0,0,we.width,we.height),Ge(e.sheet)}function Ge(e){for(let t=0;e.children.length>t;t++)e.children[t]instanceof f?st(e.children[t]):Ge(e.children[t]);e.ellipse instanceof z&&(d.strokeStyle=Te(),d.beginPath(),d.ellipse(e.ellipse.center.x+o.x,e.ellipse.center.y+o.y,e.ellipse.radiusX,e.ellipse.radiusY,0,0,2*Math.PI),d.stroke())}function st(e){E(e,Te(),!1)}let ye,o=new l(0,0),xe;function ot(e){ye=new l(e.x-o.x,e.y-o.y),xe=!1}function lt(e){xe||(o=new l(e.x-ye.x,e.y-ye.y),a(r))}function ct(){xe=!0,a(r)}const at=document.getElementById("showRect"),ut=document.getElementById("mode");let _,ie;function ft(e){_=new l(e.clientX-o.x,e.clientY-o.y),ie=!1}function dt(e){const t=new c(new z(new l(0,0),0,0)),n=new l(e.clientX-o.x,e.clientY-o.y);if(a(r),t.ellipse=re(_,n),!ie){const s=r.canInsert(t)&&N(t.ellipse)?b():w();k(t,s),at.checked&&Ue(_,n,s)}}function ht(e){const t=new l(e.clientX-o.x,e.clientY-o.y),n=new c(re(_,t));r.canInsert(n)&&!ie&&N(n.ellipse)&&r.insert(n),a(r)}function wt(){ie=!0,a(r)}function re(e,t){const n=new l((t.x-e.x)/2+e.x,(t.y-e.y)/2+e.y),i=e.x-t.x,s=e.y-t.y,u=Math.abs(i),P=Math.abs(s);let p,m;if(ut.value==="circumscribed"){const J=Math.floor(n.distance(t));m=Math.floor(J*(P/u)),p=Math.floor(J*(u/P))}else p=u/2,m=P/2;return new z(n,p,m)}function N(e){return e.radiusX>15&&e.radiusY>15}const yt=document.getElementById("canvas"),We=yt.getContext("2d");if(We===null)throw Error("2d rendering context not supported");const gt=We,je=document.getElementById("atomDisplay");let L,se,$="A";je.innerHTML=$;function xt(e){new RegExp(/^[A-Za-z]$/).test(e.key)&&($=e.key,je.innerHTML=$)}function pt(e){L=gt.measureText($),se=!1;const t=new f($,new l(e.clientX-o.x,e.clientY-o.y),L.width,L.fontBoundingBoxDescent+L.actualBoundingBoxAscent);a(r);const n=r.canInsert(t)?b():w();E(t,n,!0)}function mt(e){const t=new f($,new l(e.clientX-o.x,e.clientY-o.y),L.width,L.fontBoundingBoxDescent+L.actualBoundingBoxAscent);a(r),se||(r.canInsert(t)?E(t,b(),!0):E(t,w(),!0))}function Mt(e){const t=new f($,new l(e.clientX-o.x,e.clientY-o.y),L.width,L.fontBoundingBoxDescent+L.actualBoundingBoxAscent);r.canInsert(t)&&!se&&r.insert(t),a(r)}function bt(){se=!0,a(r)}async function Et(e,t){const n=JSON.stringify(t,null,"	"),i=await e.createWritable();await i.write(n),await i.close()}function qe(e){if(typeof e=="string"){const n=JSON.parse(e).internalSheet.internalChildren,i=new ne,s=[];return n.forEach(u=>{Object.prototype.hasOwnProperty.call(u,"internalEllipse")?s.push(ze(u)):s.push(Je(u))}),i.sheet.children=s,i}return null}function ze(e){const t=new z(new l(e.internalEllipse.center.x,e.internalEllipse.center.y),e.internalEllipse.radiusX,e.internalEllipse.radiusY),n=[];return e.internalChildren.forEach(i=>{"internalEllipse"in i?n.push(ze(i)):n.push(Je(i))}),new c(t,n)}function Je(e){const t=e.internalIdentifier,n=new l(e.internalOrigin.x,e.internalOrigin.y);return new f(t,n,e.internalWidth,e.internalHeight)}function Z(e,t){if(e.ellipse!==null){const n=X(e,t);if(!r.canInsert(n))return!1}for(let n=0;n<e.children.length;n++){if(e.children[n]instanceof c&&e.children[n].ellipse!==null&&!Z(e.children[n],t))return!1;if(e.children[n]instanceof f){let i=e.children[n];if(i=I(i,t),!r.canInsert(i))return!1}}return!0}function pe(e,t,n){if(e instanceof c&&e.ellipse!==null){const i=X(e,n);if(k(i,t),e.children.length!==0)for(let s=0;s<e.children.length;s++)pe(e.children[s],t,n)}else if(e instanceof f){const i=I(e,n);E(i,t,!0)}}function me(e,t){if(e instanceof c&&e.ellipse!==null){const n=X(e,t);if(r.insert(n),e.children.length!==0)for(let i=0;i<e.children.length;i++)me(e.children[i],t)}else if(e instanceof f){const n=I(e,t);r.insert(n)}}function X(e,t){if(e.ellipse!==null)return new c(new z(new l(e.ellipse.center.x+t.x-o.x,e.ellipse.center.y+t.y-o.y),e.ellipse.radiusX,e.ellipse.radiusY));throw new Error("Cannot alter the position of a cut without an ellipse.")}function I(e,t){return new f(e.identifier,new l(e.origin.x+t.x-o.x,e.origin.y+t.y-o.y),e.width,e.height)}let S,h=null,Y;function Ct(e){if(S=new l(e.x-o.x,e.y-o.y),h=r.getLowestNode(S),h!==r.sheet&&h!==null){const t=r.getLowestParent(S);if(t!==null&&t.remove(S),h instanceof c&&h.children.length!==0){for(let n=0;n<h.children.length;n++)r.insert(h.children[n]);h.children=[]}Y=!0}else Y=!1}function kt(e){if(Y){const t=new l(e.x-S.x,e.y-S.y);if(h instanceof c){const n=X(h,t);a(r);const i=r.canInsert(n)?b():w();k(n,i)}else if(h instanceof f){const n=I(h,t);a(r);const i=r.canInsert(n)?b():w();E(n,i,!0)}}}function It(e){if(Y){const t=new l(e.x-S.x,e.y-S.y);if(h instanceof c){const n=X(h,t);r.canInsert(n)?r.insert(n):r.insert(h)}else if(h instanceof f){const n=I(h,t);r.canInsert(n)?r.insert(n):r.insert(h)}a(r)}Y=!1}function Pt(){Y&&h!==null&&r.insert(h),Y=!1,a(r)}let O,g=null,H;function Lt(e){if(O=new l(e.x-o.x,e.y-o.y),g=r.getLowestNode(O),g!==r.sheet&&g!==null){const t=r.getLowestParent(O);t!==null&&t.remove(O),H=!0}else H=!1}function Bt(e){if(H){const t=new l(e.x-O.x,e.y-O.y);if(a(r),g instanceof c){const n=Z(g,t)?b():w();pe(g,n,t)}else if(g instanceof f){const n=I(g,t),i=r.canInsert(n)?b():w();E(n,i,!0)}}}function St(e){if(H){const t=new l(e.x-O.x,e.y-O.y);if(g instanceof c)Z(g,t)?me(g,t):r.insert(g);else if(g instanceof f){const n=I(g,t);r.canInsert(n)?r.insert(n):r.insert(g)}}a(r),H=!1}function Ot(){H&&g!==null&&r.insert(g),H=!1,a(r)}let V,M=null,U;function Dt(e){V=new l(e.x-o.x,e.y-o.y);const t=r.getLowestNode(V);t!==r.sheet&&t!==null?(t instanceof c?(M=X(t,new l(0,0)),M.children=[]):t instanceof f&&(M=t),U=!0):U=!1}function At(e){if(U){const t=new l(e.x-V.x,e.y-V.y);if(M instanceof c){const n=X(M,t);a(r);const i=r.canInsert(n)?b():w();k(n,i)}else if(M instanceof f){const n=I(M,t);a(r);const i=r.canInsert(n)?b():w();E(n,i,!0)}}}function vt(e){if(U){const t=new l(e.x-V.x,e.y-V.y);if(M instanceof c&&M.ellipse!==null){const n=X(M,t);r.canInsert(n)&&r.insert(n)}else if(M instanceof f){const n=I(M,t);r.canInsert(n)&&r.insert(n)}a(r)}U=!1}function Xt(){U=!1,a(r)}let G,x=null,W;function $t(e){G=new l(e.x-o.x,e.y-o.y),x=r.getLowestNode(G),x!==r.sheet&&x!==null?W=!0:W=!1}function Yt(e){if(W){const t=new l(e.x-G.x,e.y-G.y);if(a(r),x instanceof c){const n=Z(x,t)?b():w();pe(x,n,t)}else if(x instanceof f){const n=I(x,t),i=r.canInsert(n)?b():w();E(n,i,!0)}}}function Ht(e){if(W){const t=new l(e.x-G.x,e.y-G.y);if(x instanceof c)Z(x,t)&&me(x,t);else if(x instanceof f){const n=I(x,t);r.canInsert(n)&&r.insert(n)}}a(r),W=!1}function Rt(){W=!1,a(r)}let Pe,y=null,j;function Ft(e){Pe=new l(e.x-o.x,e.y-o.y),y=r.getLowestNode(Pe),y!==r.sheet&&y!==null&&(j=!0,y instanceof f?E(y,w(),!0):k(y,w()))}function Tt(e){const t=new l(e.x-o.x,e.y-o.y),n=r.getLowestNode(t);y!==null&&y!==n&&(j=!0,a(r),n===r.sheet||n===null?(y=null,j=!1):(y=n,y instanceof f?E(y,w(),!0):k(y,w())))}function Nt(e){const t=new l(e.x-o.x,e.y-o.y);if(j){const n=r.getLowestParent(t);if(n!==null&&n.remove(t),y instanceof c&&y.children.length!==0)for(let i=0;i<y.children.length;i++)r.insert(y.children[i])}a(r),y=null,j=!1}function Vt(){y=null,j=!1}let Le,C=null,q;function Ut(e){Le=new l(e.x-o.x,e.y-o.y),C=r.getLowestNode(Le),C!==r.sheet&&C!==null&&(q=!0,Me(C,w()))}function Gt(e){const t=new l(e.x-o.x,e.y-o.y),n=r.getLowestNode(t);C!==null&&C!==r.getLowestNode(t)&&(q=!0,a(r),n===r.sheet||n===null?(C=null,q=!1):(C=n,Me(C,w())))}function Wt(e){const t=new l(e.x-o.x,e.y-o.y);if(q){const n=r.getLowestParent(t);n!==null&&n.remove(t),a(r)}C=null,q=!1}function jt(){C=null,q=!1}function Me(e,t){if(e instanceof f)E(e,t,!0);else if(e instanceof c){k(e,t);for(let n=0;n<e.children.length;n++)Me(e.children[n],t)}}const qt=document.getElementById("showRect");let ee,oe;function zt(e){ee=new l(e.clientX-o.x,e.clientY-o.y),oe=!1}function Jt(e){const t=new l(e.clientX-o.x,e.clientY-o.y),n=new c(re(ee,t)),i=new c(Ke(n.ellipse));if(a(r),!oe&&n.ellipse!==null&&i.ellipse!==null){const u=r.canInsert(n)&&N(n.ellipse)&&r.canInsert(i)&&N(i.ellipse)?b():w();k(n,u),k(i,u),qt.checked&&Ue(ee,t,u)}}function Kt(e){const t=new l(e.clientX-o.x,e.clientY-o.y),n=new c(re(ee,t)),i=new c(Ke(n.ellipse));!oe&&n.ellipse!==null&&i.ellipse!==null&&r.canInsert(n)&&N(n.ellipse)&&r.canInsert(i)&&N(i.ellipse)&&(r.insert(n),r.insert(i)),a(r)}function Zt(){oe=!0,a(r)}function Ke(e){return new z(e.center,Math.floor(e.radiusX*.8),Math.floor(e.radiusY*.8))}let A=null,te;function Qt(e){const t=new l(e.x-o.x,e.y-o.y);A=r.getLowestNode(t),Ze()}function _t(e){const t=new l(e.x-o.x,e.y-o.y);A=r.getLowestNode(t),a(r),Ze()}function en(e){const t=new l(e.x-o.x,e.y-o.y);if(te&&A instanceof c){const n=r.getLowestParent(t),i=A.children[0];if(n!==null&&i instanceof c){n.remove(t);for(let s=0;s<i.children.length;s++)r.insert(i.children[s])}}a(r)}function tn(){te=!1,a(r)}function nn(e){return e.children.length===1&&e.children[0]instanceof c&&A!==r.sheet}function rn(e){k(e,w()),e.children[0]instanceof c&&k(e.children[0],w())}function Ze(){A instanceof c&&nn(A)?(te=!0,rn(A)):te=!1}let fe=!0,Be=null,Se=null;const Oe=document.getElementById("DrawButtons"),De=document.getElementById("ProofButtons");function sn(){if(fe=!fe,fe){Oe.style.display="block",De.style.display="none";const e=qe(Be);if(e!==null)r.sheet=e.sheet;else throw Error("invalid cached AEG");ge(Se)}else Oe.style.display="none",De.style.display="block",Be=JSON.stringify(r),Se=v,r.sheet=new ne().sheet,ge(null);a(r)}const B=document.getElementById("canvas");B.width=window.innerWidth;B.height=window.innerHeight;const Qe=B.getContext("2d");if(Qe===null)throw Error("2d rendering context not supported");const on=Qe;on.font="35pt arial";const de=document.getElementById("cutTools"),Ae=document.getElementById("atomTools");window.addEventListener("keydown",an);B.addEventListener("mousedown",un);B.addEventListener("mousemove",fn);B.addEventListener("mouseup",dn);B.addEventListener("mouseout",hn);B.addEventListener("mouseenter",wn);let v=null,be=!1,Ee=!0,r=new ne;window.atomMode=0;window.cutMode=1;window.dragMode=2;window.saveMode=_e;window.loadMode=cn;window.moveSingleMode=3;window.moveMultiMode=4;window.copySingleMode=5;window.copyMultiMode=6;window.deleteSingleMode=7;window.deleteMultiMode=8;window.doubleCutInsertionTool=9;window.doubleCutDeletionTool=10;window.setMode=ge;window.setHighlight=ln;window.toggleHandler=sn;function ln(e,t){const n=document.getElementById(t);switch(e){case"mousedown":n==null||n.classList.remove("no-highlight");break;case"mouseleave":n==null||n.classList.add("no-highlight");break}}const ve=document.querySelectorAll(".modeButton");ve.forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("modeButtonPressed"),ve.forEach(t=>{t!==e&&t.classList.remove("modeButtonPressed")})})});function ge(e){switch(v=e,de.style.display="none",Ae.style.display="none",v){case 0:Ae.style.display="block";break;case 1:de.style.display="block";break;case 9:de.style.display="block";break}}async function _e(){if("showSaveFilePicker"in window){const e=await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"AEG Tree",startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]});Et(e,r)}else{const e=document.createElement("a");e.href=JSON.stringify(r,null,"	"),e.download="AEGTree.json",e.click()}}async function cn(){const[e]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),t=await e.getFile(),n=new FileReader;n.addEventListener("load",()=>{const i=n.result,s=qe(i);s instanceof ne&&(r=s,a(r))}),n.readAsText(t)}function an(e){if(e.ctrlKey&&e.key==="s")e.preventDefault(),_e();else switch(v){case 0:xt(e);break}}function un(e){switch(v){case 1:ft(e);break;case 0:pt(e);break;case 2:ot(e);break;case 3:Ct(e);break;case 4:Lt(e);break;case 5:Dt(e);break;case 6:$t(e);break;case 7:Ft(e);break;case 8:Ut(e);break;case 9:zt(e);break;case 10:Qt(e);break}be=!0}function fn(e){if(be&&Ee)switch(v){case 1:dt(e);break;case 0:mt(e);break;case 2:lt(e);break;case 3:kt(e);break;case 4:Bt(e);break;case 5:At(e);break;case 6:Yt(e);break;case 7:Tt(e);break;case 8:Gt(e);break;case 9:Jt(e);break;case 10:_t(e);break}}function dn(e){switch(v){case 1:ht(e);break;case 0:Mt(e);break;case 3:It(e);break;case 4:St(e);break;case 5:vt(e);break;case 6:Ht(e);break;case 7:Nt(e);break;case 8:Wt(e);break;case 9:Kt(e);break;case 10:en(e);break}be=!1}function hn(){switch(v){case 1:wt();break;case 0:bt();break;case 2:ct();break;case 3:Pt();break;case 4:Ot();break;case 5:Xt();break;case 6:Rt();break;case 7:Vt();break;case 8:jt();break;case 9:Zt();break;case 10:tn();break}Ee=!1}function wn(){Ee=!0}function yn(){B.width=window.innerWidth,B.height=window.innerHeight}window.onresize=yn;
