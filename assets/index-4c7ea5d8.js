/* empty css               */(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const h of l)if(h.type==="childList")for(const A of h.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&i(A)}).observe(document,{childList:!0,subtree:!0});function n(l){const h={};return l.integrity&&(h.integrity=l.integrity),l.referrerPolicy&&(h.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?h.credentials="include":l.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function i(l){if(l.ep)return;l.ep=!0;const h=n(l);fetch(l.href,h)}})();class o{constructor(e,n){if(this.x=e,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(e,n){if(!Number.isFinite(e)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=e,this.y=n}distance(e){const n=this.x-e.x,i=this.y-e.y;return Math.sqrt(n*n+i*i)}toString(){return"("+this.x+", "+this.y+")"}}function W(t,e){return Se(t,e)||G(e,t)}function Se(t,e){if(t instanceof S)return e instanceof S?ve(t,e):ke(e,t);if(e instanceof S)return ke(t,e);if(ve(t.boundingBox,e.boundingBox)||G(e.boundingBox,t.boundingBox)){const n=we(t);let i;for(let l=0;l<n.length;l++)if(i=se(e,n[l]),i<=0)return!0;return!1}return!1}function ke(t,e){const n=we(t);for(let i=0;i<n.length;i++)if(re(e,n[i]))return!0;return!1}function G(t,e){if(t instanceof S)if(e instanceof S){const n=e.getCorners();for(let i=0;i<4;i++)if(!re(t,n[i]))return!1;return!0}else{const n=st(e);for(let i=0;i<4;i++)if(!re(t,n[i]))return!1;return!0}else if(e instanceof S){const n=e.getCorners();let i;for(let l=0;l<4;l++)if(i=se(t,n[l]),!(i<0))return!1;return!0}else{const n=we(e);let i;for(let l=0;l<n.length;l++)if(i=se(t,n[l]),!(i<0))return!1;return!0}}function ve(t,e){const n=t.getCorners(),i=e.getCorners();return(n[0].y<=i[0].y&&n[2].y>=i[0].y||n[0].y<=i[2].y&&n[2].y>=i[2].y||i[0].y<=n[0].y&&i[2].y>=n[0].y||i[0].y<=n[2].y&&i[2].y>=n[2].y)&&(n[0].x<=i[0].x&&n[1].x>=i[0].x||n[0].x<=i[1].x&&n[1].x>=i[1].x||i[0].x<=n[0].x&&i[1].x>=n[0].x||i[0].x<=n[1].x&&i[1].x>=n[1].x)}function re(t,e){const n=t.getCorners();return n[0].x<e.x&&n[1].x>e.x&&n[0].y<e.y&&n[2].y>e.y}function se(t,e){return Math.pow(e.x-t.center.x,2)/Math.pow(t.radiusX,2)+Math.pow(e.y-t.center.y,2)/Math.pow(t.radiusY,2)-1}function st(t){return[new o(t.center.x,t.center.y-t.radiusY),new o(t.center.x+t.radiusX,t.center.y),new o(t.center.x,t.center.y+t.radiusY),new o(t.center.x-t.radiusX,t.center.y)]}function we(t){const e=[];let n,i,l=1;for(let h=0;h<360;h++)n=t.center.x+t.radiusX*Math.cos(h*(Math.PI/180)),h>180&&(l=-1),i=lt(t,n,l),e[h]=new o(n,i);return e}function lt(t,e,n){return t.radiusX===0||t.radiusY===0?t.center.y:n*t.radiusY*Math.sqrt(1-Math.pow((e-t.center.x)/t.radiusX,2))+t.center.y}class S{constructor(e,n,i){if(!Number.isFinite(n)||!Number.isFinite(i))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(i!==void 0&&i<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=e,this.width=n,this.height=i}getCorners(){const e=[this.startVertex];return e.push(new o(this.startVertex.x+this.width,this.startVertex.y)),e.push(new o(this.startVertex.x+this.width,this.startVertex.y+this.height)),e.push(new o(this.startVertex.x,this.startVertex.y+this.height)),e}containsPoint(e){return re(this,e)}overlaps(e){return W(this,e)}contains(e){return G(this,e)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}class c{constructor(e,n,i,l){if(e.length!==1)throw new Error("String of length "+e.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(e))throw new Error(e+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=e,this.internalOrigin=n,this.internalWidth=i,this.internalHeight=l}get width(){return this.internalWidth}set width(e){this.internalWidth=e}get height(){return this.internalHeight}set height(e){this.internalHeight=e}get identifier(){return this.internalIdentifier}set identifier(e){this.internalIdentifier=e}get origin(){return this.internalOrigin}set origin(e){this.internalOrigin=e}containsPoint(e){return this.calcRect().containsPoint(e)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.calcRect().toString()}calcRect(){return new S(new o(this.internalOrigin.x,this.internalOrigin.y-this.internalHeight),this.internalWidth,this.internalHeight)}}class u{constructor(e,n){this.internalEllipse=e,this.internalChildren=n??[]}get ellipse(){return this.internalEllipse}set ellipse(e){this.internalEllipse=e}get children(){return this.internalChildren}set children(e){this.internalChildren=e}set child(e){this.internalChildren.push(e)}getCurrentCut(e){for(let n=0;n<this.internalChildren.length;n++){const i=this.internalChildren[n];if(i instanceof u&&i.containsNode(e))return i.getCurrentCut(e)}return this}containsPoint(e){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(e)}containsNode(e){return this.internalEllipse===null?!0:e instanceof c?G(this.internalEllipse,e.calcRect()):G(this.internalEllipse,e.internalEllipse)}getLowestNode(e){if(!this.containsPoint(e))return null;for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(e))return this.internalChildren[n]instanceof c||this.internalChildren[n]instanceof u&&this.internalChildren[n].children.length===0?this.internalChildren[n]:this.internalChildren[n].getLowestNode(e);return this}getLowestParent(e){if(!this.containsPoint(e))throw new Error("This parent "+this.toString+" does not contain the point.");for(let n=0;n<this.internalChildren.length;n++)if(this.internalChildren[n].containsPoint(e)){if(this.internalChildren[n]instanceof c||this.internalChildren[n]instanceof u&&this.internalChildren[n].children.length===0)return this;{const i=this.internalChildren[n];for(let l=0;l<i.children.length;l++)if(i.children[l].containsPoint(e))return i.getLowestParent(e);return this}}return null}remove(e){if(!this.containsPoint(e))return!1;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(e)){if(this.children[n]instanceof c||this.children[n]instanceof u&&this.children[n].children.length===0)return this.children.splice(n,1),!0;for(let i=0;i<this.children[n].children.length;i++)if(this.children[n].children[i].containsPoint(e))if(this.children[n].children[i]instanceof c)this.children[n].children.splice(i,1);else return this.children[n].children[i].remove(e);return this.children.splice(n,1),!0}return!1}toString(){let e;return this.internalEllipse===null?e="Sheet of Assertion of the AEG Tree":e="A cut node with boundary box of "+this.internalEllipse.toString(),this.internalChildren.length>0&&(e+=", With nested nodes: "+this.internalChildren.toString()),e}toFormulaString(){let e="";for(const n of this.internalChildren)n instanceof c?e+=n.identifier:n instanceof u&&(e+=n.toFormulaString()),e+=" ";return e=e.slice(0,-1),this.internalEllipse===null?e="["+e+"]":e="("+e+")",e}}class ge{constructor(e){this.internalSheet=e??new u(null)}get sheet(){return this.internalSheet}set sheet(e){this.internalSheet=e}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(e){for(let n=0;n<e.children.length;n++){if(!e.containsNode(e.children[n]))return!1;for(let i=n+1;i<e.children.length;i++)if(this.overlaps(e.children[n],e.children[i]))return!1}for(let n=0;n<e.children.length;n++)if(e.children[n]instanceof u&&!this.verifyAEG(e.children[n]))return!1;return!0}canInsert(e){const n=this.internalSheet.getCurrentCut(e);for(let i=0;i<n.children.length;i++)if(this.intersects(e,n.children[i]))return!1;return!0}insert(e){if(!this.canInsert(e))throw new Error("Insertion failed. "+e+" had a collision.");const n=this.internalSheet.getCurrentCut(e),i=[...n.children];if(n.child=e,e instanceof u)for(let l=i.length-1;l>=0;l--)e.containsNode(i[l])&&(e.child=i[l],n.children.splice(l,1));return!0}getLowestNode(e){return this.internalSheet.getLowestNode(e)}getLowestParent(e){return this.internalSheet.getLowestParent(e)}remove(e){return this.internalSheet.remove(e)}intersects(e,n){const i=e instanceof c?e.calcRect():e.ellipse,l=n instanceof c?n.calcRect():n.ellipse;return Se(i,l)}overlaps(e,n){let i,l;return e instanceof c?n instanceof c?W(e.calcRect(),n.calcRect()):(i=n.ellipse,W(e.calcRect(),i)):n instanceof c?(i=e.ellipse,W(i,n.calcRect())):(i=e.ellipse,l=n.ellipse,W(i,l))}toString(){return this.internalSheet.toFormulaString()}}class ne{constructor(e,n,i){if(this.center=e,this.radiusX=n,this.radiusY=i,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const l=new o(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new S(l,this.radiusX*2,this.radiusY*2)}containsPoint(e){return se(this,e)<0}overlaps(e){return W(this,e)}contains(e){return G(this,e)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}const Q=document.getElementById("canvas"),Oe=Q.getContext("2d");if(Oe===null)throw Error("2d rendering context not supported");const Ae=Oe;let de,s=new o(0,0),ye;function ot(t){de=new o(t.x-s.x,t.y-s.y),ye=!1}function ct(t){ye||(s=new o(t.x-de.x,t.y-de.y),Ae.clearRect(0,0,Q.width,Q.height),a(r.sheet,s))}function at(){ye=!0,Ae.clearRect(0,0,Q.width,Q.height),a(r.sheet,s)}const fe=document.getElementById("canvas"),ut=document.getElementById("theme-select"),De=fe.getContext("2d");if(De===null)throw Error("2d rendering context not supported");const ht=De;function U(t){return getComputedStyle(document.body).getPropertyValue(t)}let He=U("--good-placement"),Xe=U("--bad-placement"),Fe=U("--canvas-items");function Ye(){setTimeout(()=>{He=U("--good-placement"),Xe=U("--bad-placement"),Fe=U("--canvas-items"),ht.clearRect(0,0,fe.width,fe.height),a(r.sheet,s)})}ut.addEventListener("input",()=>{Ye()});window.addEventListener("DOMContentLoaded",()=>{Ye()});function g(){return Xe}function C(){return He}function Te(){return Fe}const D=document.getElementById("canvas"),Ve=D.getContext("2d"),dt=document.getElementById("showRect"),ft=document.getElementById("mode");if(Ve===null)throw Error("2d rendering context not supported");const v=Ve;let xe,ce;function wt(t){xe=new o(t.clientX-s.x,t.clientY-s.y),ce=!1}function gt(t){const e=new u(new ne(new o(0,0),0,0)),n=new o(t.clientX-s.x,t.clientY-s.y);v.clearRect(0,0,D.width,D.height),a(r.sheet,s),e.ellipse=We(xe,n),ce||(r.canInsert(e)&&je(e.ellipse)?P(e,C()):P(e,g()))}function yt(t){const e=new o(t.clientX-s.x,t.clientY-s.y),n=new u(We(xe,e));r.canInsert(n)&&!ce&&je(n.ellipse)&&r.insert(n),v.clearRect(0,0,D.width,D.height),a(r.sheet,s)}function xt(){ce=!0,v.clearRect(0,0,D.width,D.height),a(r.sheet,s)}function We(t,e){const n=new o((e.x-t.x)/2+t.x,(e.y-t.y)/2+t.y),i=t.x-e.x,l=t.y-e.y,h=Math.abs(i),A=Math.abs(l);let ue,he;if(ft.value==="circumscribed"){const Ie=Math.floor(n.distance(e));he=Math.floor(Ie*(A/h)),ue=Math.floor(Ie*(h/A))}else ue=h/2,he=A/2;return dt.checked&&(v.beginPath(),v.rect(t.x+s.x,t.y+s.y,-i,-l),v.stroke()),new ne(n,ue,he)}function P(t,e){v.strokeStyle=e;const n=t.ellipse,i=n.center;v.beginPath(),v.ellipse(i.x+s.x,i.y+s.y,n.radiusX,n.radiusY,0,0,2*Math.PI),v.stroke()}function je(t){return t.radiusX>15&&t.radiusY>15}const I=document.getElementById("canvas"),Ue=I.getContext("2d");if(Ue===null)throw Error("2d rendering context not supported");const x=Ue,Ge=document.getElementById("atomDisplay"),pt=document.getElementById("atomBox"),ze=document.getElementById("atomBoxes");ze.addEventListener("input",It);let E,ae,H="A";Ge.innerHTML=H;function mt(t){new RegExp(/^[A-Za-z]$/).test(t.key)&&(H=t.key,Ge.innerHTML=H)}function Et(t){E=x.measureText(H),ae=!1;const e=new c(H,new o(t.clientX-s.x,t.clientY-s.y),E.width,E.fontBoundingBoxDescent+E.actualBoundingBoxAscent);x.clearRect(0,0,I.width,I.height),a(r.sheet,s),r.canInsert(e)?y(e,C(),!0):y(e,g(),!0)}function Mt(t){const e=new c(H,new o(t.clientX-s.x,t.clientY-s.y),E.width,E.fontBoundingBoxDescent+E.actualBoundingBoxAscent);x.clearRect(0,0,I.width,I.height),a(r.sheet,s),ae||(r.canInsert(e)?y(e,C(),!0):y(e,g(),!0))}function bt(t){const e=new c(H,new o(t.clientX-s.x,t.clientY-s.y),E.width,E.fontBoundingBoxDescent+E.actualBoundingBoxAscent);r.canInsert(e)&&!ae&&r.insert(e),x.clearRect(0,0,I.width,I.height),a(r.sheet,s)}function Ct(){ae=!0,x.clearRect(0,0,I.width,I.height),a(r.sheet,s)}function y(t,e,n){x.textBaseline="bottom",E=x.measureText(t.identifier),x.fillStyle=e,x.strokeStyle=e,x.beginPath(),x.fillText(t.identifier,t.origin.x+s.x,t.origin.y+s.y),(ze.checked||pt.checked&&n)&&x.rect(t.origin.x+s.x,t.origin.y+s.y-E.actualBoundingBoxAscent,t.width,t.height),x.stroke()}function It(){x.clearRect(0,0,I.width,I.height),a(r.sheet,s)}async function kt(t,e){const n=JSON.stringify(e,null,"	"),i=await t.createWritable();await i.write(n),await i.close()}function vt(t){if(typeof t=="string"){const n=JSON.parse(t).internalSheet.internalChildren,i=new ge,l=[];return n.forEach(h=>{Object.prototype.hasOwnProperty.call(h,"internalEllipse")?l.push(Ne(h)):l.push(Je(h))}),i.sheet.children=l,i}return null}function Ne(t){const e=new ne(new o(t.internalEllipse.center.x,t.internalEllipse.center.y),t.internalEllipse.radiusX,t.internalEllipse.radiusY),n=[];return t.internalChildren.forEach(i=>{"internalEllipse"in i?n.push(Ne(i)):n.push(Je(i))}),new u(e,n)}function Je(t){const e=t.internalIdentifier,n=new o(t.internalOrigin.x,t.internalOrigin.y);return new c(e,n,t.internalWidth,t.internalHeight)}function ie(t,e){if(t.ellipse!==null){const n=O(t,e);if(!r.canInsert(n))return!1}for(let n=0;n<t.children.length;n++){if(t.children[n]instanceof u&&t.children[n].ellipse!==null&&!ie(t.children[n],e))return!1;if(t.children[n]instanceof c){let i=t.children[n];if(i=k(i,e),!r.canInsert(i))return!1}}return!0}function _(t,e,n){if(t instanceof u&&t.ellipse!==null){const i=O(t,n);if(P(i,e),t.children.length!==0)for(let l=0;l<t.children.length;l++)_(t.children[l],e,n)}else if(t instanceof c){const i=k(t,n);y(i,e,!0)}}function pe(t,e){if(t instanceof u&&t.ellipse!==null){const n=O(t,e);if(r.insert(n),t.children.length!==0)for(let i=0;i<t.children.length;i++)pe(t.children[i],e)}else if(t instanceof c){const n=k(t,e);r.insert(n)}}function O(t,e){if(t.ellipse!==null)return new u(new ne(new o(t.ellipse.center.x+e.x-s.x,t.ellipse.center.y+e.y-s.y),t.ellipse.radiusX,t.ellipse.radiusY));throw new Error("Cannot alter the position of a cut without an ellipse.")}function k(t,e){return new c(t.identifier,new o(t.origin.x+e.x-s.x,t.origin.y+e.y-s.y),t.width,t.height)}const B=document.getElementById("canvas"),qe=B.getContext("2d");if(qe===null)throw Error("2d rendering context not supported");const le=qe;let $,d=null,X;function Pt(t){if($=new o(t.x-s.x,t.y-s.y),d=r.getLowestNode($),d!==r.sheet&&d!==null){const e=r.getLowestParent($);if(e!==null&&e.remove($),d instanceof u&&d.children.length!==0){for(let n=0;n<d.children.length;n++)r.insert(d.children[n]);d.children=[]}X=!0}else X=!1}function Bt(t){if(X){const e=new o(t.x-$.x,t.y-$.y);if(d instanceof u){const n=O(d,e);le.clearRect(0,0,B.width,B.height),a(r.sheet,s),r.canInsert(n)?P(n,C()):P(n,g())}else if(d instanceof c){const n=k(d,e);le.clearRect(0,0,B.width,B.height),a(r.sheet,s),r.canInsert(n)?y(n,C(),!0):y(n,g(),!0)}}}function Rt(t){if(X){const e=new o(t.x-$.x,t.y-$.y);if(d instanceof u){const n=O(d,e);r.canInsert(n)?r.insert(n):r.insert(d)}else if(d instanceof c){const n=k(d,e);r.canInsert(n)?r.insert(n):r.insert(d)}le.clearRect(0,0,B.width,B.height),a(r.sheet,s)}X=!1}function $t(){X&&d!==null&&r.insert(d),X=!1,le.clearRect(0,0,B.width,B.height),a(r.sheet,s)}const F=document.getElementById("canvas"),Ke=F.getContext("2d");if(Ke===null)throw Error("2d rendering context not supported");const me=Ke;let L,w=null,Y;function Lt(t){if(L=new o(t.x-s.x,t.y-s.y),w=r.getLowestNode(L),w!==r.sheet&&w!==null){const e=r.getLowestParent(L);e!==null&&e.remove(L),Y=!0}else Y=!1}function St(t){if(Y){const e=new o(t.x-L.x,t.y-L.y);if(me.clearRect(0,0,F.width,F.height),a(r.sheet,s),w instanceof u)ie(w,e)?_(w,C(),e):_(w,g(),e);else if(w instanceof c){const n=k(w,e);r.canInsert(n)?y(n,C(),!0):y(n,g(),!0)}}}function Ot(t){if(Y){const e=new o(t.x-L.x,t.y-L.y);if(w instanceof u)ie(w,e)?pe(w,e):r.insert(w);else if(w instanceof c){const n=k(w,e);r.canInsert(n)?r.insert(n):r.insert(w)}}me.clearRect(0,0,F.width,F.height),a(r.sheet,s),Y=!1}function At(){Y&&w!==null&&r.insert(w),Y=!1,me.clearRect(0,0,F.width,F.height),a(r.sheet,s)}const R=document.getElementById("canvas"),Ze=R.getContext("2d");if(Ze===null)throw Error("2d rendering context not supported");const oe=Ze;let z,m=null,N;function Dt(t){z=new o(t.x-s.x,t.y-s.y);const e=r.getLowestNode(z);e!==r.sheet&&e!==null?(e instanceof u?(m=O(e,new o(0,0)),m.children=[]):e instanceof c&&(m=e),N=!0):N=!1}function Ht(t){if(N){const e=new o(t.x-z.x,t.y-z.y);if(m instanceof u){const n=O(m,e);oe.clearRect(0,0,R.width,R.height),a(r.sheet,s),r.canInsert(n)?P(n,C()):P(n,g())}else if(m instanceof c){const n=k(m,e);oe.clearRect(0,0,R.width,R.height),a(r.sheet,s),r.canInsert(n)?y(n,C(),!0):y(n,g(),!0)}}}function Xt(t){if(N){const e=new o(t.x-z.x,t.y-z.y);if(m instanceof u&&m.ellipse!==null){const n=O(m,e);r.canInsert(n)&&r.insert(n)}else if(m instanceof c){const n=k(m,e);r.canInsert(n)&&r.insert(n)}oe.clearRect(0,0,R.width,R.height),a(r.sheet,s)}N=!1}function Ft(){N=!1,oe.clearRect(0,0,R.width,R.height),a(r.sheet,s)}const T=document.getElementById("canvas"),Qe=T.getContext("2d");if(Qe===null)throw Error("2d rendering context not supported");const Ee=Qe;let J,p=null,q;function Yt(t){J=new o(t.x-s.x,t.y-s.y),p=r.getLowestNode(J),p!==r.sheet&&p!==null?q=!0:q=!1}function Tt(t){if(q){const e=new o(t.x-J.x,t.y-J.y);if(Ee.clearRect(0,0,T.width,T.height),a(r.sheet,s),p instanceof u)ie(p,e)?_(p,C(),e):_(p,g(),e);else if(p instanceof c){const n=k(p,e);r.canInsert(n)?y(n,C(),!0):y(n,g(),!0)}}}function Vt(t){if(q){const e=new o(t.x-J.x,t.y-J.y);if(p instanceof u)ie(p,e)&&pe(p,e);else if(p instanceof c){const n=k(p,e);r.canInsert(n)&&r.insert(n)}}Ee.clearRect(0,0,T.width,T.height),a(r.sheet,s),q=!1}function Wt(){q=!1,Ee.clearRect(0,0,T.width,T.height),a(r.sheet,s)}const ee=document.getElementById("canvas"),_e=ee.getContext("2d");if(_e===null)throw Error("2d rendering context not supported.");const et=_e;let Pe,f=null,K;function jt(t){Pe=new o(t.x-s.x,t.y-s.y),f=r.getLowestNode(Pe),f!==r.sheet&&f!==null&&(K=!0,f instanceof c?y(f,g(),!0):P(f,g()))}function Ut(t){const e=new o(t.x-s.x,t.y-s.x),n=r.getLowestNode(e);f!==null&&f!==n&&(K=!0,et.clearRect(0,0,ee.width,ee.height),a(r.sheet,s),n===r.sheet||n===null?(f=null,K=!1):(f=n,f instanceof c?y(f,g(),!0):P(f,g())))}function Gt(t){const e=new o(t.x-s.x,t.y-s.x);if(K){const n=r.getLowestParent(e);if(n!==null&&n.remove(e),f instanceof u&&f.children.length!==0)for(let i=0;i<f.children.length;i++)r.insert(f.children[i])}et.clearRect(0,0,ee.width,ee.height),a(r.sheet,s),f=null,K=!1}function zt(){f=null,K=!1}const te=document.getElementById("canvas"),tt=te.getContext("2d");if(tt===null)throw Error("2d rendering context not supported.");const nt=tt;let Be,b=null,Z;function Nt(t){Be=new o(t.x,t.y),b=r.getLowestNode(Be),b!==r.sheet&&b!==null&&(Z=!0,Me(b,g()))}function Jt(t){const e=new o(t.x-s.x,t.y-s.x),n=r.getLowestNode(e);b!==null&&b!==r.getLowestNode(e)&&(Z=!0,nt.clearRect(0,0,te.width,te.height),a(r.sheet,s),n===r.sheet||n===null?(b=null,Z=!1):(b=n,Me(b,g())))}function qt(t){const e=new o(t.x-s.x,t.y-s.x);if(Z){const n=r.getLowestParent(e);n!==null&&n.remove(e),nt.clearRect(0,0,te.width,te.height),a(r.sheet,s)}b=null,Z=!1}function Kt(){b=null,Z=!1}function Me(t,e){if(t instanceof c)y(t,e,!0);else if(t instanceof u){P(t,e);for(let n=0;n<t.children.length;n++)Me(t.children[n],e)}}const M=document.getElementById("canvas");M.width=window.innerWidth;M.height=window.innerHeight;const it=M.getContext("2d");if(it===null)throw Error("2d rendering context not supported");const j=it;j.font="35pt arial";const Zt=document.getElementById("graphString"),Re=document.getElementById("cutTools"),$e=document.getElementById("atomTools");window.addEventListener("keydown",tn);M.addEventListener("mousedown",nn);M.addEventListener("mousemove",rn);M.addEventListener("mouseup",sn);M.addEventListener("mouseout",ln);M.addEventListener("mouseenter",on);let V,be=!1,Ce=!0,r=new ge;window.atomMode=0;window.cutMode=1;window.dragMode=2;window.saveMode=rt;window.loadMode=en;window.moveSingleMode=3;window.moveMultiMode=4;window.copySingleMode=5;window.copyMultiMode=6;window.deleteSingleMode=7;window.deleteMultiMode=8;window.setMode=_t;window.setHighlight=Qt;function Qt(t,e){const n=document.getElementById(e);switch(t){case"mousedown":n==null||n.classList.remove("no-highlight");break;case"mouseleave":n==null||n.classList.add("no-highlight");break}}const Le=document.querySelectorAll(".modeButton");Le.forEach(t=>{t.addEventListener("click",()=>{t.classList.toggle("modeButtonPressed"),Le.forEach(e=>{e!==t&&e.classList.remove("modeButtonPressed")})})});function _t(t){switch(V=t,Re.style.display="none",$e.style.display="none",V){case 0:$e.style.display="block";break;case 1:Re.style.display="block";break}}async function rt(){if("showSaveFilePicker"in window){const t=await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"AEG Tree",startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]});kt(t,r)}else{const t=document.createElement("a");t.href=JSON.stringify(r,null,"	"),t.download="AEGTree.json",t.click()}}async function en(){const[t]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),e=await t.getFile(),n=new FileReader;n.addEventListener("load",()=>{const i=n.result,l=vt(i);l instanceof ge&&(r=l,j.clearRect(0,0,M.width,M.height),a(r.sheet,s))}),n.readAsText(e)}function tn(t){if(t.ctrlKey&&t.key==="s")t.preventDefault(),rt();else switch(V){case 0:mt(t);break}}function nn(t){switch(V){case 1:wt(t);break;case 0:Et(t);break;case 2:ot(t);break;case 3:Pt(t);break;case 4:Lt(t);break;case 5:Dt(t);break;case 6:Yt(t);break;case 7:jt(t);break;case 8:Nt(t);break}be=!0}function rn(t){if(be&&Ce)switch(V){case 1:gt(t);break;case 0:Mt(t);break;case 2:ct(t);break;case 3:Bt(t);break;case 4:St(t);break;case 5:Ht(t);break;case 6:Tt(t);break;case 7:Ut(t);break;case 8:Jt(t);break}}function sn(t){switch(V){case 1:yt(t);break;case 0:bt(t);break;case 3:Rt(t);break;case 4:Ot(t);break;case 5:Xt(t);break;case 6:Vt(t);break;case 7:Gt(t);break;case 8:qt(t);break}be=!1}function ln(){switch(V){case 1:xt();break;case 0:Ct();break;case 2:at();break;case 3:$t();break;case 4:At();break;case 5:Ft();break;case 6:Wt();break;case 7:zt();break;case 8:Kt();break}Ce=!1}function on(){Ce=!0}function a(t,e){Zt.innerHTML=r.toString();for(let n=0;t.children.length>n;n++)t.children[n]instanceof c?cn(t.children[n]):a(t.children[n],e);t.ellipse instanceof ne&&(j.strokeStyle=Te(),j.beginPath(),j.ellipse(t.ellipse.center.x+e.x,t.ellipse.center.y+e.y,t.ellipse.radiusX,t.ellipse.radiusY,0,0,2*Math.PI),j.stroke())}function cn(t){y(t,Te(),!1)}function an(){M.width=window.innerWidth,M.height=window.innerHeight}window.onresize=an;
