(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();class h{constructor(e,n,r){if(e.length!==1)throw new Error("String of length "+e.length+" passed in as identifier in AtomNode constructor, which is not of length 1.");if(!/^[A-Za-z]$/.test(e))throw new Error(e+" not contained in Latin alphabet passed in as identifier in AtomNode constructor.");this.internalIdentifier=e,this.internalOrigin=n,this.internalRectangle=r}get rectangle(){return this.internalRectangle}set rectangle(e){this.internalRectangle=e}get identifier(){return this.internalIdentifier}set identifier(e){this.internalIdentifier=e}get origin(){return this.internalOrigin}set origin(e){this.internalOrigin=e}containsPoint(e){return this.internalRectangle.containsPoint(e)}toString(){return"An atom representing the proposition: "+this.internalIdentifier+" and Boundary box of: "+this.internalRectangle.toString()}}class o{constructor(e,n){if(this.x=e,this.y=n,!Number.isFinite(this.x)||!Number.isFinite(this.y))throw new Error("NaN or Infinity value(s) were passed in constructing a Point.")}set(e,n){if(!Number.isFinite(e)||!Number.isFinite(n))throw new Error("NaN or Infinity value(s) were passed in setting "+this+"'s coords.");this.x=e,this.y=n}distance(e){const n=this.x-e.x,r=this.y-e.y;return Math.sqrt(n*n+r*r)}toString(){return"("+this.x+", "+this.y+")"}}class d{constructor(e,n,r){if(!Number.isFinite(n)||!Number.isFinite(r))throw new Error("Infinity/NaN passed in for width/height while constructing a Rectangle.");if(n!==void 0&&n<0)throw new Error("Negative value passed for width while constructing a Rectangle.");if(r!==void 0&&r<0)throw new Error("Negative value passed for height while constructing a Rectangle.");this.startVertex=e,this.width=n,this.height=r}getCorners(){const e=[this.startVertex];return e.push(new o(this.startVertex.x+this.width,this.startVertex.y)),e.push(new o(this.startVertex.x+this.width,this.startVertex.y+this.height)),e.push(new o(this.startVertex.x,this.startVertex.y+this.height)),e}containsPoint(e){return F(this,e)}overlaps(e){return v(this,e)}contains(e){return C(this,e)}toString(){return"Rectangle with top left vertex at: "+this.startVertex.toString()+", w: "+this.width+", h: "+this.height}}function v(t,e){return q(t,e)||C(e,t)}function q(t,e){if(t instanceof d)return e instanceof d?J(t,e):z(e,t);if(e instanceof d)return z(t,e);if(J(t.boundingBox,e.boundingBox)||C(e.boundingBox,t.boundingBox)){const n=Y(t);let r;for(let i=0;i<n.length;i++)if(r=P(e,n[i]),r<=0)return!0;return!1}return!1}function z(t,e){const n=Y(t);for(let r=0;r<n.length;r++)if(F(e,n[r]))return!0;return!1}function C(t,e){if(t instanceof d)if(e instanceof d){const n=e.getCorners();for(let r=0;r<4;r++)if(!F(t,n[r]))return!1;return!0}else{const n=ie(e);for(let r=0;r<4;r++)if(!F(t,n[r]))return!1;return!0}else if(e instanceof d){const n=e.getCorners();let r;for(let i=0;i<4;i++)if(r=P(t,n[i]),!(r<0))return!1;return!0}else{const n=Y(e);let r;for(let i=0;i<n.length;i++)if(r=P(t,n[i]),!(r<0))return!1;return!0}}function J(t,e){const n=t.getCorners(),r=e.getCorners();return(n[0].y<=r[0].y&&n[2].y>=r[0].y||n[0].y<=r[2].y&&n[2].y>=r[2].y||r[0].y<=n[0].y&&r[2].y>=n[0].y||r[0].y<=n[2].y&&r[2].y>=n[2].y)&&(n[0].x<=r[0].x&&n[1].x>=r[0].x||n[0].x<=r[1].x&&n[1].x>=r[1].x||r[0].x<=n[0].x&&r[1].x>=n[0].x||r[0].x<=n[1].x&&r[1].x>=n[1].x)}function F(t,e){const n=t.getCorners();return n[0].x<e.x&&n[1].x>e.x&&n[0].y<e.y&&n[2].y>e.y}function P(t,e){return Math.pow(e.x-t.center.x,2)/Math.pow(t.radiusX,2)+Math.pow(e.y-t.center.y,2)/Math.pow(t.radiusY,2)-1}function ie(t){return[new o(t.center.x,t.center.y-t.radiusY),new o(t.center.x+t.radiusX,t.center.y),new o(t.center.x,t.center.y+t.radiusY),new o(t.center.x-t.radiusX,t.center.y)]}function Y(t){const e=[];let n,r,i=1;for(let l=0;l<360;l++)n=t.center.x+t.radiusX*Math.cos(l*(Math.PI/180)),l>180&&(i=-1),r=se(t,n,i),e[l]=new o(n,r);return e}function se(t,e,n){return t.radiusX===0||t.radiusY===0?t.center.y:n*t.radiusY*Math.sqrt(1-Math.pow((e-t.center.x)/t.radiusX,2))+t.center.y}class y{constructor(e,n){this.internalEllipse=e,this.internalChildren=n??[]}get ellipse(){return this.internalEllipse}set ellipse(e){this.internalEllipse=e}get children(){return this.internalChildren}set children(e){this.internalChildren=e}set child(e){this.internalChildren.push(e)}getCurrentCut(e){for(let n=0;n<this.internalChildren.length;n++){const r=this.internalChildren[n];if(r instanceof y&&r.containsNode(e))return r.getCurrentCut(e)}return this}containsPoint(e){return this.internalEllipse===null?!0:this.internalEllipse.containsPoint(e)}containsNode(e){return this.internalEllipse===null?!0:e instanceof h?C(this.internalEllipse,e.rectangle):C(this.internalEllipse,e.internalEllipse)}remove(e){if(this.containsPoint(e)){let n=!0;for(let r=0;r<this.internalChildren.length;r++)if(this.internalChildren[r].containsPoint(e))return n=!1,this.internalChildren[r]instanceof y?this.internalChildren[r].remove(e):(this.internalChildren=this.internalChildren.splice(r,1),!0);if(n)return!0}return!1}toString(){let e;return this.internalEllipse===null?e="Sheet of Assertion of the AEG Tree":e=`A cut node with boundary box of 
`+this.internalEllipse.toString(),this.internalChildren.length>0&&(e+=`, 
With nested nodes: `+this.internalChildren.toString()),e}toFormulaString(){let e="";for(const n of this.internalChildren)n instanceof h?e+=n.identifier:n instanceof y&&(e+=n.toFormulaString()),e+=" ";return e=e.slice(0,-1),this.internalEllipse===null?e="["+e+"]":e="("+e+")",e}}class V{constructor(e){this.internalSheet=e??new y(null)}get sheet(){return this.internalSheet}set sheet(e){this.internalSheet=e}verify(){return this.verifyAEG(this.internalSheet)}verifyAEG(e){for(let n=0;n<e.children.length;n++){if(!e.containsNode(e.children[n]))return!1;for(let r=n+1;r<e.children.length;r++)if(this.overlaps(e.children[n],e.children[r]))return!1}for(let n=0;n<e.children.length;n++)if(e.children[n]instanceof y&&!this.verifyAEG(e.children[n]))return!1;return!0}canInsert(e){const n=this.internalSheet.getCurrentCut(e);for(let r=0;r<n.children.length;r++)if(this.intersects(e,n.children[r]))return!1;return!0}insert(e){if(!this.canInsert(e))throw new Error("Insertion failed. "+e+" had a collision.");const n=this.internalSheet.getCurrentCut(e),r=[...n.children];if(n.child=e,e instanceof y)for(let i=r.length-1;i>=0;i--)e.containsNode(r[i])&&(e.child=r[i],n.children.splice(i,1))}remove(e){this.internalSheet.remove(e)}intersects(e,n){const r=e instanceof h?e.rectangle:e.ellipse,i=n instanceof h?n.rectangle:n.ellipse;return q(r,i)}overlaps(e,n){let r,i;return e instanceof h?n instanceof h?v(e.rectangle,n.rectangle):(r=n.ellipse,v(e.rectangle,r)):n instanceof h?(r=e.ellipse,v(r,n.rectangle)):(r=e.ellipse,i=n.ellipse,v(r,i))}toString(){return this.internalSheet.toFormulaString()}}class A{constructor(e,n,r){if(this.center=e,this.radiusX=n,this.radiusY=r,!Number.isFinite(this.radiusX)||!Number.isFinite(this.radiusY))throw new Error("A radius passed into an Ellipse construction was NaN or Infinity.");if(this.radiusX!==void 0&&this.radiusX<0)throw new Error("Horizontal radius in an Ellipse construction was negative.");if(this.radiusY!==void 0&&this.radiusY<0)throw new Error("Vertical radius in an Ellipse construction was negative.");const i=new o(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new d(i,this.radiusX*2,this.radiusY*2)}containsPoint(e){return P(this,e)<0}overlaps(e){return v(this,e)}contains(e){return C(this,e)}toString(){return"An ellipse with Center at: "+this.center.toString()+", Horizontal radius: "+this.radiusX+", Vertical radius: "+this.radiusY+", Bounding box: "+this.boundingBox.toString()}}const I=document.getElementById("canvas"),U=I.getContext("2d");if(U===null)throw Error("2d rendering context not supported");const K=U;let S,s=new o(0,0),L;function oe(t){S=new o(t.x-s.x,t.y-s.y),L=!1}function le(t){L||(s=new o(t.x-S.x,t.y-S.y),K.clearRect(0,0,I.width,I.height),w(c.sheet,s))}function ae(){L=!0,K.clearRect(0,0,I.width,I.height),w(c.sheet,s)}const M=document.getElementById("canvas"),Z=M.getContext("2d"),ce=document.getElementById("showRect"),ue=document.getElementById("mode");if(Z===null)throw Error("2d rendering context not supported");const g=Z;let H,B;function he(t){H=new o(t.clientX-s.x,t.clientY-s.y),B=!1}function de(t){const e=new y(new A(new o(0,0),0,0)),n=new o(t.clientX-s.x,t.clientY-s.y);g.clearRect(0,0,M.width,M.height),w(c.sheet,s),e.ellipse=Q(H,n),B||(c.canInsert(e)&&N(e.ellipse)?W(e,"#00FF00"):W(e,"#FF0000"))}function fe(t){const e=new o(t.clientX-s.x,t.clientY-s.y),n=new y(Q(H,e));c.canInsert(n)&&!B&&N(n.ellipse)&&c.insert(n),g.clearRect(0,0,M.width,M.height),w(c.sheet,s)}function we(){B=!0,g.clearRect(0,0,M.width,M.height),w(c.sheet,s)}function Q(t,e){const n=new o((e.x-t.x)/2+t.x,(e.y-t.y)/2+t.y),r=t.x-e.x,i=t.y-e.y,l=Math.abs(r),m=Math.abs(i);let k,X;if(ue.value==="circumscribed"){const G=Math.floor(n.distance(e));X=Math.floor(G*(m/l)),k=Math.floor(G*(l/m))}else k=l/2,X=m/2;return ce.checked&&(g.beginPath(),g.rect(t.x,t.y,-r,-i),g.stroke()),new A(n,k,X)}function W(t,e){g.strokeStyle=e;const n=t.ellipse,r=n.center;g.beginPath(),g.ellipse(r.x+s.x,r.y+s.y,n.radiusX,n.radiusY,0,0,2*Math.PI),g.stroke()}function N(t){return t.radiusX>15&&t.radiusY>15}const p=document.getElementById("canvas"),_=p.getContext("2d");if(_===null)throw Error("2d rendering context not supported");const f=_,ee=document.getElementById("atomDisplay");let b,O,a=new h("A",new o(0,0),new d(new o(0,0),0,0));ee.innerHTML=a.identifier;function ge(t){new RegExp(/^[A-Za-z]$/).test(t.key)&&(a.identifier=t.key,ee.innerHTML=a.identifier)}function ye(t){b=f.measureText(a.identifier),O=!1;const e=new o(t.clientX-s.x,t.clientY-b.actualBoundingBoxAscent-s.y);a.rectangle=new d(e,b.width,b.fontBoundingBoxDescent+b.actualBoundingBoxAscent),a.origin=new o(t.clientX-s.x,t.clientY-s.y),f.clearRect(0,0,p.width,p.height),w(c.sheet,s),c.canInsert(a)?R(a,"#00FF00"):R(a,"#FF0000")}function xe(t){a.origin=new o(t.clientX-s.x,t.clientY-s.y),a.rectangle.startVertex=new o(t.clientX-s.x,t.clientY-b.actualBoundingBoxAscent-s.y),f.clearRect(0,0,p.width,p.height),w(c.sheet,s),O||(c.canInsert(a)?R(a,"#00FF00"):R(a,"#FF0000"))}function pe(){c.canInsert(a)&&!O&&c.insert(a),a=new h(a.identifier,new o(0,0),new d(new o(0,0),0,0)),f.clearRect(0,0,p.width,p.height),w(c.sheet,s)}function Ee(){a=new h(a.identifier,new o(0,0),new d(new o(0,0),0,0)),O=!0,f.clearRect(0,0,p.width,p.height),w(c.sheet,s)}function R(t,e){f.fillStyle=e,f.strokeStyle=e;const n=t.rectangle;f.beginPath(),f.fillText(t.identifier,t.origin.x+s.x,t.origin.y+s.y),f.rect(n.startVertex.x+s.x,n.startVertex.y+s.y,n.width,n.height),f.stroke()}function me(t){return JSON.stringify(t,null,"	")}function Me(t){if(typeof t=="string"){const n=JSON.parse(t).internalSheet.internalChildren,r=new V,i=[];return n.forEach(l=>{Object.prototype.hasOwnProperty.call(l,"internalEllipse")?i.push(te(l)):i.push(ne(l))}),r.sheet.children=i,r}return null}function te(t){const e=new A(new o(t.internalEllipse.center.x,t.internalEllipse.center.y),t.internalEllipse.radiusX,t.internalEllipse.radiusY),n=[];return t.internalChildren.forEach(r=>{"internalEllipse"in r?n.push(te(r)):n.push(ne(r))}),new y(e,n)}function ne(t){const e=new d(new o(t.internalRectangle.startVertex.x,t.internalRectangle.startVertex.y),t.internalRectangle.width,t.internalRectangle.height),n=t.internalIdentifier,r=new o(t.internalOrigin.x,t.internalOrigin.y);return new h(n,r,e)}const x=document.getElementById("canvas");x.width=window.innerWidth;x.height=window.innerHeight;const re=x.getContext("2d");if(re===null)throw Error("2d rendering context not supported");const u=re;u.font="35pt arial";const be=document.getElementById("graphString"),T=document.getElementById("cutTools"),D=document.getElementById("atomTools");window.addEventListener("keypress",Re);x.addEventListener("mousedown",Ae);x.addEventListener("mousemove",Be);x.addEventListener("mouseup",Oe);x.addEventListener("mouseout",ke);x.addEventListener("mouseenter",Xe);let E="",$=!1,j=!0,c=new V;window.atomMode=Ce;window.cutMode=ve;window.dragMode=Ie;window.saveMode=Fe;window.loadMode=Pe;function ve(){E="cutMode",T.style.display="block",D.style.display="none"}function Ce(){E="atomMode",D.style.display="block",T.style.display="none"}function Ie(){E="dragMode",T.style.display="none",D.style.display="none"}async function Fe(){const t=me(c);if("showSaveFilePicker"in window){const n=await(await window.showSaveFilePicker({excludeAcceptAllOption:!0,suggestedName:"AEG Tree",startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]})).createWritable();await n.write(t),await n.close()}else{const e=document.createElement("a");e.href=t,e.download="AEGTree.json",e.click()}}async function Pe(){const[t]=await window.showOpenFilePicker({excludeAcceptAllOption:!0,multiple:!1,startIn:"downloads",types:[{description:"JSON Files",accept:{"text/json":[".json"]}}]}),e=await t.getFile(),n=new FileReader;n.addEventListener("load",()=>{const r=n.result,i=Me(r);i instanceof V&&(c=i,u.clearRect(0,0,x.width,x.height),w(c.sheet,s))}),n.readAsText(e)}function Re(t){switch(E){case"atomMode":ge(t);break}}function Ae(t){switch(E){case"cutMode":he(t);break;case"atomMode":ye(t);break;case"dragMode":oe(t);break}$=!0}function Be(t){if($&&j)switch(E){case"cutMode":de(t);break;case"atomMode":xe(t);break;case"dragMode":le(t);break}}function Oe(t){switch(E){case"cutMode":fe(t);break;case"atomMode":pe();break}$=!1}function ke(){switch(E){case"cutMode":we();break;case"atomMode":Ee();break;case"dragMode":ae();break}j=!1}function Xe(){j=!0}function w(t,e){be.innerHTML=c.toString();for(let n=0;t.children.length>n;n++)t.children[n]instanceof h?Se(t.children[n],e):w(t.children[n],e);t.ellipse instanceof A&&(u.strokeStyle="#000000",u.beginPath(),u.ellipse(t.ellipse.center.x+e.x,t.ellipse.center.y+e.y,t.ellipse.radiusX,t.ellipse.radiusY,0,0,2*Math.PI),u.stroke())}function Se(t,e){const n=t.rectangle;u.strokeStyle="#000000",u.fillStyle="#000000",u.beginPath(),u.rect(n.startVertex.x+e.x,n.startVertex.y+e.y,n.width,n.height),u.fillText(t.identifier,t.origin.x+e.x,t.origin.y+e.y),u.stroke()}
