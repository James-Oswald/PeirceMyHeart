(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();class f{constructor(e,t,n){this.rect=n,this.identifier=e,this.origin=t}containsPoint(e){return this.rect.containsPoint(e)}containsNode(e){return e instanceof f?this.rect.containsShape(e.rect):this.rect.containsShape(e.ellipse)}toString(){return"An atom representing the proposition: "+this.identifier+" and Boundary box of: "+this.rect.toString()}}class l{constructor(e,t){this.x=e??0,this.y=t??0}set(e,t){this.x=e,this.y=t}toString(){return"X: "+this.x+", Y: "+this.y}}class m{constructor(e,t,n){this.startVertex=e,this.width=t,this.height=n}getCorners(){const e=[this.startVertex];return e.push(new l(this.startVertex.x+this.width,this.startVertex.y)),e.push(new l(this.startVertex.x+this.width,this.startVertex.y+this.height)),e.push(new l(this.startVertex.x,this.startVertex.y+this.height)),e}containsPoint(e){const t=this.getCorners();return t[0].x<=e.x&&t[1].x>=e.x&&t[1].y<=e.y&&t[2].y>=e.y}overlaps(e){if(e instanceof m){const t=this.getCorners(),n=e.getCorners();for(let i=0;i<4;i++)if(this.containsPoint(n[i])||e.containsPoint(t[i]))return!0;return!1}else{for(let t=0;t<4;t++)if(e.containsPoint(this.getCorners()[t]))return!0;return!1}}containsShape(e){if(e instanceof m){const t=e.getCorners();return this.containsPoint(t[0])&&this.containsPoint(t[2])}else{for(let t=0;t<4;t++)if(!this.containsPoint(e.getWidestCoordinates()[t]))return!1;return!0}}toString(){return`A rectangle with
Top Left Vertex at: `+this.startVertex.toString()+", Width: "+this.width+", Height: "+this.height}}class y{constructor(e,t,n){this.center=e??new l,this.radiusX=t??0,this.radiusY=n??0;const i=new l(this.center.x-this.radiusX,this.center.y-this.radiusY);this.boundingBox=new m(i,this.radiusX*2,this.radiusY*2)}toString(){return"An ellipse with Center at: "+this.center.toString()+`, 
Horizontal Radius of: `+this.radiusX+`, 
Vertical Radius of: `+this.radiusY+`, 
Bounding box: `+this.boundingBox.toString()}containsPoint(e){return Math.ceil(Math.pow(e.x-this.center.x,2)/Math.pow(this.radiusX,2)+Math.pow(e.y-this.center.y,2)/Math.pow(this.radiusY,2))<=1}overlaps(e){if(e instanceof m){for(let t=0;t<4;t++)if(this.containsPoint(e.getCorners()[t]))return!0;return!1}else{if(this.boundingBox.overlaps(e.boundingBox)){const t=e.getEllipsePoints();for(let n=0;n<t.length;n++)if(this.containsPoint(t[n]))return!0}return!1}}containsShape(e){if(e instanceof m){for(let t=0;t<4;t++)if(!this.containsPoint(e.getCorners()[t]))return!1;return!0}else if(e instanceof y){const t=e.getWidestCoordinates();for(let n=0;n<4;n++)if(!this.containsPoint(t[n]))return!1;return!0}throw Error("Invalid Shape passed to containsShape, must be a Rectangle | Ellipse")}getWidestCoordinates(){return[new l(this.center.x,this.center.y-this.radiusY),new l(this.center.x+this.radiusX,this.center.y),new l(this.center.x,this.center.y+this.radiusY),new l(this.center.x-this.radiusX,this.center.y)]}getEllipsePoints(){const e=[],t=this.radiusX/15;e[0]=this.getWidestCoordinates()[3];let n,i;for(let r=1;r<64;r++)r<33?(n=e[r-1].x+t,i=this.getCurvePoint(n,1)):(n=e[r-1].x-t,i=this.getCurvePoint(n,-1)),e[r]=new l(n,i);return e}getCurvePoint(e,t){return t*this.radiusY*Math.sqrt(1-Math.pow((e-this.center.x)/this.radiusX,2))+this.center.y}}class a{constructor(e,t){this.ellipse=e??new y,this.children=t??[]}getCurrentCut(e){for(let t=0;t<this.children.length;t++){const n=this.children[t];if(n instanceof a&&this.children[t].containsNode(e))return n.getCurrentCut(e)}return this}containsPoint(e){return this.ellipse===null?!0:this.ellipse.containsPoint(e)}containsNode(e){if(this.ellipse===null)return!0;if(e instanceof f)return this.ellipse.containsShape(e.rect);if(e instanceof a)return this.ellipse.containsShape(e.ellipse);throw Error("containsNode expected AtomNode or CutNode")}remove(e){if(this.containsPoint(e)){let t=!0;for(let n=0;n<this.children.length;n++)if(this.children[n].containsPoint(e))return t=!1,this.children[n]instanceof a?this.children[n].remove(e):(this.children=this.children.splice(n,1),!0);if(t)return!0}return!1}toString(){let e;return this.ellipse===null?e="Sheet of Assertion of the AEG Tree":e=`A cut node with boundary box of 
`+this.ellipse.toString(),this.children.length>0&&(e+=`, 
With nested nodes: `+this.children.toString()),e}toFormulaString(){let e="";for(const t of this.children)t instanceof f?e+=t.identifier:t instanceof a&&(e+=t.toFormulaString()),e+=" ";return e=e.slice(0,-1),this.ellipse===null?e="["+e+"]":e="("+e+")",e}}class D{constructor(e){this.sheet=e??new a,this.sheet.ellipse=null}verify(){return this.verifyAEG(this.sheet)}verifyAEG(e){for(let t=0;t<e.children.length;t++){if(!e.containsNode(e.children[t]))return!1;for(let n=t+1;n<e.children.length;n++)if(this.overlaps(e.children[t],e.children[n]))return!1}for(let t=0;t<e.children.length;t++)if(e.children[t]instanceof a&&!this.verifyAEG(e.children[t]))return!1;return!0}canInsert(e){const t=this.sheet.getCurrentCut(e);for(let n=0;n<t.children.length;n++)if(this.overlaps(e,t.children[n]))return!1;return!0}insert(e){if(!this.canInsert(e))throw new Error("Insertion failed. "+e+" had a collision.");const t=this.sheet.getCurrentCut(e),n=[...t.children];if(t.children.push(e),e instanceof a)for(let i=0;i<n.length;i++)e.containsNode(n[i])&&(e.children.push(n[i]),t.children=t.children.splice(i,1))}remove(e){this.sheet.remove(e)}overlaps(e,t){let n,i;return e instanceof f?t instanceof f?e.rect.overlaps(t.rect):(n=t.ellipse,e.rect.overlaps(n)):t instanceof f?(n=e.ellipse,n.overlaps(t.rect)):(n=e.ellipse,i=t.ellipse,n.overlaps(i))}toString(){return this.sheet.toFormulaString()}}const o=document.getElementById("canvas"),R=o.getContext("2d"),H=document.getElementById("showRect"),q=document.getElementById("mode");if(R===null)throw Error("2d rendering context not supported");const u=R;let O,k;function j(s,e){const t=s.x-e.x,n=s.y-e.y;return Math.sqrt(t*t+n*n)}function z(s,e){const t=new l((e.x-s.x)/2+s.x,(e.y-s.y)/2+s.y),n=s.x-e.x,i=s.y-e.y,r=Math.abs(n),d=Math.abs(i);let E,L;if(q.value==="circumscribed"){const V=Math.floor(j(t,e));L=Math.floor(V*(d/r)),E=Math.floor(V*(r/d))}else E=r/2,L=d/2;H.checked&&(u.beginPath(),u.rect(s.x,s.y,-n,-i),u.stroke());const Y=new y(t,E,L);return h.canInsert(new a(Y))?u.strokeStyle="#00FF00":u.strokeStyle="#FF0000",u.beginPath(),u.ellipse(t.x,t.y,E,L,0,0,2*Math.PI),u.stroke(),Y}function U(){o.addEventListener("mousedown",F)}function F(s){O=new l(s.clientX,s.clientY),o.addEventListener("mousemove",M),o.addEventListener("mouseup",S),o.addEventListener("mouseout",A)}function M(s){const e=new l(s.clientX,s.clientY);u.clearRect(0,0,o.width,o.height),v(h.sheet),k=z(O,e)}function S(){const s=new a(k);h.canInsert(s)&&h.insert(s),console.log(h.toString()),o.removeEventListener("mousemove",M),o.removeEventListener("mouseup",S),o.removeEventListener("mouseout",A),u.clearRect(0,0,o.width,o.height),v(h.sheet)}function A(){o.removeEventListener("mousemove",M),o.removeEventListener("mouseup",S),o.removeEventListener("mouseout",A),u.clearRect(0,0,o.width,o.height),v(h.sheet)}function K(){o.removeEventListener("mousedown",F)}const c=document.getElementById("canvas"),T=c.getContext("2d");if(T===null)throw Error("2d rendering context not supported");const g=T;let x,w;function Z(){window.addEventListener("keypress",$)}function $(s){Q(s.key)&&(c.addEventListener("mousedown",W),w=s.key)}function W(s){const e=new l(s.clientX,s.clientY);x=e,g.fillText(w,e.x,e.y),g.stroke(),c.addEventListener("mousemove",b),c.addEventListener("mouseup",B),c.addEventListener("mouseout",I)}function b(s){x=new l(s.clientX,s.clientY),g.clearRect(0,0,c.width,c.height),v(h.sheet),g.fillText(w,x.x,x.y),g.stroke()}function B(){const s=g.measureText(w),e=new m(new l(x.x,x.y-s.actualBoundingBoxAscent),s.width,s.fontBoundingBoxDescent+s.actualBoundingBoxAscent),t=new f(w,x,e);h.insert(t),console.log(h.toString()),c.removeEventListener("mousemove",b),c.removeEventListener("mouseup",B),c.removeEventListener("mouseOut",I)}function I(){c.removeEventListener("mousemove",b),c.removeEventListener("mouseup",B),c.removeEventListener("mouseOut",I),g.clearRect(0,0,c.width,c.height),v(h.sheet)}function J(){c.removeEventListener("mousedown",W),window.removeEventListener("keydown",$)}function Q(s){return!!new RegExp(/^[A-Za-z]$/).test(s)}const X=document.getElementById("canvas");X.width=window.innerWidth;X.height=window.innerHeight;const G=X.getContext("2d");if(G===null)throw Error("2d rendering context not supported");const p=G;p.font="35pt arial";const _=document.getElementById("graphString");let P=!1,C=!1;const h=new D;window.atomMode=ee;window.ellipseMode=N;function N(){P=!0,U(),C&&(J(),C=!1)}function ee(){C=!0,Z(),P&&(K(),P=!1)}function v(s){_.innerHTML=h.toString();for(let e=0;s.children.length>e;e++)s.children[e]instanceof f?te(s.children[e]):v(s.children[e]);s.ellipse instanceof y&&(p.strokeStyle="#000000",p.beginPath(),p.ellipse(s.ellipse.center.x,s.ellipse.center.y,s.ellipse.radiusX,s.ellipse.radiusY,0,0,2*Math.PI),p.stroke())}function te(s){p.fillText(s.identifier,s.origin.x,s.origin.y),p.stroke()}
